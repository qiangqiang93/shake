{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/components/FollowDetail/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/components/FollowDetail/index.vue","mtime":1546946999367},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {\n  mapState,\n  mapActions\n} from 'vuex'\nimport Loading from '../Loading'\nimport Aritcle from '../../api/article'\nimport FollowItem from '../FollowItem'\nimport BottomLoading from '../../components/BottomLoading'\nexport default {\n  props: ['show', 'followUser', 'id'],\n  data() {\n    return {\n      selectIndex: null, // 轮播到第几个\n      page: 1, // 默认第一页\n      total: 1, // 总共页数\n      styleItem: null, // 轮播外框样式\n      pageX: null, // 手指点击初始值x\n      pageY: null, // 手指点击初始值y\n      userList: {},\n      visibleHeight: 1228, //可视区域高度\n      isloading: false, //是否正在加载\n      scrollLevel: null\n    }\n  },\n  mounted() {\n    // this.init()\n  },\n  activated() {\n    if (document.getElementsByClassName('hyb-swiper-item')[this.selectIndex]) {\n      document.getElementsByClassName('hyb-swiper-item')[\n        this.selectIndex\n      ].scrollTop = this.scrollLevel\n    }\n  },\n  methods: {\n    ...mapActions(['articles/updateAuthorArticle']),\n    // 滑动开始\n    touchTouche(e) {\n      this.pageX = e.targetTouches[0].clientX\n      this.pageY = e.targetTouches[0].clientY\n    },\n    scrollA(e) {\n      this.scrollLevel = e.srcElement.scrollTop\n      if (this.isloading) return false\n      let flag =\n        this.visibleHeight + e.srcElement.scrollTop >\n        e.srcElement.scrollHeight - 100\n      if (!flag) return false\n      this.page++\n      this.getAuthorArticle(this.followUser[this.selectIndex].id, 1)\n    },\n    // 滑动结束\n    changedTouches(e) {\n      let x = e.changedTouches[0].clientX - this.pageX\n      let y = e.changedTouches[0].clientY - this.pageY\n      if (Math.abs(x) > Math.abs(y)) {\n        document.getElementsByClassName('hyb-swiper-item')[\n          this.selectIndex\n        ].scrollTop = 0\n        if (x > 0) {\n          if (this.selectIndex === 0) return false\n          this.selectIndex -= 1\n        } else {\n          if (this.selectIndex === this.followUser.length - 1) return false\n          this.selectIndex += 1\n        }\n        this.styleItem = {\n          width: 750 * this.followUser.length + 'px',\n          transform: `translateX(-${this.selectIndex * 750}px)`\n        }\n        this.page = 1\n        this.getAuthorArticle(this.followUser[this.selectIndex].id)\n      }\n    },\n    // 获取作者文章\n    async getAuthorArticle(id, type) {\n      try {\n        this.isloading = true\n        let res = await Aritcle.getFollowArticle(this.page, id)\n        this.isloading = false\n        if (res.status !== 0) {\n          throw new Error(res.message)\n        }\n        if (type) {\n          this.$set(this.userList, id, this.userList[id].concat(res.data.data))\n        } else {\n          let obj = Object.assign({}, this.articles.authorArticle)\n          obj[id] = res.data.data\n          this['articles/updateAuthorArticle'](obj)\n          this.$set(this.userList, id, res.data.data)\n        }\n        this.page = res.data.current_page\n        this.total = res.data.last_page\n      } catch (error) {}\n    },\n    // 初始化\n    async init() {\n      this.page = 1\n      this.userList = this.articles.authorArticle\n      this.followUser.find((item, index) => {\n        if (this.id == item.id) {\n          this.selectIndex = index\n        }\n      })\n      this.styleItem = {\n        width: 750 * this.followUser.length + 'px',\n        transform: `translateX(-${this.selectIndex * 750}px)`\n      }\n      this.getAuthorArticle(this.id)\n    }\n  },\n  components: {\n    Loading,\n    FollowItem,\n    BottomLoading\n  },\n  computed: {\n    ...mapState({\n      articles: state => state.articles\n    })\n  },\n  watch: {\n    show(newval, oldval) {\n      if (newval) {\n        this.init()\n      }\n    }\n  }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/FollowDetail","sourcesContent":["<template>\n  <div class=\"follow-detail\" v-if=\"show\">\n    <div class=\"content\">\n      <slot></slot>\n      <ul class=\"origin\">\n        <li v-for=\"(item,index) in followUser\" :key=\"index\" :class=\"selectIndex === index?'active':''\"></li>\n      </ul>\n      <div class=\"hyb-swiper\">\n        <div class=\"hyb-swiper-content\" :style=\"styleItem\" @touchstart=\"touchTouche($event)\" @touchend=\"changedTouches($event)\"\n          ref=\"swiperContent\">\n          <div v-for=\"(item,index) in followUser\" :key=\"index\" class=\"hyb-swiper-item\" @scroll=\"scrollA($event)\">\n            <div>\n              <ul v-if=\"userList[item.id]\">\n                <li v-for=\"(item,index) in userList[item.id]\" :key=\"index\">\n                  <FollowItem :item=\"item\"></FollowItem>\n                </li>\n                <li v-if=\"!userList[item.id].length&&isloading\" class=\"no-more\">\n                  该作者还没有发表文章哟\n                </li>\n              </ul>\n              <BottomLoading v-show=\"userList[item.id]&&userList[item.id].length>5&&isloading\"></BottomLoading>\n            </div>\n          </div>\n        </div>\n\n      </div>\n      <Loading :visible=\"!userList[followUser[selectIndex]?followUser[selectIndex].id:0]\"></Loading>\n    </div>\n  </div>\n</template>\n<script>\n  import {\n    mapState,\n    mapActions\n  } from 'vuex'\n  import Loading from '../Loading'\n  import Aritcle from '../../api/article'\n  import FollowItem from '../FollowItem'\n  import BottomLoading from '../../components/BottomLoading'\n  export default {\n    props: ['show', 'followUser', 'id'],\n    data() {\n      return {\n        selectIndex: null, // 轮播到第几个\n        page: 1, // 默认第一页\n        total: 1, // 总共页数\n        styleItem: null, // 轮播外框样式\n        pageX: null, // 手指点击初始值x\n        pageY: null, // 手指点击初始值y\n        userList: {},\n        visibleHeight: 1228, //可视区域高度\n        isloading: false, //是否正在加载\n        scrollLevel: null\n      }\n    },\n    mounted() {\n      // this.init()\n    },\n    activated() {\n      if (document.getElementsByClassName('hyb-swiper-item')[this.selectIndex]) {\n        document.getElementsByClassName('hyb-swiper-item')[\n          this.selectIndex\n        ].scrollTop = this.scrollLevel\n      }\n    },\n    methods: {\n      ...mapActions(['articles/updateAuthorArticle']),\n      // 滑动开始\n      touchTouche(e) {\n        this.pageX = e.targetTouches[0].clientX\n        this.pageY = e.targetTouches[0].clientY\n      },\n      scrollA(e) {\n        this.scrollLevel = e.srcElement.scrollTop\n        if (this.isloading) return false\n        let flag =\n          this.visibleHeight + e.srcElement.scrollTop >\n          e.srcElement.scrollHeight - 100\n        if (!flag) return false\n        this.page++\n        this.getAuthorArticle(this.followUser[this.selectIndex].id, 1)\n      },\n      // 滑动结束\n      changedTouches(e) {\n        let x = e.changedTouches[0].clientX - this.pageX\n        let y = e.changedTouches[0].clientY - this.pageY\n        if (Math.abs(x) > Math.abs(y)) {\n          document.getElementsByClassName('hyb-swiper-item')[\n            this.selectIndex\n          ].scrollTop = 0\n          if (x > 0) {\n            if (this.selectIndex === 0) return false\n            this.selectIndex -= 1\n          } else {\n            if (this.selectIndex === this.followUser.length - 1) return false\n            this.selectIndex += 1\n          }\n          this.styleItem = {\n            width: 750 * this.followUser.length + 'px',\n            transform: `translateX(-${this.selectIndex * 750}px)`\n          }\n          this.page = 1\n          this.getAuthorArticle(this.followUser[this.selectIndex].id)\n        }\n      },\n      // 获取作者文章\n      async getAuthorArticle(id, type) {\n        try {\n          this.isloading = true\n          let res = await Aritcle.getFollowArticle(this.page, id)\n          this.isloading = false\n          if (res.status !== 0) {\n            throw new Error(res.message)\n          }\n          if (type) {\n            this.$set(this.userList, id, this.userList[id].concat(res.data.data))\n          } else {\n            let obj = Object.assign({}, this.articles.authorArticle)\n            obj[id] = res.data.data\n            this['articles/updateAuthorArticle'](obj)\n            this.$set(this.userList, id, res.data.data)\n          }\n          this.page = res.data.current_page\n          this.total = res.data.last_page\n        } catch (error) {}\n      },\n      // 初始化\n      async init() {\n        this.page = 1\n        this.userList = this.articles.authorArticle\n        this.followUser.find((item, index) => {\n          if (this.id == item.id) {\n            this.selectIndex = index\n          }\n        })\n        this.styleItem = {\n          width: 750 * this.followUser.length + 'px',\n          transform: `translateX(-${this.selectIndex * 750}px)`\n        }\n        this.getAuthorArticle(this.id)\n      }\n    },\n    components: {\n      Loading,\n      FollowItem,\n      BottomLoading\n    },\n    computed: {\n      ...mapState({\n        articles: state => state.articles\n      })\n    },\n    watch: {\n      show(newval, oldval) {\n        if (newval) {\n          this.init()\n        }\n      }\n    }\n  }\n</script>\n<style lang=\"scss\" scoped>\n  .follow-detail {\n    position: fixed;\n    width: 100%;\n    height: 100vh;\n    top: 0;\n    z-index: 3;\n    background: rgba(0, 0, 0, 0.5);\n    animation: zoomIn 0.4s;\n\n    @keyframes zoomIn {\n      from {\n        background: rgba(0, 0, 0, 0);\n      }\n\n      to {\n        background: rgba(0, 0, 0, 0.5);\n      }\n    }\n\n    .content {\n      position: fixed;\n      bottom: 0;\n      left: 0;\n      width: 100%;\n      top: 100px;\n      animation: zoom1 0.4s;\n    }\n\n    @keyframes zoom1 {\n      from {\n        top: 100vh;\n      }\n\n      to {\n        top: 100px;\n      }\n    }\n\n    .iconfont {\n      position: absolute;\n      font-size: 48px;\n      color: #fff;\n      top: -70px;\n      left: 30px;\n      z-index: 2;\n    }\n\n    .origin {\n      position: absolute;\n      top: -55px;\n      width: 100%;\n      text-align: center;\n\n      li {\n        display: inline-block;\n        width: 16px;\n        height: 16px;\n        border-radius: 8px;\n        background: #fff;\n        margin: 5px;\n        border: 1px solid #fff;\n\n        &.active {\n          background: #274ff3;\n        }\n      }\n    }\n\n    .hyb-swiper {\n      position: relative;\n      width: 100%;\n      height: 100%;\n      border-top-left-radius: 20px;\n      border-top-right-radius: 20px;\n      overflow: hidden;\n      background: #f6f6f6;\n\n      .hyb-swiper-content {\n        position: absolute;\n        top: 0;\n        height: 100%;\n        transition: transform 0.3s;\n\n        .hyb-swiper-item {\n          float: left;\n          width: 750px;\n          height: 100%;\n          overflow-y: scroll;\n          -webkit-overflow-scrolling: touch;\n        }\n      }\n    }\n\n    .no-more {\n      font-size: 28px;\n      text-align: center;\n      padding: 50px;\n    }\n  }\n</style>"]}]}
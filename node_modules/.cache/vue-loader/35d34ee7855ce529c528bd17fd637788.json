{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/module/spread/edit/index.vue?vue&type=style&index=0&id=0a3fd460&lang=scss&scoped=true&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/module/spread/edit/index.vue","mtime":1546400209450},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/sass-loader/lib/loader.js","mtime":1533139052000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.spread-ad {\n  width: 100%;\n  min-height: 100vh;\n  position: relative;\n  background: #1b1b1b;\n}\nh3 {\n  font-size: 32px;\n  color: #d5d5d5;\n  margin-top: 48px;\n  margin-left: 20px;\n  font-family: 'PingFang SC Bold';\n}\n\n.tip {\n  font-size: 22px;\n  margin-top: 16px;\n  color: #bcbcbc;\n  text-align: right;\n  line-height: 24px;\n  margin-right: 20px;\n  font-family: 'PingFang SC Medium';\n  &::before {\n    clear: both;\n    content: '';\n  }\n}\n.spread-imgs {\n  height: 732px;\n}\n.my-coin,\n.row,\n.spread-title,\n.marketing,\n.spread-page,\n.spread-area,\n.spread-card {\n  height: 40px;\n  font-size: 28px;\n  margin-top: 52px;\n  line-height: 40px;\n  margin-left: 20px;\n  color: rgb(194, 194, 194);\n  font-size: 'PingFang SC Medium';\n  .iconfont {\n    float: left;\n    width: 40px;\n    height: 40px;\n    margin-right: 20px;\n    border-radius: 50%;\n    background-size: cover;\n    background-image: url('/static/coin.png');\n  }\n  .coin-charge {\n    width: 116px;\n    height: 40px;\n    font-size: 26px;\n    text-align: center;\n    border-radius: 4px;\n    display: inline-block;\n    background: #299cff;\n    color: rgb(252, 252, 252);\n  }\n}\n.row {\n  height: 50px;\n  line-height: 50px;\n  margin-top: 33px;\n  label {\n    width: 198px;\n    float: left;\n    line-height: 50px;\n    white-space: nowrap;\n  }\n  input {\n    float: left;\n    width: 126px;\n    height: 50px;\n    outline: none;\n    color: #fff;\n    display: block;\n    text-align: center;\n    border-radius: 4px;\n    background: #393939;\n    border: none;\n  }\n  small {\n    float: right;\n    font-size: 24px;\n    margin-right: 20px;\n  }\n}\n.spread-title {\n  height: 160px;\n  margin-top: 37px;\n  label {\n    float: left;\n    margin-top: 10px;\n  }\n  textarea {\n    width: 628px;\n    height: 60px;\n    resize: none;\n    border: none;\n    padding: 10px;\n    outline: none;\n    display: block;\n    font-size: 28px;\n    color: #cccccc;\n    border-radius: 8px;\n    background: #393939;\n    font-size: 'PingFang SC Medium';\n  }\n}\n.marketing {\n  .chosePage {\n    color: rgb(41, 156, 255);\n  }\n}\n.spread-page {\n  height: 110px;\n  position: relative;\n  border-radius: 6px;\n  padding: 26px 20px 16px;\n  background: #393939;\n  .marketing-title {\n    font-size: 28px;\n    color: #cccccc;\n    line-height: 28px;\n    font-family: 'PingFang SC Medium';\n  }\n  .marketing-date {\n    font-size: 24px;\n    color: #cccccc;\n    line-height: 24px;\n    margin: 20px 0 4px;\n    font-family: 'PingFang SC Medium';\n  }\n  .delete {\n    right: 0;\n    top: 35px;\n    font-size: 36px;\n    position: absolute;\n    background: transparent;\n  }\n}\n.spread-area {\n  height: 50px;\n  margin-top: 50px;\n  line-height: 50px;\n  label {\n    float: left;\n  }\n  .area {\n    float: left;\n    width: 180px;\n    height: 50px;\n    display: block;\n    line-height: 46px;\n    text-align: center;\n    border-radius: 4px;\n    color: rgb(78, 173, 255);\n    border: 2px solid rgb(78, 173, 255);\n  }\n}\n.spread-card {\n  height: 40px;\n  margin-top: 40px;\n  margin-bottom: 176px;\n  span {\n    margin-right: 60px;\n    display: inline-block;\n    &::before {\n      float: left;\n      content: '';\n      width: 40px;\n      height: 40px;\n      display: block;\n      margin-right: 20px;\n      border-radius: 50%;\n      background: #393939;\n    }\n    &.active {\n      &::before {\n        background: #299cff;\n        font-family: 'iconfont';\n        text-align: center;\n        content: '\\E660';\n        font-size: 36px;\n        color: #fff;\n      }\n    }\n  }\n}\n.spread-foot {\n  bottom: 0;\n  width: 100%;\n  height: 96px;\n  position: fixed;\n  font-size: 30px;\n  line-height: 96px;\n  border-top: 1px solid #373737;\n  font-family: 'PingFang SC Medium';\n  a {\n    float: left;\n    width: 250px;\n    display: block;\n    text-align: center;\n    background: #0d0d0d;\n    color: rgb(194, 194, 194);\n  }\n  .hasborder {\n    border-left: 2px solid #373737;\n    border-right: 2px solid #373737;\n  }\n  .publish {\n    color: #4eadff;\n  }\n}\n.marketing-cover {\n  top: 0;\n  left: 0;\n  width: 100%;\n  z-index: -1;\n  height: 100%;\n  position: fixed;\n  &.show {\n    z-index: 1;\n  }\n}\n.marketing-wrapper {\n  bottom: 0;\n  width: 100%;\n  height: 0px;\n  display: flex;\n  overflow: hidden;\n  position: absolute;\n  background: #f2f2f2;\n  flex-direction: column;\n  transition: all 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);\n  &.show {\n    height: 604px;\n  }\n  .marketing-header {\n    height: 88px;\n    display: flex;\n    padding: 0 30px;\n    font-size: 28px;\n    line-height: 88px;\n    background: #fff;\n    box-sizing: border-box;\n    justify-content: space-between;\n    font-family: 'PingFang SC Medium';\n  }\n  .title {\n    font-size: 30px;\n  }\n  .submit {\n    color: #299cff;\n  }\n  .marketing-container {\n    flex: 1;\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n  .marketing-item {\n    width: 690px;\n    height: 110px;\n    padding: 20px;\n    position: relative;\n    border-radius: 6px;\n    background: #fff;\n    margin: 20px auto 0;\n    box-shadow: 0 0 2px 2px rgba(0, 0, 0, 0.1);\n    .marketing-title {\n      font-size: 28px;\n      line-height: 28px;\n      color: rgb(17, 17, 17);\n      font-family: 'PingFang SC Medium';\n    }\n    .marketing-date {\n      font-size: 24px;\n      line-height: 24px;\n      margin: 20px 0 4px;\n      color: rgb(17, 17, 17);\n      font-family: 'PingFang SC Medium';\n    }\n    span {\n      right: 0;\n      top: 35px;\n      position: absolute;\n      &::before {\n        float: left;\n        content: '';\n        width: 40px;\n        height: 40px;\n        display: block;\n        margin-right: 20px;\n        border-radius: 50%;\n        background: #dcdcdc;\n      }\n      &.active {\n        &::before {\n          background: #299cff;\n          font-family: 'iconfont';\n          text-align: center;\n          content: '\\E660';\n          font-size: 36px;\n          color: #fff;\n        }\n      }\n    }\n  }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/module/spread/edit","sourcesContent":["<template>\n  <div class=\"spread-ad\">\n    <!-- 图片 -->\n    <h3>封面</h3>\n    <div class=\"spread-imgs\">\n      <SlideShow :isEdit=\"true\" :input=\"graphics\" :index=\"index\" :slideTo=\"slideTo\"></SlideShow>\n    </div>\n    <!-- 内容设置 -->\n    <h3>内容设置</h3>\n    <div class=\"my-coin\">\n      <i class=\"iconfont\"></i>\n      <span>我的脉宝：</span>\n      <span v-text=\"myCoins + '个'\"></span>\n      <router-link to=\"/user/veinCoin/recharge\" tag=\"span\" class=\"coin-charge\">充值</router-link>\n    </div>\n    <div class=\"row\">\n      <label>脉宝总数：</label>\n      <input type=\"number\" v-model=\"myAD.maibao_num\" @input=\"inputHandler('maibao_num')\">\n      <span>个</span>\n      <small>总数不低于300</small>\n    </div>\n    <div class=\"row\">\n      <label>每次分享花费：</label>\n      <input type=\"number\" v-model=\"myAD.maibao_spend_num\" @input=\"inputHandler('maibao_spend_num')\">\n      <span>个</span>\n      <small>不超过3个</small>\n    </div>\n    <div class=\"spread-title\">\n      <label>标题：</label>\n      <textarea placeholder=\"请输入本次推广的标题\" maxlength=\"20\" v-model=\"myAD.title\"></textarea>\n      <p class=\"tip\">限20字</p>\n    </div>\n    <!-- 营销网页设置 -->\n    <div class=\"marketing\">\n      <span>插入营销网页：</span>\n      <span class=\"chosePage\" @click=\"showMarketing()\">选择营销网页</span>\n    </div>\n    <div class=\"spread-page\" v-if=\"selectedMarketing\">\n      <p class=\"marketing-title\" v-text=\"selectedMarketing.title\"></p>\n      <p class=\"marketing-date\">{{selectedMarketing.created_at | timeFormt('YYYY-MM-DD')}}</p>\n      <span class=\"delete iconfont icon-shanchuguanbicha\" @click=\"deleteMarketing()\"></span>\n    </div>\n    <div class=\"spread-area\">\n      <label>选择推广区域：</label>\n      <span class=\"area\" @click=\"showAreaPicker()\" v-text=\"areaText\">全国</span>\n    </div>\n    <div class=\"spread-card\">\n      <label for=\"\">是否插入自己的名片:</label>\n      <span :class=\"{'active': myAD.card_id}\" @click=\"insertCard(true)\">是</span>\n      <span :class=\"{'active': !myAD.card_id}\" @click=\"insertCard(false)\">否</span>\n    </div>\n    <div class=\"spread-foot\" ref=\"footer\">\n      <a href=\"javascript:void(0)\" @click=\"preview()\">预览</a>\n      <a class=\"hasborder\" href=\"javascript:void(0)\" @click=\"save(4)\">保存</a>\n      <a class=\"publish\" href=\"javascript:void(0)\" @click=\"save(0)\">发布</a>\n    </div>\n    <!-- 选择营销网页 -->\n    <div class=\"marketing-cover\" :class=\"{'show': showMarketings}\" @touchmove.prevent=\"donothing()\" @click=\"closeMarketing()\">\n      <div class=\"marketing-wrapper\" :class=\"{'show': showMarketings}\" @click.stop=\"donothing()\">\n        <div class=\"marketing-header\">\n          <span class=\"cancle\" @click=\"closeMarketing()\">取消</span>\n          <span class=\"title\">营销网页</span>\n          <span class=\"submit\" @click=\"submitMarketing()\">确定</span>\n        </div>\n        <div class=\"marketing-container\">\n          <div class=\"marketing-item\" v-for=\"(item, index) in marketings\" :key=\"index\" @click=\"selectMarketing(index)\">\n            <p class=\"marketing-title\" v-text=\"item.title\"></p>\n            <p class=\"marketing-date\">{{item.created_at | timeFormt('YYYY-MM-DD')}}</p>\n            <span :class=\"{'active': item.selected}\"></span>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- 选择推广地区 -->\n    <div class=\"marketing-cover\" :class=\"{'show': showProvinces}\" @touchmove.prevent=\"donothing()\" @click=\"closeProvince()\">\n      <div class=\"marketing-wrapper\" :class=\"{'show': showProvinces}\" @click.stop=\"donothing()\">\n        <div class=\"marketing-header\">\n          <span class=\"cancle\" @click=\"closeProvince()\">取消</span>\n          <span class=\"title\">推广地区</span>\n          <span class=\"submit\" @click=\"submitProvince()\">确定</span>\n        </div>\n        <div class=\"marketing-container\">\n          <div class=\"marketing-item\" v-for=\"(item, index) in province\" :key=\"index\" @click=\"selectProvince(index)\">\n            <p class=\"marketing-title\" v-text=\"item.name\"></p>\n            <span :class=\"{'active': item.selected}\"></span>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport coin from '@/api/coin'\nimport spread from '../../../api/spread'\nimport { mapActions, mapState } from 'vuex'\nimport httpService from '@/service/httpService'\nimport dialogService from '@/service/dialogService'\nimport SlideShow from '../../../components/SlideShow'\nexport default {\n  name: 'spreadEdit',\n  data() {\n    return {\n      index: 0,\n      graphics: [], // 图文内容副本\n      myCoins: 1500, // 拥有脉宝余额\n      marketings: [], // 营销网页列表\n      windowHeight: null, // 窗口高度\n      scrollHeight: null, // 滚动高度\n      areaText: '全国', // 推广地区名称\n      selectedMarketing: null, // 当前选中的营销网页\n      showMarketings: false, // 是否显示营销网页选择\n      selectedProvince: null, // 当前选择的地区\n      showProvinces: false, // 是否显示地区选择\n      myAD: {\n        title: '', // 广告标题\n        cover: '', // 广告封面\n        card_id: '', // 名片id\n        content: '', // 图文内容\n        maibao_num: '', // 脉宝总数\n        province_id: '', // 推广省的id\n        user_marketing_id: '', // 营销网页id\n        maibao_spend_num: '' // 每次分享花费脉宝数\n      }\n    }\n  },\n  beforeMount() {\n    try {\n      if (this.spreadAD) this.myAD = Object.assign({}, this.spreadAD)\n      this.graphics = JSON.parse(this.spreadAD.content)\n    } catch (err) {\n      this.graphics = []\n    }\n  },\n  async mounted() {\n    this.getCoins()\n    await this.getMarketings()\n    for (let i = 0; i < this.marketings.length; i++) {\n      if (this.marketings[i].id === this.myAD.user_marketing_id) {\n        this.selectedMarketing = this.marketings[i]\n        break\n      }\n    }\n    this.$set(this.myAD, 'card_id', this.user.card_id)\n    this.windowHeight = document.body.clientHeight\n    this.scrollHeight = document.documentElement.scrollHeight\n    window.addEventListener('scroll', this.scrollHandler, false)\n  },\n  destroyed() {\n    window.removeEventListener('scroll', this.scrollHandler, false)\n  },\n  methods: {\n    ...mapActions(['spread/updateSpreadAD', 'spread/updateEditSpread']),\n    donothing() {\n      // nothing\n    },\n    // 获取脉宝余额\n    async getCoins() {\n      try {\n        let res = await coin.getBalance()\n        if (res.status !== 0) throw new Error(res.message)\n        this.myCoins = res.data.maibao\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // 获取营销网页列表\n    async getMarketings() {\n      try {\n        let res = await httpService.get('/front/user-marketing')\n        if (res.status !== 0) throw new Error(res.message)\n        this.marketings = res.data.data\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // 页面滚动处理函数\n    scrollHandler() {\n      let scrolled =\n        document.documentElement.scrollTop || document.body.scrollTop\n      this.$refs.footer.style.position =\n        scrolled + this.windowHeight >= this.scrollHeight ? 'absolute' : 'fixed'\n    },\n    // slideTo\n    slideTo(index) {\n      this.index = index\n    },\n    // 输入的脉宝总数和单次花费\n    inputHandler(type) {\n      if (type === 'maibao_num') {\n        let val = parseInt(Math.abs(this.myAD.maibao_num))\n        if (isNaN(val) || val === 0) val = ''\n        this.myAD.maibao_num = val < this.myCoins ? val : this.myCoins\n      } else {\n        let val = parseInt(Math.abs(this.myAD.maibao_spend_num))\n        if (isNaN(val) || val === 0) val = ''\n        this.myAD.maibao_spend_num = val < 3 ? val : 3\n      }\n    },\n    // 插入营销网页\n    showMarketing() {\n      if (!this.marketings.length) {\n        dialogService.alert('您还没有制作营销网页哦')\n        console.error('跳转去添加营销网页是最优处理')\n        return false\n      }\n      this.showMarketings = true\n    },\n    // 选择营销网页\n    selectMarketing(index) {\n      this.marketings = this.marketings.map((item, _index) => {\n        item.selected = index === _index\n        if (item.selected) {\n          this.selectedMarketing = item\n        }\n        return item\n      })\n    },\n    // 确认营销网页\n    submitMarketing() {\n      this.$set(this.myAD, 'user_marketing_id', this.selectedMarketing.id || '')\n      this.showMarketings = false\n    },\n    closeMarketing() {\n      this.showMarketings = false\n    },\n    // 删除营销网页\n    deleteMarketing() {\n      this.selectedMarketing = null\n      this.marketings = this.marketings.map((item, _index) => {\n        item.selected = false\n        return item\n      })\n      this.$set(this.myAD, 'user_marketing_id', '')\n    },\n    // 显示地区选择\n    showAreaPicker() {\n      this.showProvinces = true\n    },\n    // 确认推广地区\n    submitProvince() {\n      this.areaText = this.selectedProvince.name\n      this.$set(this.myAD, 'province_id', this.selectedProvince.id || '')\n      this.showProvinces = false\n    },\n    closeProvince() {\n      this.showProvinces = false\n    },\n    // 选择推广地区\n    selectProvince(index) {\n      this.province = this.province.map((item, _index) => {\n        item.selected = index === _index\n        if (item.selected) {\n          this.selectedProvince = item\n        }\n        return item\n      })\n    },\n\n    // 是否插入名片\n    insertCard(input) {\n      this.$set(this.myAD, 'card_id', input ? this.user.card_id : '')\n    },\n    // 预览\n    preview() {\n      this.$set(this.myAD, 'cover', this.graphics[0].img)\n      let tempGraphics = this.graphics.filter(item => {\n        return item.img || item.txt\n      })\n      this.$set(this.myAD, 'content', JSON.stringify(tempGraphics))\n      this['spread/updateSpreadAD'](this.myAD)\n      this.$router.push({\n        path: '/spread/preview'\n      })\n    },\n    // 保存[保存4,发布0]\n    async save(type) {\n      if (this._validate()) {\n        this.myAD.status = type\n        try {\n          let res = await spread.editAD(this.myAD.id, this.myAD)\n          if (res.status !== 0) throw new Error(res.message)\n          // 发布、保存成功,删除暂存的广告并跳转到发布管理\n          this['spread/updateSpreadAD'](null)\n          this['spread/updateEditSpread'](null)\n          this.$router.replace({\n            path: '/spread/manger'\n          })\n        } catch (err) {\n          dialogService.alert(err.message)\n        }\n      }\n    },\n    // 数据校验\n    _validate() {\n      // 验证图文是否通过\n      let tempGraphics = this.graphics.filter(item => {\n        return !!(item.img || item.txt)\n      })\n      for (let i = 0; i < tempGraphics.length; i++) {\n        if (!tempGraphics[i].img) {\n          dialogService.alert(`图文中第${i + 1}项的图片还未上传`)\n          return false\n        }\n        if (!tempGraphics[i].txt) {\n          dialogService.alert(`图文中第${i + 1}项的文本还未填写`)\n          return false\n        }\n      }\n      // 如果没有任何图文\n      if (!tempGraphics.length) {\n        dialogService.alert(`您还没有填写任何图文内容`)\n        return false\n      }\n      // 验证标题是否填写\n      if (!this.myAD.title) {\n        dialogService.alert(`广告标题还未填写`)\n        return false\n      }\n      // 总脉宝数\n      if (!this.myAD.maibao_num) {\n        dialogService.alert(`您还没有填写本次推广的总脉宝数`)\n        return false\n      }\n      // 脉宝不足\n      if (parseInt(this.myAD.maibao_num) > parseInt(this.myCoins)) {\n        let _self = this\n        this.$createDialog({\n          title: '提示',\n          type: 'confirm',\n          icon: 'icon-tips-alert',\n          content: '脉宝余额不足,去充值!',\n          onConfirm: () => {\n            _self.$router.push({\n              path: '/user/veinCoin/recharge'\n            })\n          }\n        }).show()\n        return false\n      }\n      // 总脉宝数至少300\n      if (parseInt(this.myAD.maibao_num) < 300) {\n        dialogService.alert(`推广脉宝总数最少不能少于300`)\n        return false\n      }\n      // 单次花费的脉宝数\n      if (!this.myAD.maibao_num) {\n        dialogService.alert(`您还没有填写单次分享广告的脉宝奖励`)\n        return false\n      }\n      if (this.myAD.maibao_num % this.myAD.maibao_num !== 0) {\n        dialogService.alert(`每次分享脉宝个数分配不均！请重新分配`)\n        return false\n      }\n      this.$set(this.myAD, 'cover', tempGraphics[0].img)\n      this.$set(this.myAD, 'content', JSON.stringify(tempGraphics))\n      return true\n    }\n  },\n  components: {\n    SlideShow\n  },\n  computed: {\n    ...mapState({\n      user: state => state.user.userInfo,\n      spreadAD: state => state.spread.editSpread\n    })\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.spread-ad {\n  width: 100%;\n  min-height: 100vh;\n  position: relative;\n  background: #1b1b1b;\n}\nh3 {\n  font-size: 32px;\n  color: #d5d5d5;\n  margin-top: 48px;\n  margin-left: 20px;\n  font-family: 'PingFang SC Bold';\n}\n\n.tip {\n  font-size: 22px;\n  margin-top: 16px;\n  color: #bcbcbc;\n  text-align: right;\n  line-height: 24px;\n  margin-right: 20px;\n  font-family: 'PingFang SC Medium';\n  &::before {\n    clear: both;\n    content: '';\n  }\n}\n.spread-imgs {\n  height: 732px;\n}\n.my-coin,\n.row,\n.spread-title,\n.marketing,\n.spread-page,\n.spread-area,\n.spread-card {\n  height: 40px;\n  font-size: 28px;\n  margin-top: 52px;\n  line-height: 40px;\n  margin-left: 20px;\n  color: rgb(194, 194, 194);\n  font-size: 'PingFang SC Medium';\n  .iconfont {\n    float: left;\n    width: 40px;\n    height: 40px;\n    margin-right: 20px;\n    border-radius: 50%;\n    background-size: cover;\n    background-image: url('/static/coin.png');\n  }\n  .coin-charge {\n    width: 116px;\n    height: 40px;\n    font-size: 26px;\n    text-align: center;\n    border-radius: 4px;\n    display: inline-block;\n    background: #299cff;\n    color: rgb(252, 252, 252);\n  }\n}\n.row {\n  height: 50px;\n  line-height: 50px;\n  margin-top: 33px;\n  label {\n    width: 198px;\n    float: left;\n    line-height: 50px;\n    white-space: nowrap;\n  }\n  input {\n    float: left;\n    width: 126px;\n    height: 50px;\n    outline: none;\n    color: #fff;\n    display: block;\n    text-align: center;\n    border-radius: 4px;\n    background: #393939;\n    border: none;\n  }\n  small {\n    float: right;\n    font-size: 24px;\n    margin-right: 20px;\n  }\n}\n.spread-title {\n  height: 160px;\n  margin-top: 37px;\n  label {\n    float: left;\n    margin-top: 10px;\n  }\n  textarea {\n    width: 628px;\n    height: 60px;\n    resize: none;\n    border: none;\n    padding: 10px;\n    outline: none;\n    display: block;\n    font-size: 28px;\n    color: #cccccc;\n    border-radius: 8px;\n    background: #393939;\n    font-size: 'PingFang SC Medium';\n  }\n}\n.marketing {\n  .chosePage {\n    color: rgb(41, 156, 255);\n  }\n}\n.spread-page {\n  height: 110px;\n  position: relative;\n  border-radius: 6px;\n  padding: 26px 20px 16px;\n  background: #393939;\n  .marketing-title {\n    font-size: 28px;\n    color: #cccccc;\n    line-height: 28px;\n    font-family: 'PingFang SC Medium';\n  }\n  .marketing-date {\n    font-size: 24px;\n    color: #cccccc;\n    line-height: 24px;\n    margin: 20px 0 4px;\n    font-family: 'PingFang SC Medium';\n  }\n  .delete {\n    right: 0;\n    top: 35px;\n    font-size: 36px;\n    position: absolute;\n    background: transparent;\n  }\n}\n.spread-area {\n  height: 50px;\n  margin-top: 50px;\n  line-height: 50px;\n  label {\n    float: left;\n  }\n  .area {\n    float: left;\n    width: 180px;\n    height: 50px;\n    display: block;\n    line-height: 46px;\n    text-align: center;\n    border-radius: 4px;\n    color: rgb(78, 173, 255);\n    border: 2px solid rgb(78, 173, 255);\n  }\n}\n.spread-card {\n  height: 40px;\n  margin-top: 40px;\n  margin-bottom: 176px;\n  span {\n    margin-right: 60px;\n    display: inline-block;\n    &::before {\n      float: left;\n      content: '';\n      width: 40px;\n      height: 40px;\n      display: block;\n      margin-right: 20px;\n      border-radius: 50%;\n      background: #393939;\n    }\n    &.active {\n      &::before {\n        background: #299cff;\n        font-family: 'iconfont';\n        text-align: center;\n        content: '\\E660';\n        font-size: 36px;\n        color: #fff;\n      }\n    }\n  }\n}\n.spread-foot {\n  bottom: 0;\n  width: 100%;\n  height: 96px;\n  position: fixed;\n  font-size: 30px;\n  line-height: 96px;\n  border-top: 1px solid #373737;\n  font-family: 'PingFang SC Medium';\n  a {\n    float: left;\n    width: 250px;\n    display: block;\n    text-align: center;\n    background: #0d0d0d;\n    color: rgb(194, 194, 194);\n  }\n  .hasborder {\n    border-left: 2px solid #373737;\n    border-right: 2px solid #373737;\n  }\n  .publish {\n    color: #4eadff;\n  }\n}\n.marketing-cover {\n  top: 0;\n  left: 0;\n  width: 100%;\n  z-index: -1;\n  height: 100%;\n  position: fixed;\n  &.show {\n    z-index: 1;\n  }\n}\n.marketing-wrapper {\n  bottom: 0;\n  width: 100%;\n  height: 0px;\n  display: flex;\n  overflow: hidden;\n  position: absolute;\n  background: #f2f2f2;\n  flex-direction: column;\n  transition: all 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);\n  &.show {\n    height: 604px;\n  }\n  .marketing-header {\n    height: 88px;\n    display: flex;\n    padding: 0 30px;\n    font-size: 28px;\n    line-height: 88px;\n    background: #fff;\n    box-sizing: border-box;\n    justify-content: space-between;\n    font-family: 'PingFang SC Medium';\n  }\n  .title {\n    font-size: 30px;\n  }\n  .submit {\n    color: #299cff;\n  }\n  .marketing-container {\n    flex: 1;\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n  .marketing-item {\n    width: 690px;\n    height: 110px;\n    padding: 20px;\n    position: relative;\n    border-radius: 6px;\n    background: #fff;\n    margin: 20px auto 0;\n    box-shadow: 0 0 2px 2px rgba(0, 0, 0, 0.1);\n    .marketing-title {\n      font-size: 28px;\n      line-height: 28px;\n      color: rgb(17, 17, 17);\n      font-family: 'PingFang SC Medium';\n    }\n    .marketing-date {\n      font-size: 24px;\n      line-height: 24px;\n      margin: 20px 0 4px;\n      color: rgb(17, 17, 17);\n      font-family: 'PingFang SC Medium';\n    }\n    span {\n      right: 0;\n      top: 35px;\n      position: absolute;\n      &::before {\n        float: left;\n        content: '';\n        width: 40px;\n        height: 40px;\n        display: block;\n        margin-right: 20px;\n        border-radius: 50%;\n        background: #dcdcdc;\n      }\n      &.active {\n        &::before {\n          background: #299cff;\n          font-family: 'iconfont';\n          text-align: center;\n          content: '\\E660';\n          font-size: 36px;\n          color: #fff;\n        }\n      }\n    }\n  }\n}\n</style>\n"]}]}
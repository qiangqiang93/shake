{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/module/login/information/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/module/login/information/index.vue","mtime":1548396203730},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState, mapActions } from 'vuex'\nimport userApi from '../../../api/user/index'\nimport AppUploadImg from '../../../components/AppUploadImg'\nimport dialogService from '../../../service/dialogService.js'\n\nexport default {\n  name: 'informationIndex',\n  data() {\n    return {\n      params: {\n        user_id: '',\n        user_name: '', // 姓名\n        mobile_phone: '', // 电话\n        company: '', // 公司名字\n        portrait: '', // 头像\n        birthday: '2000-1-1', //生日\n        profession: '', //职位\n        sex: 1 //性别\n      },\n      isRequest: false // 是否正在加载\n    }\n  },\n  mounted() {\n    try {\n    this.params.portrait = this.user.portrait\n    } catch (error) {\n      this.params.portrait = ''\n    }\n\n  },\n  methods: {\n    ...mapActions([\n      'system/updateCropper',\n      'system/updateRedirect',\n      'user/setUserInfo'\n    ]),\n    // 上传图片\n    upload(path) {\n      this.$set(this.params, 'portrait', path)\n    },\n    // 保存信息\n    async save() {\n      if (this.isRequest) return false\n      try {\n        if (!this.params.portrait) throw new Error('请上传头像')\n        if (!this.params.user_name) throw new Error('请输入姓名')\n        if (!this.params.company) throw new Error('请输入公司名称')\n        if (!this.params.profession) throw new Error('请输入职位')\n        this.params.user_id = this.user.img\n        this.params.mobile_phone = this.user.phone\n        this.isRequest = true\n        await userApi.putDetailInfo(this.params)\n        this.isRequest = false\n        dialogService.toast('完善成功')\n        let user = Object.assign({}, this.user)\n        user.is_per = true\n        this['user/setUserInfo'](user)\n // 考虑转发的后\n        let path = this.system.redirect\n        if (path) {\n          this['system/updateRedirect'](null)\n          this.$router.replace(path)\n        } else {\n          this.$router.replace('/index')\n        }\n       \n      } catch (error) {\n        this.isRequest = false\n\n        dialogService.toast(error.message)\n      }\n    }\n  },\n  computed: {\n    ...mapState({\n      user: state => state.user.userInfo,\n      system: state => state.system\n    })\n  },\n  components: {\n    AppUploadImg\n  },\n  beforeRouteLeave(to, from, next) {\n    if (this.user && !this.user.is_per && this.user.is_per != undefined&&to.path!='/cropper') {\n      next(false)\n      return false\n    }\n    next()\n  }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/module/login/information","sourcesContent":["<template>\n  <div class=\"information\">\n    <div class=\"header\">\n      <img src=\"./camera.png\" class=\"img-default\" alt=\"\" v-if=\"!params.portrait\">\n      <img :src=\"params.portrait\" v-else>\n      <AppUploadImg class=\"upload\" ratio=\"1\" @success=\"upload\"></AppUploadImg>\n    </div>\n    <p>上传头像</p>\n    <div class=\"item\">\n      <span>姓名</span><input type=\"text\" placeholder=\"请输入姓名\" v-model=\"params.user_name\" /></div>\n    <div class=\"item\">\n      <span>公司</span><input type=\"text\" placeholder=\"请输入公司名称\" v-model=\"params.company\" /></div>\n    <div class=\"item\">\n      <span>职位</span><input type=\"text\" placeholder=\"请输入职位\" v-model=\"params.profession\" /></div>\n    <button class=\"btn\" @click=\"save\" :class=\"isRequest?'under-way':''\">{{isRequest?'保存中...':'保存'}}</button>\n  </div>\n</template>\n<script>\nimport { mapState, mapActions } from 'vuex'\nimport userApi from '../../../api/user/index'\nimport AppUploadImg from '../../../components/AppUploadImg'\nimport dialogService from '../../../service/dialogService.js'\n\nexport default {\n  name: 'informationIndex',\n  data() {\n    return {\n      params: {\n        user_id: '',\n        user_name: '', // 姓名\n        mobile_phone: '', // 电话\n        company: '', // 公司名字\n        portrait: '', // 头像\n        birthday: '2000-1-1', //生日\n        profession: '', //职位\n        sex: 1 //性别\n      },\n      isRequest: false // 是否正在加载\n    }\n  },\n  mounted() {\n    try {\n    this.params.portrait = this.user.portrait\n    } catch (error) {\n      this.params.portrait = ''\n    }\n\n  },\n  methods: {\n    ...mapActions([\n      'system/updateCropper',\n      'system/updateRedirect',\n      'user/setUserInfo'\n    ]),\n    // 上传图片\n    upload(path) {\n      this.$set(this.params, 'portrait', path)\n    },\n    // 保存信息\n    async save() {\n      if (this.isRequest) return false\n      try {\n        if (!this.params.portrait) throw new Error('请上传头像')\n        if (!this.params.user_name) throw new Error('请输入姓名')\n        if (!this.params.company) throw new Error('请输入公司名称')\n        if (!this.params.profession) throw new Error('请输入职位')\n        this.params.user_id = this.user.img\n        this.params.mobile_phone = this.user.phone\n        this.isRequest = true\n        await userApi.putDetailInfo(this.params)\n        this.isRequest = false\n        dialogService.toast('完善成功')\n        let user = Object.assign({}, this.user)\n        user.is_per = true\n        this['user/setUserInfo'](user)\n // 考虑转发的后\n        let path = this.system.redirect\n        if (path) {\n          this['system/updateRedirect'](null)\n          this.$router.replace(path)\n        } else {\n          this.$router.replace('/index')\n        }\n       \n      } catch (error) {\n        this.isRequest = false\n\n        dialogService.toast(error.message)\n      }\n    }\n  },\n  computed: {\n    ...mapState({\n      user: state => state.user.userInfo,\n      system: state => state.system\n    })\n  },\n  components: {\n    AppUploadImg\n  },\n  beforeRouteLeave(to, from, next) {\n    if (this.user && !this.user.is_per && this.user.is_per != undefined&&to.path!='/cropper') {\n      next(false)\n      return false\n    }\n    next()\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n.information {\n  font-size: 30px;\n  overflow: hidden;\n  padding: 0 30px;\n  box-sizing: border-box;\n\n  .jump {\n    color: #274ff3;\n    text-align: right;\n    padding: 30px 0;\n  }\n\n  .header {\n    position: relative;\n    margin: 50px auto 20px;\n    width: 150px;\n    height: 150px;\n    background: #f4f4f4;\n    border-radius: 75px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    // overflow: hidden;\n    img {\n      width: 100%;\n      height: 100%;\n      border-radius: 75px;\n\n      object-fit: cover;\n    }\n\n    .img-default {\n      width: 50px;\n      height: 45px;\n    }\n\n    .upload {\n      top: 0;\n      left: 0;\n      opacity: 0;\n      z-index: 2;\n      width: 100%;\n      height: 140%;\n      outline: none;\n      position: absolute;\n    }\n  }\n\n  p {\n    text-align: center;\n    font-size: 26px;\n    color: #666;\n    margin-bottom: 82px;\n  }\n\n  .item {\n    display: flex;\n    line-height: 86px;\n    border-bottom: 1px solid #e0e0e0;\n\n    span {\n      width: 100px;\n    }\n\n    input {\n      flex: 1;\n      outline: none;\n    }\n  }\n\n  .btn {\n    width: 100%;\n    height: 88px;\n    line-height: 88px;\n    text-align: center;\n    background-image: linear-gradient(90deg, #486bfc 0%, #274ff3 100%),\n      linear-gradient(#298ff8, #298ff8);\n    background-blend-mode: normal, normal;\n    border-radius: 4px;\n    font-size: 32px;\n    color: #fff;\n    margin-top: 50px;\n  }\n}\n</style>"]}]}
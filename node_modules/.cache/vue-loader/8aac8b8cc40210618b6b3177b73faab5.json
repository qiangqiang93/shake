{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/module/webPage/rank/index.vue?vue&type=style&index=0&id=0b81ffb3&scoped=true&lang=scss&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/module/webPage/rank/index.vue","mtime":1546946999380},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/sass-loader/lib/loader.js","mtime":1533139052000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.tips {\n  font-size: 28px;\n  text-align: center;\n  margin-top: 40px;\n  padding-bottom: 20px;\n}\n@keyframes mymove {\n  0% {\n    width: 30%;\n  }\n  50% {\n    width: 70%;\n  }\n  100% {\n    width: 30%;\n  }\n}\n.animate {\n  animation: mymove 0.8s infinite;\n}\n.button {\n  font-size: 22px;\n  color: #fff;\n  width: 150px;\n  height: 50px;\n  line-height: 50px;\n  background: #274ff3;\n  border-radius: 25px;\n  text-align: center;\n  position: absolute;\n  bottom: 30px;\n  right: 30px;\n}\n.wraper {\n  background: #f6f6f6;\n}\n.marketing-item {\n  margin: auto;\n  width: 100%;\n  height: 220px;\n  padding: 30px;\n  overflow: hidden;\n  position: relative;\n  background: #fff;\n  border-bottom: 2px solid #eaeaea;\n  border-radius: 6px;\n  box-sizing: border-box;\n  box-shadow: 0px 0px 15px 0px rgba(0, 0, 0, 0.08);\n  .default {\n    position: absolute;\n    top: 20px;\n    left: 20px;\n    width: 92px;\n    height: 90px;\n  }\n}\n.marketing-item-poster {\n  float: left;\n  width: 290px;\n  height: 162px;\n  overflow: hidden;\n  margin-right: 28px;\n  border-radius: 6px;\n  box-sizing: border-box;\n  background-size: cover;\n  background-position: center;\n}\n.marketing-item-info {\n  float: left;\n  width: 316px;\n  height: 160px;\n  overflow: hidden;\n}\n.marketing-item-title {\n  height: 32px;\n  font-size: 32px;\n  color: #333;\n  overflow: hidden;\n  line-height: 32px;\n  margin-bottom: 15px;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  font-family: 'PingFang SC Medium';\n}\n.marketing-item-counter {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  font-size: 26px;\n  color: #000;\n  overflow: hidden;\n  font-family: 'PingFang SC Medium';\n}\n.marketing-item-date {\n  margin-top: 16px;\n  font-size: 22px;\n  color: #666666;\n}\n.marketing-item-operate {\n  margin-top: 12px;\n  height: 32px;\n  line-height: 29px;\n  img {\n    overflow: hidden;\n    margin-right: 10px;\n    width: 29px;\n    border-radius: 50%;\n    height: 29px;\n  }\n  span {\n    vertical-align: top;\n    font-size: 22px;\n    color: #666666;\n  }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/module/webPage/rank","sourcesContent":["/**\n*  克隆榜\n*/\n\n<template>\n  <Wrapper @scrolling=\"nextPage\" class=\"wraper\" style=\"padding-bottom: 100px;\">\n    <AndroidHeader ref=\"header\" title=\"克隆榜\" iconColor=\"#fff\" fontColor=\"#fff\" background=\"#274ff3\">\n    </AndroidHeader>\n    <div v-show=\"!show\" class=\"marketing-item\">\n      <div class=\"marketing-item-poster\" style=\"background:#dadada\">\n      </div>\n      <div class=\"marketing-item-info\">\n        <p class=\"marketing-item-title\" style=\"background:#dadada;width:60px;\"></p>\n        <p class=\"marketing-item-date animate\" style=\"background:#dadada;width:30%;height:30px;\"></p>\n        <p class=\"marketing-item-date animate\" style=\"background:#dadada;width:30%;height:30px;animation-delay: 0.4s\"></p>\n      </div>\n      <div class=\"button\" style=\"background:#dadada\"></div>\n    </div>\n    <div v-show=\"show\" class=\"marketing-item\" v-for=\"(item, index) in lists\" :key=\"index\" @click=\"goCustomPage(item.id)\">\n      <div class=\"marketing-item-poster\" :style=\"{ backgroundImage: item.loading?'url(/static/loading.gif)':`url(${item.cover})`}\">\n      </div>\n      <div class=\"marketing-item-info\">\n        <p class=\"marketing-item-title\">{{`NO.${index + 1}`}}</p>\n        <p class=\"marketing-item-counter\" v-text=\"item.title\"></p>\n        <p class=\"marketing-item-date\">{{item.popularity+'人在使用'}}</p>\n        <p class=\"marketing-item-operate\">\n          <img :src=\"item.user.portrait\">\n          <span>{{item.user.name}}</span>\n        </p>\n      </div>\n      <div class=\"button\" v-if=\"item.is_clone\" @click.stop=\"clone(index)\">{{item.is_clone && item.clone_price!=='0.00'?item.clone_price+'元':'免费'}}克隆</div>\n    </div>\n    <p class=\"tips\" v-show=\"lists.length\">{{loading?'正在加载...':'暂无更多'}}</p>\n  </Wrapper>\n</template>\n\n<script>\n// import CloneDialog from '@/components/CloneDialog'\nimport dialogService from '@/service/dialogService'\nimport { mapState, mapActions } from 'vuex'\nimport { pageCover } from '@/utils'\nimport AndroidHeader from '../../../components/AndroidHeader/index'\nimport Wrapper from '../../../components/Wrapper/index'\nimport httpService from '@/service/httpService'\nexport default {\n  name: 'cloneRank',\n  data() {\n    return {\n      windowHeight: null, //高度\n      loading: false, // 是否在加载\n      last_page: null, // 总页数\n      page: 1, // 当前页数\n      show: false,\n      lists: []\n    }\n  },\n  components: {\n    AndroidHeader,\n    Wrapper\n  },\n  async mounted() {\n    this.getLists()\n    this['webPage/updateCloneId'](null)\n    this['webPage/updateClonePage']({\n      type: 'init',\n      data: null\n    })\n  },\n  computed: {\n    ...mapState({\n      user: state => state.user.userInfo\n    })\n  },\n  methods: {\n    ...mapActions([\n      'system/updateBeVipPath',\n      'webPage/updateClonePage',\n      'webPage/updateCloneId'\n    ]),\n    // 获取排行榜列表\n    async getLists(load) {\n      this.loading = true\n      if (load) this.page += 1\n      let res = await httpService.get('/front/personal_page/rank', {\n        page: this.page\n      })\n      if (res.status !== 0) {\n        dialogService.toast(res.message)\n        return\n      }\n      if (load) {\n        this.lists = this.lists.concat(\n          res.data.rank.map(item => {\n            item.cover = pageCover(item)\n            item.loading = true\n            return item\n          })\n        )\n      } else {\n        this.lists = res.data.rank.map(item => {\n          item.cover = pageCover(item)\n          item.loading = true\n          return item\n        })\n      }\n      this.$nextTick(() => {\n        this.loadImg()\n      })\n      // this.rank = res.data.ranking\n      this.show = true\n      this.last_page = res.data.meta.last_page\n      this.windowHeight = document.documentElement.clientHeight\n      this.loading = false\n    },\n    nextPage(scrolled, scrollHeight) {\n      let scrollBottom = this.windowHeight + scrolled > scrollHeight - 100\n      if (!scrollBottom || this.loading || this.page >= this.last_page) {\n        return false\n      } else {\n        this.getLists(true)\n      }\n    },\n    // 加载图片\n    loadImg() {\n      let _self = this\n      this.lists.forEach((item, index) => {\n        let image = new Image()\n        image.src = item.cover ? item.cover : '/static/cover/default.png'\n        image.onload = function() {\n          if (!item.cover)\n            _self.$set(_self.lists[index], 'cover', '/static/cover/default.png')\n          _self.$set(_self.lists[index], 'loading', false)\n        }\n      })\n    },\n    // 个人网页详情\n    goCustomPage(id) {\n      this.$router.push({\n        path: `/webPage/detail/${id}`\n      })\n    },\n    // 克隆网页\n    async clone(index) {\n      if (!this.user.vip_level) {\n        this._openVip()\n        return false\n      }\n      // 将克隆网页的信息存入vuex中\n      this['webPage/updateClonePage']({\n        type: 'init',\n        data: this.lists[index]\n      })\n\n      try {\n        // 生成克隆到订单\n        let res = await httpService({\n          method: 'post',\n          body: {\n            temp_id: this.lists[index].id\n          },\n          url: '/front/personal_page/customs/clone'\n        })\n        if (res.status !== 0) throw new Error(res.message)\n        this['webPage/updateCloneId'](res.data.clone_id)\n        // 再判断是否为收费模板，是则先付费\n        if (this.lists[index].clone_price !== '0.00') {\n          this.$router.replace('/pay?type=clone')\n        } else {\n          this.$router.push({\n            path: '/webPage/edit'\n          })\n        }\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // 开通会员操作\n    _openVip(msg) {\n      let _self = this\n      dialogService.confirm('开通会员才能克隆网页哦，是否去开通？', ok => {\n        if (ok) {\n          _self['system/updateBeVipPath']('/cloneRank')\n          _self.$router.push({\n            path: '/vipCenter'\n          })\n        }\n      })\n    }\n  }\n}\n</script>\n<style scoped lang='scss'>\n.tips {\n  font-size: 28px;\n  text-align: center;\n  margin-top: 40px;\n  padding-bottom: 20px;\n}\n@keyframes mymove {\n  0% {\n    width: 30%;\n  }\n  50% {\n    width: 70%;\n  }\n  100% {\n    width: 30%;\n  }\n}\n.animate {\n  animation: mymove 0.8s infinite;\n}\n.button {\n  font-size: 22px;\n  color: #fff;\n  width: 150px;\n  height: 50px;\n  line-height: 50px;\n  background: #274ff3;\n  border-radius: 25px;\n  text-align: center;\n  position: absolute;\n  bottom: 30px;\n  right: 30px;\n}\n.wraper {\n  background: #f6f6f6;\n}\n.marketing-item {\n  margin: auto;\n  width: 100%;\n  height: 220px;\n  padding: 30px;\n  overflow: hidden;\n  position: relative;\n  background: #fff;\n  border-bottom: 2px solid #eaeaea;\n  border-radius: 6px;\n  box-sizing: border-box;\n  box-shadow: 0px 0px 15px 0px rgba(0, 0, 0, 0.08);\n  .default {\n    position: absolute;\n    top: 20px;\n    left: 20px;\n    width: 92px;\n    height: 90px;\n  }\n}\n.marketing-item-poster {\n  float: left;\n  width: 290px;\n  height: 162px;\n  overflow: hidden;\n  margin-right: 28px;\n  border-radius: 6px;\n  box-sizing: border-box;\n  background-size: cover;\n  background-position: center;\n}\n.marketing-item-info {\n  float: left;\n  width: 316px;\n  height: 160px;\n  overflow: hidden;\n}\n.marketing-item-title {\n  height: 32px;\n  font-size: 32px;\n  color: #333;\n  overflow: hidden;\n  line-height: 32px;\n  margin-bottom: 15px;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  font-family: 'PingFang SC Medium';\n}\n.marketing-item-counter {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  font-size: 26px;\n  color: #000;\n  overflow: hidden;\n  font-family: 'PingFang SC Medium';\n}\n.marketing-item-date {\n  margin-top: 16px;\n  font-size: 22px;\n  color: #666666;\n}\n.marketing-item-operate {\n  margin-top: 12px;\n  height: 32px;\n  line-height: 29px;\n  img {\n    overflow: hidden;\n    margin-right: 10px;\n    width: 29px;\n    border-radius: 50%;\n    height: 29px;\n  }\n  span {\n    vertical-align: top;\n    font-size: 22px;\n    color: #666666;\n  }\n}\n</style>\n"]}]}
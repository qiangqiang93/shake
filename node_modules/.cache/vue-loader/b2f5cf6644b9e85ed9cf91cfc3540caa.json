{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/module/mine/reward/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/module/mine/reward/index.vue","mtime":1548298510434},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport dialogService from '../../../service/dialogService'\nimport httpService from '@/service/httpService'\nimport Wrapper from '../../../components/Wrapper/index'\nimport AppLoading from '../../../components/AppLoading/index'\nimport AppHeader from '../../../components/AppHeader'\nimport { mapState } from 'vuex'\nimport state from '../../../store/modules/user/state'\nimport userApi from '../../../api/user/index'\n\nexport default {\n  name: 'mine-reward',\n  data() {\n    return {\n      firstIn: true, //第一次进入\n      totalAmount: '--',\n      rewardAll: '--',\n      data: [],\n      loading: false, //是否在加载\n      windowHeight: null, //网页长度\n      page: 0, //当前页\n      last_page: null //共多少页\n    }\n  },\n  components: {\n    Wrapper,\n    AppHeader,\n    AppLoading\n  },\n  mounted() {\n    userApi.getProfile()\n    this.getBill()\n  },\n  computed: {\n    ...mapState({\n      user: state => state.user.userInfo,\n      platform: state => state.system.platform\n    }),\n    paddingTop: function() {\n      return this.platform === 'wechat' ? '0px' : '100px'\n    }\n  },\n  methods: {\n    //去名片\n    toCard(item) {\n      if (item.user.id) {\n        this.$router.push(`/card/detail/${item.user.id}`)\n      }\n    },\n    // 转入余额\n    transform() {\n      let self = this\n      if (this.user.vip_level === 0) {\n        dialogService.confirm(\n          '您未开通会员,还不能转入余额哟,是否去开通会员？',\n          status => {\n            if (status) {\n              self.$router.push('/mine/vipCenter')\n            }\n            return\n          }\n        )\n        return\n      }\n      if (this.totalAmount > 0) {\n        self.$router.push('/reward/toWallet')\n      } else {\n        dialogService.alert('当前余额为0，无法转入')\n      }\n    },\n    // 下一页\n    nextPage(scrolled, scrollHeight) {\n      let scrollBottom = this.windowHeight + scrolled > scrollHeight - 100\n      if (!scrollBottom || this.loading || this.page >= this.last_page) {\n        return false\n      } else {\n        this.getBill(true)\n      }\n    },\n    // 获取奖励金明细\n    async getBill(type) {\n      if (this.loading) return\n      this.page++\n      this.loading = true\n      let self = this\n      try {\n        let r = await httpService({\n          url: '/front/reward/bill',\n          params: {\n            page: self.page\n          }\n        })\n        if (r.status !== 0) {\n          throw new Error(r.message)\n        }\n        self.loading = false\n        self.last_page = r.data.list.last_page\n        self.data = type ? self.data.concat(r.data.list.data) : r.data.list.data\n        self.totalAmount = r.data.current\n        self.rewardAll = parseFloat(r.data.total).toFixed(2)\n        self.windowHeight = document.documentElement.clientHeight\n        self.firstIn = false\n      } catch (error) {\n        self.firstIn = false\n        dialogService.alert(error.message)\n      }\n    }\n  }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/module/mine/reward","sourcesContent":["<template>\n  <Wrapper @scrolling=\"nextPage\" :paddingTop=\"paddingTop\" class=\"warpper\">\n    <AppHeader ref=\"header\" title=\"营销奖励\"></AppHeader>\n    <AppLoading v-if=\"firstIn\"></AppLoading>\n    <div class=\"total\">\n      <p class=\"now\">当前营销奖励金</p>\n      <p class=\"num\">￥{{totalAmount}}</p>\n      <p class=\"tips\">累计营销奖励金{{rewardAll}}元</p>\n    </div>\n    <div class=\"search\">\n      <p>奖励金明细<router-link to=\"/activity/markeMoney\" tag=\"span\" style=\"float: right;color:#367df3;\">赚钱攻略</router-link>\n      </p>\n    </div>\n    <div class=\"detail\">\n      <div class=\"list\" v-for=\"(item,index) in data\" @click=\"toCard(item)\" :key=\"index\">\n        <p class=\"ting\">{{item.describe=='营销奖励'?'您的收益来自 ':item.describe}}<span class=\"name\">{{(item.type==1||item.type==4)?item.user.name:''}}</span><span class=\"number\">{{item.income_type?'+':'-'}}￥{{item.money}}</span></p>\n        <p class=\"time\">{{item.created_at}}</p>\n      </div>\n      <template v-if=\"last_page\">\n        <p class=\"no-more\" v-if=\"page == last_page&&!loading\">{{page>1?'没有更多了':''}}</p>\n        <!-- <p class=\"no-more\" v-else>正在加载...</p> -->\n        <AppLoading style=\"padding-bottom:120px;\" v-else type=\"list\"></AppLoading>\n      </template>\n    </div>\n    <div @click=\"transform\" class=\"footer\" ref=\"footer\">转入钱包</div>\n  </Wrapper>\n</template>\n<script>\nimport dialogService from '../../../service/dialogService'\nimport httpService from '@/service/httpService'\nimport Wrapper from '../../../components/Wrapper/index'\nimport AppLoading from '../../../components/AppLoading/index'\nimport AppHeader from '../../../components/AppHeader'\nimport { mapState } from 'vuex'\nimport state from '../../../store/modules/user/state'\nimport userApi from '../../../api/user/index'\n\nexport default {\n  name: 'mine-reward',\n  data() {\n    return {\n      firstIn: true, //第一次进入\n      totalAmount: '--',\n      rewardAll: '--',\n      data: [],\n      loading: false, //是否在加载\n      windowHeight: null, //网页长度\n      page: 0, //当前页\n      last_page: null //共多少页\n    }\n  },\n  components: {\n    Wrapper,\n    AppHeader,\n    AppLoading\n  },\n  mounted() {\n    userApi.getProfile()\n    this.getBill()\n  },\n  computed: {\n    ...mapState({\n      user: state => state.user.userInfo,\n      platform: state => state.system.platform\n    }),\n    paddingTop: function() {\n      return this.platform === 'wechat' ? '0px' : '100px'\n    }\n  },\n  methods: {\n    //去名片\n    toCard(item) {\n      if (item.user.id) {\n        this.$router.push(`/card/detail/${item.user.id}`)\n      }\n    },\n    // 转入余额\n    transform() {\n      let self = this\n      if (this.user.vip_level === 0) {\n        dialogService.confirm(\n          '您未开通会员,还不能转入余额哟,是否去开通会员？',\n          status => {\n            if (status) {\n              self.$router.push('/mine/vipCenter')\n            }\n            return\n          }\n        )\n        return\n      }\n      if (this.totalAmount > 0) {\n        self.$router.push('/reward/toWallet')\n      } else {\n        dialogService.alert('当前余额为0，无法转入')\n      }\n    },\n    // 下一页\n    nextPage(scrolled, scrollHeight) {\n      let scrollBottom = this.windowHeight + scrolled > scrollHeight - 100\n      if (!scrollBottom || this.loading || this.page >= this.last_page) {\n        return false\n      } else {\n        this.getBill(true)\n      }\n    },\n    // 获取奖励金明细\n    async getBill(type) {\n      if (this.loading) return\n      this.page++\n      this.loading = true\n      let self = this\n      try {\n        let r = await httpService({\n          url: '/front/reward/bill',\n          params: {\n            page: self.page\n          }\n        })\n        if (r.status !== 0) {\n          throw new Error(r.message)\n        }\n        self.loading = false\n        self.last_page = r.data.list.last_page\n        self.data = type ? self.data.concat(r.data.list.data) : r.data.list.data\n        self.totalAmount = r.data.current\n        self.rewardAll = parseFloat(r.data.total).toFixed(2)\n        self.windowHeight = document.documentElement.clientHeight\n        self.firstIn = false\n      } catch (error) {\n        self.firstIn = false\n        dialogService.alert(error.message)\n      }\n    }\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n.warpper {\n  .footer {\n    width: 100%;\n    height: 98px;\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    background: #367df3;\n    line-height: 98px;\n    text-align: center;\n    color: #ffffff;\n    font-size: 32px;\n  }\n\n  .detail {\n    .no-more {\n      text-align: center;\n      font-size: 22px;\n      margin-top: 20px;\n      padding-bottom: 120px;\n    }\n\n    .list {\n      .ting {\n        color: #010101;\n        font-size: 30px;\n        margin-bottom: 10px;\n        overflow: hidden;\n\n        .name {\n          color: #274ff3;\n        }\n\n        .number {\n          float: right;\n        }\n      }\n\n      .time {\n        color: #777777;\n        font-size: 22px;\n      }\n\n      width: 100%;\n      box-sizing: border-box;\n      padding: 26px 30px;\n      border-bottom: 1px solid #eaeaea;\n    }\n\n    border-top: 1px solid #eaeaea;\n    width: 100%;\n    box-sizing: border-box;\n    background-color: #fff;\n  }\n\n  .search {\n    widows: 100px;\n    height: 80px;\n    line-height: 80px;\n    box-sizing: border-box;\n    padding: 0 30px;\n    color: #666666;\n    background: #f4f4f4;\n    font-size: 26px;\n    position: relative;\n  }\n\n  .total {\n    .now {\n      font-size: 24px;\n      margin-top: 55px;\n    }\n\n    .num {\n      font-size: 60px;\n      margin: 40px 0 30px;\n    }\n\n    .tips {\n      font-size: 24px;\n    }\n\n    color: #fff;\n    overflow: hidden;\n    width: 100%;\n    height: 300px;\n    text-align: center;\n    background: linear-gradient(to right, #f3ad17, #eba40d);\n  }\n\n  color: #000;\n  width: 100%;\n  min-height: 100vh;\n  background: #ffffff;\n  overflow: hidden;\n  position: relative;\n}\n</style>"]}]}
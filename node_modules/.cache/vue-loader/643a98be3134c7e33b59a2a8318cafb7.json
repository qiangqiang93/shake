{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/module/activity/invite/index.vue?vue&type=style&index=0&id=84e7733e&lang=scss&scoped=true&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/module/activity/invite/index.vue","mtime":1547462780283},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/sass-loader/lib/loader.js","mtime":1533139052000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.wrap {\n  .footer {\n    width: 100%;\n    height: 128px;\n    padding: 0 20px;\n    box-sizing: border-box;\n    font-size: 32px;\n    position: fixed;\n    bottom: 0;\n    overflow: hidden;\n    left: 0;\n    background: #fff;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    .download {\n      width: 345px;\n      height: 88px;\n      flex: 1;\n      line-height: 88px;\n      text-align: center;\n      background-color: #274ff3;\n      color: #fff;\n      box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.1);\n      border-radius: 8px;\n    }\n\n    .home {\n      margin-left: 20px;\n      flex: 1;\n      height: 88px;\n      line-height: 88px;\n      text-align: center;\n      box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.1);\n      border-radius: 8px;\n      border: solid 1px #274ff3;\n      color: #274ff3;\n    }\n  }\n\n  .main {\n    .inviter {\n      position: absolute;\n      top: 292px;\n      left: 27%;\n\n      .avatar {\n        width: 40px;\n        height: 40px;\n        border-radius: 50%;\n        margin-right: 11px;\n        float: left;\n      }\n\n      .name {\n        line-height: 40px;\n        float: left;\n        font-size: 24px;\n        color: #ffffff;\n      }\n    }\n\n    .invite-box {\n      .button {\n        margin: 45px auto 0;\n        width: 279px;\n        height: 70px;\n        line-height: 70px;\n        background: #466afa;\n        text-align: center;\n        color: #fff;\n        font-size: 32px;\n        border-radius: 10px;\n        outline: none;\n\n        &:disabled {\n          background: #999;\n        }\n      }\n\n      .input-wrap {\n        .input {\n          width: 460px;\n          outline: none;\n          font-size: 28px;\n        }\n\n        .code {\n          font-size: 26px;\n          color: #274ff3;\n          float: right;\n        }\n\n        overflow: hidden;\n        width: 630px;\n        padding-bottom: 14px;\n        border-bottom: 1px solid #d3d3d3;\n        margin: 45px auto 0;\n      }\n\n      .title {\n        text-align: center;\n        color: #000000;\n        font-size: 32px;\n        padding-top: 28px;\n        margin-bottom: 35px;\n      }\n\n      width: 710px;\n      height: 400px;\n      border-radius: 10px;\n      background: #fff;\n      position: absolute;\n      top: 862px;\n      left: 50%;\n      transform: translateX(-50%);\n    }\n\n    width: 100%;\n    height: 3223px;\n    overflow: hidden;\n    box-sizing: border-box;\n    background-image: url('./bg.jpg');\n    background-repeat: no-repeat;\n    background-size: 100% 100%;\n    position: relative;\n  }\n\n  min-height: 100vh;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  background: #ffffff;\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/module/activity/invite","sourcesContent":["<template>\n  <Wrapper class=\"wrap\">\n    <div class=\"main\">\n      <div class=\"inviter\">\n        <img class=\"avatar\" :src=\"shareInfo.portrait\" />\n        <span class=\"name\">{{shareInfo.name||'小脉宝'}}</span>\n      </div>\n      <div class=\"invite-box\">\n        <p class=\"title\">立即领取1元</p>\n        <div class=\"input-wrap\">\n          <input class=\"input\" placeholder=\"输入手机号\" type=\"text\" v-model=\"phone\" />\n        </div>\n        <div class=\"input-wrap\">\n          <input class=\"input\" placeholder=\"输入验证码\" type=\"text\" v-model=\"code\" />\n          <span class=\"code\" @click=\"getCode\">{{tips}}</span>\n        </div>\n        <div style=\"display:flex;\">\n          <button class=\"button btn\" :disabled=\"!(phone&&code)\" @click=\"submit\">注册领取</button>\n        </div>\n      </div>\n    </div>\n    <div class=\"footer\" ref=\"footer\" v-show=\"isRegister\">\n      <template v-if=\"!isIos\">\n        <p class=\"download btn\">下载汇脉宝APP</p>\n        <p class=\"home btn\" @click=\"goHome\">进入首页</p>\n      </template>\n      <template v-if=\"isIos\">\n        <p class=\"download btn\" @click=\"goHome\">进入汇脉宝首页</p>\n      </template>\n    </div>\n  </Wrapper>\n</template>\n<script>\nimport card from '../../../api/card'\nimport httpService from '@/service/httpService'\nimport Wrapper from '../../../components/Wrapper/index'\nimport dialogService from '../../../service/dialogService.js'\nimport validate from '../../../utils/validate'\nimport System from '../../../api/system'\nimport Article from '../../../api/article'\nimport Login from '../../../api/login'\nimport { isIos, getParamsFromUrl } from '../../../utils/index.js'\nimport { mapState, mapActions } from 'vuex'\nexport default {\n  name: 'mine-invite',\n  data() {\n    return {\n      tips: '获取验证码', // 获取验证码\n      phone: '', // 电话\n      open_id: '', // 用户标识\n      code: '', // 验证码\n      timer: '', // 计时器\n      isIos: '', //是否是ios\n      active: true, // 是否可点击验证码\n      shareInfo: {}, //分享人信息\n      shareId: null, // 分享人ID\n      subscribe: null, // 是否关注微信公众号0 未关注 1 关注\n      isRegister: false // 是否注册了\n    }\n  },\n  components: {\n    Wrapper\n  },\n  mounted() {\n    this.init()\n  },\n  computed: {\n    ...mapState({\n      userInfo: state => state.user.userInfo,\n      redirect: state => state.system.redirect\n    })\n  },\n  methods: {\n    ...mapActions(['system/shareGuide']),\n    // 初始化\n    async init() {\n      this.isIos = isIos()\n      this.shareId = getParamsFromUrl('user_id')\n      this.open_id = getParamsFromUrl('open_id').trim()\n      this.subscribe = getParamsFromUrl('subscribe')\n      try {\n        let res = await card.getCardByUserId(this.shareId)\n        if (res.status !== 0) {\n          throw new Error(res.message)\n        }\n        this.shareInfo = res.data\n        let options, userInfo, url\n        userInfo = this.userInfo\n\n        if (userInfo) this.shareId = userInfo.id\n        url =\n          window.api +\n          '/front/oauth?user_id=' +\n          this.shareId +\n          '&redirect=' +\n          encodeURIComponent('/activity/invite') +\n          '&poster=1'\n        options = {\n          imgUrl: `${window.host}/static/hongbao.jpg`,\n          title: `我是${this.shareInfo.name}邀请您参加互推，一起瓜分1200W`,\n          desc: `汇脉宝—共享流量，专注营销`,\n          link: url,\n          success: function() {}\n        }\n      } catch (error) {\n        location.href =\n          window.api +\n          '/front/oauth?user_id= ' +\n          '&redirect=' +\n          encodeURIComponent(this.redirect)\n      }\n    },\n    // 倒计时\n    countdown() {\n      let second = 60\n      this.active = false\n      this.tips = second + 's'\n      this.timer = setInterval(() => {\n        second--\n        this.tips = second + 's'\n        if (second === 0) {\n          clearInterval(this.timer)\n          this.active = true\n          this.tips = '获取验证码'\n        }\n      }, 1000)\n    },\n    // 获取验证码 type发送验证码 1登录 2注册 3改密 4换绑 5设置支付密码\n    async getCode() {\n      if (!this.active) return\n      let check = validate.phone(this.phone)\n      if (!check.status) {\n        dialogService.toast(check.msg)\n        return false\n      }\n      try {\n        let ress = await Login.phoneExist(this.phone)\n        if (ress.status !== 0) throw new Error(ress.message)\n        if (ress.data.is_exist) throw new Error('手机号已注册')\n        let res = await System.sendValidateCode(this.phone, 2)\n        if (res.status !== 0) throw new Error(res.message)\n        dialogService.toast('发送成功')\n        this.countdown()\n      } catch (err) {\n        dialogService.toast(err.message)\n      }\n    },\n    async submit() {\n      let check = validate.phone(this.phone)\n      if (!check.status) {\n        dialogService.toast(check.msg)\n        return false\n      }\n      try {\n        let res = await Login.register({\n          code: this.code,\n          phone: this.phone,\n          open_id: this.open_id,\n          user_id: this.shareId\n        })\n        if (res.status === -1) {\n          throw new Error(res.message)\n        }\n        this.isRegister = true\n        dialogService.toast('注册成功')\n      } catch (error) {\n        dialogService.toast(error.message)\n      }\n    },\n    goHome() {\n      if (this.subscribe == 1) {\n        this.$router.push('/login')\n      } else {\n        window.location.href =\n          'https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz=MzIzNDY0MTA1NA==#wechat_redirect'\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.wrap {\n  .footer {\n    width: 100%;\n    height: 128px;\n    padding: 0 20px;\n    box-sizing: border-box;\n    font-size: 32px;\n    position: fixed;\n    bottom: 0;\n    overflow: hidden;\n    left: 0;\n    background: #fff;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    .download {\n      width: 345px;\n      height: 88px;\n      flex: 1;\n      line-height: 88px;\n      text-align: center;\n      background-color: #274ff3;\n      color: #fff;\n      box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.1);\n      border-radius: 8px;\n    }\n\n    .home {\n      margin-left: 20px;\n      flex: 1;\n      height: 88px;\n      line-height: 88px;\n      text-align: center;\n      box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.1);\n      border-radius: 8px;\n      border: solid 1px #274ff3;\n      color: #274ff3;\n    }\n  }\n\n  .main {\n    .inviter {\n      position: absolute;\n      top: 292px;\n      left: 27%;\n\n      .avatar {\n        width: 40px;\n        height: 40px;\n        border-radius: 50%;\n        margin-right: 11px;\n        float: left;\n      }\n\n      .name {\n        line-height: 40px;\n        float: left;\n        font-size: 24px;\n        color: #ffffff;\n      }\n    }\n\n    .invite-box {\n      .button {\n        margin: 45px auto 0;\n        width: 279px;\n        height: 70px;\n        line-height: 70px;\n        background: #466afa;\n        text-align: center;\n        color: #fff;\n        font-size: 32px;\n        border-radius: 10px;\n        outline: none;\n\n        &:disabled {\n          background: #999;\n        }\n      }\n\n      .input-wrap {\n        .input {\n          width: 460px;\n          outline: none;\n          font-size: 28px;\n        }\n\n        .code {\n          font-size: 26px;\n          color: #274ff3;\n          float: right;\n        }\n\n        overflow: hidden;\n        width: 630px;\n        padding-bottom: 14px;\n        border-bottom: 1px solid #d3d3d3;\n        margin: 45px auto 0;\n      }\n\n      .title {\n        text-align: center;\n        color: #000000;\n        font-size: 32px;\n        padding-top: 28px;\n        margin-bottom: 35px;\n      }\n\n      width: 710px;\n      height: 400px;\n      border-radius: 10px;\n      background: #fff;\n      position: absolute;\n      top: 862px;\n      left: 50%;\n      transform: translateX(-50%);\n    }\n\n    width: 100%;\n    height: 3223px;\n    overflow: hidden;\n    box-sizing: border-box;\n    background-image: url('./bg.jpg');\n    background-repeat: no-repeat;\n    background-size: 100% 100%;\n    position: relative;\n  }\n\n  min-height: 100vh;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  background: #ffffff;\n}\n</style>"]}]}
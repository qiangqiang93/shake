{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/module/spread/shareHistroy/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/module/spread/shareHistroy/index.vue","mtime":1547781185298},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport spread from '../../../api/spread'\nimport dialogService from '../../../service/dialogService'\nexport default {\n  name: 'spreadShareHistory',\n  data() {\n    return {\n      page: 0, // 当前页码\n      list: [], // 所有数据\n      allPage: null, // 总页面数\n      loading: false\n    }\n  },\n  beforeMount() {\n    this.init()\n  },\n  mounted() {\n    window.addEventListener('scroll', this.loadMore, false)\n  },\n  destroyed() {\n    window.removeEventListener('scroll', this.loadMore, false)\n  },\n  methods: {\n    // 获取全民推广的历史记录\n    async init() {\n      try {\n        let res = await spread.getShareHistory(this.page)\n        if (res.status !== 0) throw new Error(res.message)\n        this.list = res.data.data\n        this.page = res.data.current_page\n        this.allPage = res.data.last_page\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // 加载下一页\n    async loadMore() {\n      if (this.loading) return\n      if (this.page >= this.allPage) return\n      this.loading = true\n      try {\n        let res = await spread.getShareHistory(this.page + 1)\n        if (res.status !== 0) throw new Error(res.message)\n        if (res.status !== 0) throw new Error(res.message)\n        this.loading = true\n        this.page = res.data.current_page\n        this.list = this.list.concat(res.data.data)\n        // 成功\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // 广告详情\n    goToAD(item) {\n      if (item.user_marketing_id) {\n        this.$router.push({\n          path: `/marketing/detail/${item.user_marketing_id}`\n        })\n      } else {\n        this.$router.push({\n          path: `/spread/detail/${item.spread_id}`\n        })\n      }\n    },\n    // 名片详情\n    goToCard(id) {\n      this.$router.push({\n        path: `/card/detail/${id}`\n      })\n    }\n  }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/module/spread/shareHistroy","sourcesContent":["<template>\n  <div class=\"share-history\" :class=\"{'white': !list.length}\">\n    <div class=\"none\">\n      <img v-if=\"!list.length\" src=\"./none.gif\" style=\"width: 100%;\" alt=\"\">\n    </div>\n    <div class=\"share-item\" v-for=\"(item, index) in list\" :key=\"index\">\n      <div class=\"item-detail\" @click=\"goToAD(item)\">\n        <div class=\"item-poster\" :style=\"{'background-image': 'url('+item.cover+')'}\">\n        </div>\n        <div class=\"item-info\">\n          <p v-text=\"item.title\"></p>\n        </div>\n      </div>\n      <div class=\"item-card\">\n        <img :src=\"item.head_picture\" alt=\"\" class=\"head-img\" @click=\"goToCard(item.author_user_id)\">\n        <span class=\"name\" v-text=\"item.user_name\" @click=\"goToCard(item.author_user_id)\"></span>\n        <span class=\"date\">{{item.sharetime|timeFormt('YYYY-MM-DD')}}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport spread from '../../../api/spread'\nimport dialogService from '../../../service/dialogService'\nexport default {\n  name: 'spreadShareHistory',\n  data() {\n    return {\n      page: 0, // 当前页码\n      list: [], // 所有数据\n      allPage: null, // 总页面数\n      loading: false\n    }\n  },\n  beforeMount() {\n    this.init()\n  },\n  mounted() {\n    window.addEventListener('scroll', this.loadMore, false)\n  },\n  destroyed() {\n    window.removeEventListener('scroll', this.loadMore, false)\n  },\n  methods: {\n    // 获取全民推广的历史记录\n    async init() {\n      try {\n        let res = await spread.getShareHistory(this.page)\n        if (res.status !== 0) throw new Error(res.message)\n        this.list = res.data.data\n        this.page = res.data.current_page\n        this.allPage = res.data.last_page\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // 加载下一页\n    async loadMore() {\n      if (this.loading) return\n      if (this.page >= this.allPage) return\n      this.loading = true\n      try {\n        let res = await spread.getShareHistory(this.page + 1)\n        if (res.status !== 0) throw new Error(res.message)\n        if (res.status !== 0) throw new Error(res.message)\n        this.loading = true\n        this.page = res.data.current_page\n        this.list = this.list.concat(res.data.data)\n        // 成功\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // 广告详情\n    goToAD(item) {\n      if (item.user_marketing_id) {\n        this.$router.push({\n          path: `/marketing/detail/${item.user_marketing_id}`\n        })\n      } else {\n        this.$router.push({\n          path: `/spread/detail/${item.spread_id}`\n        })\n      }\n    },\n    // 名片详情\n    goToCard(id) {\n      this.$router.push({\n        path: `/card/detail/${id}`\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.share-history {\n  width: 100%;\n  overflow: hidden;\n  min-height: 100vh;\n  background: #ededed;\n  &.white {\n    background: #fff;\n  }\n}\n.share-item {\n  width: 100%;\n  height: 304px;\n  padding: 30px;\n  margin-top: 20px;\n  background: #fff;\n  box-sizing: border-box;\n}\n.item-detail {\n  width: 100%;\n  height: 188px;\n  background: #f5f5f5;\n  box-sizing: border-box;\n  padding: 20px 30px 20px 20px;\n  .item-poster {\n    float: left;\n    width: 114px;\n    height: 150px;\n    overflow: hidden;\n    margin-right: 20px;\n    border-radius: 4px;\n    background-size: cover;\n    background-position: center;\n  }\n  .item-info {\n    float: left;\n    width: 490px;\n    height: 150px;\n    overflow: hidden;\n    padding-top: 20px;\n    box-sizing: border-box;\n    p {\n      font-size: 48px;\n      overflow: hidden;\n      line-height: 48px;\n      display: -webkit-box;\n      -webkit-line-clamp: 2;\n      -webkit-box-orient: vertical;\n      font-family: 'PingFang SC Medium';\n    }\n  }\n}\n.item-card {\n  height: 40px;\n  padding: 0 10px;\n  font-size: 24px;\n  color: #999999;\n  overflow: hidden;\n  margin-top: 24px;\n  box-sizing: border-box;\n  font-family: 'PingFang SC Medium';\n  img {\n    float: left;\n    width: 40px;\n    height: 40px;\n    overflow: hidden;\n    border-radius: 50%;\n  }\n  .name {\n    float: left;\n    line-height: 40px;\n    padding-left: 20px;\n    box-sizing: border-box;\n  }\n  .date {\n    float: right;\n    line-height: 40px;\n    margin-right: 30px;\n  }\n}\n</style>\n"]}]}
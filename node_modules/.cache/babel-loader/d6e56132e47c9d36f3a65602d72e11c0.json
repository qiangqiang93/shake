{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/thread-loader/dist/cjs.js!/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/hytx-rebuild/node_modules/eslint-loader/index.js??ref--13-0!/Users/qiang/work/hytx/hytx-rebuild/src/service/sdkService.js","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/service/sdkService.js","mtime":1548482144336},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime/regenerator\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport store from '../store';\nimport wx from 'weixin-js-sdk';\nimport circle from '../api/circle';\nimport system from '../api/system';\nimport { delHTML } from '../utils';\nimport { reConstructPath } from '../utils/tools';\nimport { isIos, pageCover, getArticleCover, getParamsFromUrl } from '@/utils';\nvar isFirst = true; // 微信签名随机字符串\n\nvar randomChar = function randomChar() {\n  var nonceStr = '';\n  var character = '0123456789qwertyuioplkjhgfdsazxcvbnm';\n\n  for (var i = 0; i < 16; i++) {\n    nonceStr += character[Math.ceil(Math.random() * 36)];\n  }\n\n  return nonceStr;\n};\n/* \n    @nname  sha1加密函数\n    @desc   sha1加密函数\n    @params\n            s string\n*/\n\n\nvar sha1 = function sha1(s) {\n  // 字符转码\n  var _encodeUTF8 = function _encodeUTF8(s) {\n    var i,\n        c,\n        x,\n        r = [];\n\n    for (i = 0; i < s.length; i++) {\n      if ((c = s.charCodeAt(i)) < 0x80) r.push(c);else if (c < 0x800) r.push(0xc0 + (c >> 6 & 0x1f), 0x80 + (c & 0x3f));else {\n        if ((x = c ^ 0xd800) >> 10 == 0) //对四字节UTF-16转换为Unicode\n          c = (x << 10) + (s.charCodeAt(++i) ^ 0xdc00) + 0x10000, r.push(0xf0 + (c >> 18 & 0x7), 0x80 + (c >> 12 & 0x3f));else r.push(0xe0 + (c >> 12 & 0xf));\n        r.push(0x80 + (c >> 6 & 0x3f), 0x80 + (c & 0x3f));\n      }\n    }\n\n    return r;\n  };\n\n  var data = new Uint8Array(_encodeUTF8(s));\n  var i, j, t;\n  var l = (data.length + 8 >>> 6 << 4) + 16,\n      s = new Uint8Array(l << 2);\n  s.set(new Uint8Array(data.buffer)), s = new Uint32Array(s.buffer);\n\n  for (t = new DataView(s.buffer), i = 0; i < l; i++) {\n    s[i] = t.getUint32(i << 2);\n  }\n\n  s[data.length >> 2] |= 0x80 << 24 - (data.length & 3) * 8;\n  s[l - 1] = data.length << 3;\n\n  var w = [],\n      f = [function () {\n    return m[1] & m[2] | ~m[1] & m[3];\n  }, function () {\n    return m[1] ^ m[2] ^ m[3];\n  }, function () {\n    return m[1] & m[2] | m[1] & m[3] | m[2] & m[3];\n  }, function () {\n    return m[1] ^ m[2] ^ m[3];\n  }],\n      rol = function rol(n, c) {\n    return n << c | n >>> 32 - c;\n  },\n      k = [1518500249, 1859775393, -1894007588, -899497514],\n      m = [1732584193, -271733879, null, null, -1009589776];\n\n  m[2] = ~m[0], m[3] = ~m[1];\n\n  for (i = 0; i < s.length; i += 16) {\n    var o = m.slice(0);\n\n    for (j = 0; j < 80; j++) {\n      w[j] = j < 16 ? s[i + j] : rol(w[j - 3] ^ w[j - 8] ^ w[j - 14] ^ w[j - 16], 1), t = rol(m[0], 5) + f[j / 20 | 0]() + m[4] + w[j] + k[j / 20 | 0] | 0, m[1] = rol(m[1], 30), m.pop(), m.unshift(t);\n    }\n\n    for (j = 0; j < 5; j++) {\n      m[j] = m[j] + o[j] | 0;\n    }\n  }\n\n  t = new DataView(new Uint32Array(m).buffer);\n\n  for (var i = 0; i < 5; i++) {\n    m[i] = t.getUint32(i << 2);\n  }\n\n  var hex = Array.prototype.map.call(new Uint8Array(new Uint32Array(m).buffer), function (e) {\n    return (e < 16 ? '0' : '') + e.toString(16);\n  }).join('');\n  return hex;\n};\n/* \n    @nname  微信签名函数\n    @desc   微信签名函数\n    @params\n            apiList array   需要使用api\n*/\n\n\nvar signnure = function signnure(apiList) {\n  var noncestr = randomChar();\n  var timestamp = new Date().getTime();\n  var appId = store.state.system.signature.app_id;\n  var url = isIos() ? window.url : window.location.href;\n  var jsapi_ticket = store.state.system.signature.jsapi_ticket;\n  var signature = \"jsapi_ticket=\".concat(jsapi_ticket, \"&noncestr=\").concat(noncestr, \"&timestamp=\").concat(timestamp, \"&url=\").concat(url);\n  var options = {\n    debug: false,\n    // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\n    appId: appId,\n    // 必填，公众号的唯一标识\n    nonceStr: noncestr,\n    // 必填，生成签名的随机串\n    timestamp: timestamp,\n    // 必填，生成签名的时间戳\n    signature: sha1(signature),\n    // 必填，签名\n    jsApiList: apiList // 必填，需要使用的JS接口列表\n\n  };\n  return options;\n};\n\nvar sdkService = {\n  config: function () {\n    var _config = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(type) {\n      var apiList, menuList, options;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              try {\n                menuList = ['menuItem:share:qq', 'menuItem:copyUrl', 'menuItem:readMode', 'menuItem:share:QZone', 'menuItem:share:email', 'menuItem:share:weiboApp', 'menuItem:share:facebook']; // if (type === 'ios') {\n                //   apiList = [\n                //     'hideMenuItems',\n                //     'showMenuItems',\n                //     'onMenuShareTimeline',\n                //     'onMenuShareAppMessage'\n                //   ]\n                // }\n\n                if (type === 'pay') {\n                  apiList = ['chooseWXPay', 'hideMenuItems', 'showMenuItems'];\n                  menuList.push('menuItem:share:timeline');\n                  menuList.push('menuItem:share:appMessage');\n                } else if (type === 'share') {\n                  apiList = ['hideMenuItems', 'showMenuItems', 'onMenuShareTimeline', 'onMenuShareAppMessage'];\n                } else if (type === 'shareTask') {\n                  apiList = ['hideMenuItems', 'showMenuItems', 'onMenuShareTimeline'];\n                  menuList.push('menuItem:share:appMessage');\n                } else {\n                  apiList = ['hideMenuItems', 'showMenuItems', 'onMenuShareTimeline', 'onMenuShareAppMessage'];\n                }\n\n                if (isFirst && isIos()) {\n                  isFirst = false;\n                  window.url = window.location.href;\n                }\n\n                options = signnure(apiList);\n                wx.config(options);\n                wx.ready(function () {\n                  wx.showMenuItems({\n                    menuList: ['menuItem:share:appMessage', 'menuItem:share:timeline']\n                  });\n                  wx.hideMenuItems({\n                    menuList: menuList\n                  });\n                  var circleAudio = document.querySelector('#circleAudio');\n\n                  if (circleAudio) {\n                    circleAudio.play();\n                    circleAudio.pause();\n                  }\n                });\n              } catch (err) {\n                console.log(err);\n              }\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function config(_x) {\n      return _config.apply(this, arguments);\n    }\n\n    return config;\n  }(),\n\n  /*\n    options: {\n        link: link,                         // 分享链接 *\n        desc: desc,                         // 分享描述 *\n        title: title,                       // 分享标题 *\n        imgUrl: imgUrl,                     // 分享封面 *\n        cancel: function() {},\n        success: function() {},\n        type: '',                           // 分享类型,music、video或link，不填默认为link\n        dataUrl: '',                        // 如果type是music或video，则要提供数据链接，默认为空\n    }\n  */\n  share: function share(options) {\n    wx.onMenuShareTimeline(options);\n    wx.onMenuShareAppMessage(options);\n  },\n\n  /* \n    @name   articleConfig\n    @desc   文章分享配置 \n    @params \n            article,\n            shareId,\n            callback\n  */\n  articleConfig: function articleConfig(article, shareId, callback, formCircle) {\n    var options, task, userId, userInfo;\n    userInfo = store.state.user.userInfo;\n    if (userInfo) userId = userInfo.id;\n    task = getParamsFromUrl('task');\n    shareId = shareId || userId;\n    var url = \"\".concat(window.host, \"/?#/article/detail/\").concat(article.uuid || article.id, \"/\").concat(shareId);\n    url = url + (formCircle ? \"?\".concat(formCircle) : '');\n    options = {\n      title: article.title,\n      link: reConstructPath(url),\n      imgUrl: getArticleCover(article.cover),\n      desc: delHTML(article.content).substring(0, 40),\n      success: function () {\n        var _success = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee2() {\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  store.commit('system/shareGuide', false);\n                  system.shareCount(1, article.uuid || article.id);\n\n                  if (task) {\n                    circle.completeShareTask(task);\n                    if (callback) callback();\n                  } else {\n                    if (callback) callback();\n                  }\n\n                case 3:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this);\n        }));\n\n        function success() {\n          return _success.apply(this, arguments);\n        }\n\n        return success;\n      }()\n    };\n    return options;\n  },\n\n  /* \n    @name   cardConfig\n    @desc   名片分享配置 \n    @params \n            card,\n            cardUserId,\n            callback\n  */\n  cardConfig: function cardConfig(card, cardUserId, callback, formCircle) {\n    var options, task, userId, userInfo;\n    userInfo = store.state.user.userInfo;\n    if (userInfo) userId = userInfo.id;\n    task = getParamsFromUrl('task');\n    var url = \"\".concat(window.host, \"/?#/card/detail/\").concat(cardUserId);\n    url = url + (formCircle ? \"?\".concat(formCircle) : '');\n    options = {\n      link: reConstructPath(url),\n      desc: '汇脉宝——共享流量，专注营销',\n      imgUrl: card.portrait || card.head_picture || card.logo,\n      title: \"\\u6211\\u662F\".concat(card.name || card.user_name, \"\\uFF0C\\u9080\\u8BF7\\u60A8\\u4E0E\\u6211\\u5171\\u4EAB\\u5343\\u4E07\\u8425\\u9500\\u4EBA\\u540D\\u7247\"),\n      success: function success() {\n        store.commit('system/shareGuide', false);\n        system.shareCount(3, card.card_id || card.id);\n\n        if (task) {\n          circle.completeShareTask(task);\n          if (callback) callback();\n        } else {\n          if (callback) callback();\n        }\n      }\n    };\n    return options;\n  },\n\n  /* \n    @name   webPageConfig\n    @desc   个人微网分享配置 \n    @params \n            webPage,\n            callback\n  */\n  webPageConfig: function webPageConfig(webPage, callback, formCircle) {\n    var options, task, userId, userInfo;\n    userInfo = store.state.user.userInfo;\n    if (userInfo) userId = userInfo.id;\n    task = getParamsFromUrl('task');\n    var cover = pageCover(webPage);\n    var url = \"\".concat(window.host, \"/?#/webPage/detail/\").concat(webPage.id);\n    url = url + (formCircle ? \"?\".concat(formCircle) : '');\n    options = {\n      title: webPage.title,\n      desc: webPage.motto || '汇脉宝——共享流量，专注营销',\n      link: reConstructPath(url),\n      imgUrl: /^http/.test(cover) ? cover : \"\".concat(window.host + cover),\n      success: function success() {\n        store.commit('system/shareGuide', false);\n        system.shareCount(2, webPage.id);\n\n        if (task) {\n          circle.completeShareTask(task);\n          if (callback) callback();\n        } else {\n          if (callback) callback();\n        }\n      }\n    };\n    return options;\n  },\n  // 分享营销网页\n  marketingConfig: function marketingConfig(marketing, formCircle) {\n    var options, task, userId, userInfo;\n    userInfo = store.state.user.userInfo;\n    if (userInfo) userId = userInfo.id;\n    task = getParamsFromUrl('task');\n    var url = \"\".concat(window.host, \"/?#/marketing/detail/\").concat(marketing.id);\n    url = url + (formCircle ? \"?\".concat(formCircle) : '');\n    options = {\n      title: marketing.title,\n      imgUrl: marketing.cover,\n      link: reConstructPath(url),\n      desc: '汇脉宝——共享流量，专注营销',\n      success: function success() {\n        system.shareCount(4, marketing.id);\n        store.commit('system/shareGuide', false);\n\n        if (task) {\n          circle.completeShareTask(task);\n          if (callback) callback();\n        } else {\n          if (callback) callback();\n        }\n      }\n    };\n    return options;\n  },\n  // 默认分享\n  defaultShare: function defaultShare() {\n    var options = {\n      type: '',\n      dataUrl: '',\n      title: '汇脉宝',\n      link: window.host + '/',\n      desc: '汇脉宝——共享流量，专注营销',\n      imgUrl: \"\".concat(window.host, \"/static/full-logo.png\")\n    };\n    wx.ready(function () {\n      wx.onMenuShareTimeline(options);\n      wx.onMenuShareAppMessage(options);\n    });\n  },\n\n  /*\n    options: {\n        timeStamp: 0,                   // 支付签名时间戳，注意微信jssdk中的所有使用timestamp字段均为小写。但最新版的支付后台生成签名使用的timeStamp字段名需大写其中的S字符\n        nonceStr: '',                   // 支付签名随机串，不长于 32 位\n        package: '',                    // 统一支付接口返回的prepay_id参数值，提交格式如：prepay_id=\\*\\*\\*）\n        signType: '',                   // 签名方式，默认为'SHA1'，使用新版支付需传入'MD5'\n        paySign: '',                    // 支付签名\n        success: function(res) {}\n    }\n  */\n  pay: function pay(options) {\n    wx.chooseWXPay({\n      timestamp: options.timeStamp,\n      nonceStr: options.nonceStr,\n      signType: options.signType,\n      package: options.package,\n      paySign: options.paySign,\n      success: function success(res) {\n        options.success(res);\n      },\n      fail: function fail(res) {}\n    });\n  }\n};\nwx.error(function (res) {\n  console.log(res);\n});\nexport default sdkService;",{"version":3,"sources":["/Users/qiang/work/hytx/hytx-rebuild/src/service/sdkService.js"],"names":["store","wx","circle","system","delHTML","reConstructPath","isIos","pageCover","getArticleCover","getParamsFromUrl","isFirst","randomChar","nonceStr","character","i","Math","ceil","random","sha1","s","_encodeUTF8","c","x","r","length","charCodeAt","push","data","Uint8Array","j","t","l","set","buffer","Uint32Array","DataView","getUint32","w","f","m","rol","n","k","o","slice","pop","unshift","hex","Array","prototype","map","call","e","toString","join","signnure","apiList","noncestr","timestamp","Date","getTime","appId","state","signature","app_id","url","window","location","href","jsapi_ticket","options","debug","jsApiList","sdkService","config","type","menuList","ready","showMenuItems","hideMenuItems","circleAudio","document","querySelector","play","pause","err","console","log","share","onMenuShareTimeline","onMenuShareAppMessage","articleConfig","article","shareId","callback","formCircle","task","userId","userInfo","user","id","host","uuid","title","link","imgUrl","cover","desc","content","substring","success","commit","shareCount","completeShareTask","cardConfig","card","cardUserId","portrait","head_picture","logo","name","user_name","card_id","webPageConfig","webPage","motto","test","marketingConfig","marketing","defaultShare","dataUrl","pay","chooseWXPay","timeStamp","signType","package","paySign","res","fail","error"],"mappings":"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","sourcesContent":["import store from '../store'\nimport wx from 'weixin-js-sdk'\nimport circle from '../api/circle'\nimport system from '../api/system'\nimport { delHTML } from '../utils'\nimport { reConstructPath } from '../utils/tools'\nimport { isIos, pageCover, getArticleCover, getParamsFromUrl } from '@/utils'\n\nlet isFirst = true\n\n// 微信签名随机字符串\nconst randomChar = function() {\n  let nonceStr = ''\n  let character = '0123456789qwertyuioplkjhgfdsazxcvbnm'\n  for (let i = 0; i < 16; i++) {\n    nonceStr += character[Math.ceil(Math.random() * 36)]\n  }\n  return nonceStr\n}\n\n/* \n    @nname  sha1加密函数\n    @desc   sha1加密函数\n    @params\n            s string\n*/\nconst sha1 = function(s) {\n  // 字符转码\n  const _encodeUTF8 = function(s) {\n    var i,\n      c,\n      x,\n      r = []\n    for (i = 0; i < s.length; i++)\n      if ((c = s.charCodeAt(i)) < 0x80) r.push(c)\n      else if (c < 0x800) r.push(0xc0 + ((c >> 6) & 0x1f), 0x80 + (c & 0x3f))\n      else {\n        if ((x = c ^ 0xd800) >> 10 == 0)\n          //对四字节UTF-16转换为Unicode\n          (c = (x << 10) + (s.charCodeAt(++i) ^ 0xdc00) + 0x10000),\n            r.push(0xf0 + ((c >> 18) & 0x7), 0x80 + ((c >> 12) & 0x3f))\n        else r.push(0xe0 + ((c >> 12) & 0xf))\n        r.push(0x80 + ((c >> 6) & 0x3f), 0x80 + (c & 0x3f))\n      }\n    return r\n  }\n\n  var data = new Uint8Array(_encodeUTF8(s))\n  var i, j, t\n  var l = (((data.length + 8) >>> 6) << 4) + 16,\n    s = new Uint8Array(l << 2)\n  s.set(new Uint8Array(data.buffer)), (s = new Uint32Array(s.buffer))\n  for (t = new DataView(s.buffer), i = 0; i < l; i++) s[i] = t.getUint32(i << 2)\n  s[data.length >> 2] |= 0x80 << (24 - (data.length & 3) * 8)\n  s[l - 1] = data.length << 3\n  var w = [],\n    f = [\n      function() {\n        return (m[1] & m[2]) | (~m[1] & m[3])\n      },\n      function() {\n        return m[1] ^ m[2] ^ m[3]\n      },\n      function() {\n        return (m[1] & m[2]) | (m[1] & m[3]) | (m[2] & m[3])\n      },\n      function() {\n        return m[1] ^ m[2] ^ m[3]\n      }\n    ],\n    rol = function(n, c) {\n      return (n << c) | (n >>> (32 - c))\n    },\n    k = [1518500249, 1859775393, -1894007588, -899497514],\n    m = [1732584193, -271733879, null, null, -1009589776]\n  ;(m[2] = ~m[0]), (m[3] = ~m[1])\n  for (i = 0; i < s.length; i += 16) {\n    var o = m.slice(0)\n    for (j = 0; j < 80; j++)\n      (w[j] =\n        j < 16\n          ? s[i + j]\n          : rol(w[j - 3] ^ w[j - 8] ^ w[j - 14] ^ w[j - 16], 1)),\n        (t =\n          (rol(m[0], 5) + f[(j / 20) | 0]() + m[4] + w[j] + k[(j / 20) | 0]) |\n          0),\n        (m[1] = rol(m[1], 30)),\n        m.pop(),\n        m.unshift(t)\n    for (j = 0; j < 5; j++) m[j] = (m[j] + o[j]) | 0\n  }\n  t = new DataView(new Uint32Array(m).buffer)\n  for (var i = 0; i < 5; i++) m[i] = t.getUint32(i << 2)\n\n  var hex = Array.prototype.map\n    .call(new Uint8Array(new Uint32Array(m).buffer), function(e) {\n      return (e < 16 ? '0' : '') + e.toString(16)\n    })\n    .join('')\n  return hex\n}\n\n/* \n    @nname  微信签名函数\n    @desc   微信签名函数\n    @params\n            apiList array   需要使用api\n*/\nconst signnure = function(apiList) {\n  let noncestr = randomChar()\n  let timestamp = new Date().getTime()\n  let appId = store.state.system.signature.app_id\n  let url = isIos() ? window.url : window.location.href\n  let jsapi_ticket = store.state.system.signature.jsapi_ticket\n  let signature = `jsapi_ticket=${jsapi_ticket}&noncestr=${noncestr}&timestamp=${timestamp}&url=${url}`\n  let options = {\n    debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\n    appId: appId, // 必填，公众号的唯一标识\n    nonceStr: noncestr, // 必填，生成签名的随机串\n    timestamp: timestamp, // 必填，生成签名的时间戳\n    signature: sha1(signature), // 必填，签名\n    jsApiList: apiList // 必填，需要使用的JS接口列表\n  }\n  return options\n}\n\nconst sdkService = {\n  config: async function(type) {\n    try {\n      let apiList\n      let menuList = [\n        'menuItem:share:qq',\n        'menuItem:copyUrl',\n        'menuItem:readMode',\n        'menuItem:share:QZone',\n        'menuItem:share:email',\n        'menuItem:share:weiboApp',\n        'menuItem:share:facebook'\n      ]\n      // if (type === 'ios') {\n      //   apiList = [\n      //     'hideMenuItems',\n      //     'showMenuItems',\n      //     'onMenuShareTimeline',\n      //     'onMenuShareAppMessage'\n      //   ]\n      // }\n      if (type === 'pay') {\n        apiList = ['chooseWXPay', 'hideMenuItems', 'showMenuItems']\n        menuList.push('menuItem:share:timeline')\n        menuList.push('menuItem:share:appMessage')\n      } else if (type === 'share') {\n        apiList = [\n          'hideMenuItems',\n          'showMenuItems',\n          'onMenuShareTimeline',\n          'onMenuShareAppMessage'\n        ]\n      } else if (type === 'shareTask') {\n        apiList = ['hideMenuItems', 'showMenuItems', 'onMenuShareTimeline']\n        menuList.push('menuItem:share:appMessage')\n      } else {\n        apiList = [\n          'hideMenuItems',\n          'showMenuItems',\n          'onMenuShareTimeline',\n          'onMenuShareAppMessage'\n        ]\n      }\n      if (isFirst && isIos()) {\n        isFirst = false\n        window.url = window.location.href\n      }\n      let options = signnure(apiList)\n      wx.config(options)\n      wx.ready(function() {\n        wx.showMenuItems({\n          menuList: ['menuItem:share:appMessage', 'menuItem:share:timeline']\n        })\n        wx.hideMenuItems({\n          menuList\n        })\n        let circleAudio = document.querySelector('#circleAudio')\n        if (circleAudio) {\n          circleAudio.play()\n          circleAudio.pause()\n        }\n      })\n    } catch (err) {\n      console.log(err)\n    }\n  },\n  /*\n    options: {\n        link: link,                         // 分享链接 *\n        desc: desc,                         // 分享描述 *\n        title: title,                       // 分享标题 *\n        imgUrl: imgUrl,                     // 分享封面 *\n        cancel: function() {},\n        success: function() {},\n        type: '',                           // 分享类型,music、video或link，不填默认为link\n        dataUrl: '',                        // 如果type是music或video，则要提供数据链接，默认为空\n    }\n  */\n  share: function(options) {\n    wx.onMenuShareTimeline(options)\n    wx.onMenuShareAppMessage(options)\n  },\n  /* \n    @name   articleConfig\n    @desc   文章分享配置 \n    @params \n            article,\n            shareId,\n            callback\n  */\n  articleConfig(article, shareId, callback, formCircle) {\n    let options, task, userId, userInfo\n    userInfo = store.state.user.userInfo\n    if (userInfo) userId = userInfo.id\n    task = getParamsFromUrl('task')\n    shareId = shareId || userId\n    let url = `${window.host}/?#/article/detail/${article.uuid ||\n      article.id}/${shareId}`\n    url = url + (formCircle ? `?${formCircle}` : '')\n    options = {\n      title: article.title,\n      link: reConstructPath(url),\n      imgUrl: getArticleCover(article.cover),\n      desc: delHTML(article.content).substring(0, 40),\n      success: async function() {\n        store.commit('system/shareGuide', false)\n        system.shareCount(1, article.uuid || article.id)\n        if (task) {\n          circle.completeShareTask(task)\n          if (callback) callback()\n        } else {\n          if (callback) callback()\n        }\n      }\n    }\n    return options\n  },\n  /* \n    @name   cardConfig\n    @desc   名片分享配置 \n    @params \n            card,\n            cardUserId,\n            callback\n  */\n  cardConfig(card, cardUserId, callback, formCircle) {\n    let options, task, userId, userInfo\n    userInfo = store.state.user.userInfo\n    if (userInfo) userId = userInfo.id\n    task = getParamsFromUrl('task')\n    let url = `${window.host}/?#/card/detail/${cardUserId}`\n    url = url + (formCircle ? `?${formCircle}` : '')\n    options = {\n      link: reConstructPath(url),\n      desc: '汇脉宝——共享流量，专注营销',\n      imgUrl: card.portrait || card.head_picture || card.logo,\n      title: `我是${card.name || card.user_name}，邀请您与我共享千万营销人名片`,\n      success: function() {\n        store.commit('system/shareGuide', false)\n        system.shareCount(3, card.card_id || card.id)\n        if (task) {\n          circle.completeShareTask(task)\n          if (callback) callback()\n        } else {\n          if (callback) callback()\n        }\n      }\n    }\n    return options\n  },\n  /* \n    @name   webPageConfig\n    @desc   个人微网分享配置 \n    @params \n            webPage,\n            callback\n  */\n  webPageConfig(webPage, callback, formCircle) {\n    let options, task, userId, userInfo\n    userInfo = store.state.user.userInfo\n    if (userInfo) userId = userInfo.id\n    task = getParamsFromUrl('task')\n    let cover = pageCover(webPage)\n    let url = `${window.host}/?#/webPage/detail/${webPage.id}`\n    url = url + (formCircle ? `?${formCircle}` : '')\n    options = {\n      title: webPage.title,\n      desc: webPage.motto || '汇脉宝——共享流量，专注营销',\n      link: reConstructPath(url),\n      imgUrl: /^http/.test(cover) ? cover : `${window.host + cover}`,\n      success: function() {\n        store.commit('system/shareGuide', false)\n        system.shareCount(2, webPage.id)\n        if (task) {\n          circle.completeShareTask(task)\n          if (callback) callback()\n        } else {\n          if (callback) callback()\n        }\n      }\n    }\n    return options\n  },\n  // 分享营销网页\n  marketingConfig(marketing, formCircle) {\n    let options, task, userId, userInfo\n    userInfo = store.state.user.userInfo\n    if (userInfo) userId = userInfo.id\n    task = getParamsFromUrl('task')\n    let url = `${window.host}/?#/marketing/detail/${marketing.id}`\n    url = url + (formCircle ? `?${formCircle}` : '')\n    options = {\n      title: marketing.title,\n      imgUrl: marketing.cover,\n      link: reConstructPath(url),\n      desc: '汇脉宝——共享流量，专注营销',\n      success: function() {\n        system.shareCount(4, marketing.id)\n        store.commit('system/shareGuide', false)\n        if (task) {\n          circle.completeShareTask(task)\n          if (callback) callback()\n        } else {\n          if (callback) callback()\n        }\n      }\n    }\n    return options\n  },\n  // 默认分享\n  defaultShare: function() {\n    let options = {\n      type: '',\n      dataUrl: '',\n      title: '汇脉宝',\n      link: window.host + '/',\n      desc: '汇脉宝——共享流量，专注营销',\n      imgUrl: `${window.host}/static/full-logo.png`\n    }\n    wx.ready(function() {\n      wx.onMenuShareTimeline(options)\n      wx.onMenuShareAppMessage(options)\n    })\n  },\n  /*\n    options: {\n        timeStamp: 0,                   // 支付签名时间戳，注意微信jssdk中的所有使用timestamp字段均为小写。但最新版的支付后台生成签名使用的timeStamp字段名需大写其中的S字符\n        nonceStr: '',                   // 支付签名随机串，不长于 32 位\n        package: '',                    // 统一支付接口返回的prepay_id参数值，提交格式如：prepay_id=\\*\\*\\*）\n        signType: '',                   // 签名方式，默认为'SHA1'，使用新版支付需传入'MD5'\n        paySign: '',                    // 支付签名\n        success: function(res) {}\n    }\n  */\n  pay: function(options) {\n    wx.chooseWXPay({\n      timestamp: options.timeStamp,\n      nonceStr: options.nonceStr,\n      signType: options.signType,\n      package: options.package,\n      paySign: options.paySign,\n      success: function(res) {\n        options.success(res)\n      },\n      fail: function(res) {}\n    })\n  }\n}\n\nwx.error(function(res) {\n  console.log(res)\n})\n\nexport default sdkService\n"]}]}
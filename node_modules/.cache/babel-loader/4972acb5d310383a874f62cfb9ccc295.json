{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/components/ArticleHeader/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/components/ArticleHeader/index.vue","mtime":1547019263091},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState, mapActions } from 'vuex';\nimport Article from '../../api/article/index';\nimport dialogService from '../../service/dialogService';\nimport loginTip from '../../utils/loginTip';\nexport default {\n  props: ['input', 'top', 'type'],\n  methods: {\n    goPreview: function goPreview() {\n      console.log(this.input, 222);\n      var self = this; // 分享者判断这个字段\n\n      if (this.input.has_page) {\n        this.$router.push({\n          path: \"/webPage/detail/\".concat(this.input.has_page)\n        });\n      } // 自己查看自己\n      else if (this.input.has_usertemp) {\n          this.$router.push({\n            path: \"/webPage/detail/\".concat(this.input.has_usertemp.id)\n          });\n        } else if (this.input.id === (this.user ? this.user.id : this.user)) {\n          // 如果是自己，网页没完善则调到完善网页去\n          dialogService.confirm('你还没有完善个人网页,是否前往完善', function (state) {\n            if (state) {\n              self.$router.push({\n                path: \"/webPage/mine\"\n              });\n            }\n          });\n        } else {\n          dialogService.alert('Ta还没有完善个人网页，暂时不能查看');\n        }\n    },\n    follow: function () {\n      var _follow = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var res, _res;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.user) {\n                  _context.next = 3;\n                  break;\n                }\n\n                loginTip(this);\n                return _context.abrupt(\"return\", false);\n\n              case 3:\n                if (!(this.input.id === 0)) {\n                  _context.next = 5;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", false);\n\n              case 5:\n                _context.prev = 5;\n\n                if (this.input.is_follow) {\n                  _context.next = 15;\n                  break;\n                }\n\n                _context.next = 9;\n                return Article.follow(this.input.id);\n\n              case 9:\n                res = _context.sent;\n\n                if (!(res.status !== 0)) {\n                  _context.next = 12;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 12:\n                this.input.is_follow = true;\n                _context.next = 21;\n                break;\n\n              case 15:\n                _context.next = 17;\n                return Article.unfollow(this.input.id);\n\n              case 17:\n                _res = _context.sent;\n\n                if (!(_res.status !== 0)) {\n                  _context.next = 20;\n                  break;\n                }\n\n                throw new Error(_res.message);\n\n              case 20:\n                this.input.is_follow = false;\n\n              case 21:\n                _context.next = 26;\n                break;\n\n              case 23:\n                _context.prev = 23;\n                _context.t0 = _context[\"catch\"](5);\n                dialogService.toast(_context.t0.message);\n\n              case 26:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[5, 23]]);\n      }));\n\n      function follow() {\n        return _follow.apply(this, arguments);\n      }\n\n      return follow;\n    }()\n  },\n  computed: _objectSpread({}, mapState({\n    user: function user(state) {\n      return state.user.userInfo;\n    }\n  }))\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<!-- \n    @name ArticleHeader\n    @desc 文章详情头部\n    @props \n        input       <object> 作者或分享人信息\n        top         <string> 区分是否在最顶端，顶端的需要有阴影\n -->\n\n<template>\n  <div class=\"author\" :class=\"[top?'active':'']\">\n    <div class=\"content\" v-if=\"input\">\n      <div class=\"content-left\">\n        <div class=\"head\">\n          <img :src=\"input.avatar||input.portrait||'/static/logo.png'\" alt=\"\">\n        </div>\n        <div class=\"name name-avatar\" v-if=\"input.avatar\">\n          <span>{{input.name}}</span>\n          <span>{{input.created_at?input.created_at.substring(0,10):''}}</span>\n        </div>\n        <div class=\"name name-portrait\" v-else>\n          <span>{{input.name}}</span>\n          <span>{{input.motto||'流量  资源  财富'}}</span>\n        </div>\n      </div>\n      <div class=\"content-right\">\n        <!-- 分享出去未登录时文章作者是汇赢天下 -->\n        <div v-if=\"!user&&input.id  == 0\"></div>\n        <!-- 没有登录且是作者的时候 -->\n        <div class=\"card btn\" @click.stop=\"follow()\" v-else-if=\"!user&&type == 1\">关注</div>\n        <!-- 没有登陆 -->\n        <div class=\"card btn\" @click.stop=\"goPreview()\" v-else-if=\"!user\">点击进入</div>\n        <!-- 登陆了但是是汇赢天下发的文章 -->\n        <div v-else-if=\"input.id  == 0\"></div>\n        <!-- 被封停 -->\n        <div class=\"card off btn\" v-else-if=\"input.is_enabled == 1\">已封停</div>\n        <!-- 登陆状态下自己看文章详情展示的是自己 -->\n        <div class=\"card btn\" @click.stop=\"goPreview()\" v-else-if=\"type == 2\">点击进入</div>\n        <!-- 作者信息 -->\n        <div class=\"card btn\" @click.stop=\"follow()\" v-else-if=\"type == 1\" :class=\"!input.is_follow?'':'active'\">{{!input.is_follow?'关注':'已关注'}}</div>\n        <!-- 其他 -->\n        <div class=\"card btn\" @click.stop=\"goPreview()\" v-else>点击进入</div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import {\n    mapState,\n    mapActions\n  } from 'vuex'\n  import Article from '../../api/article/index'\n  import dialogService from '../../service/dialogService'\n  import loginTip from '../../utils/loginTip'\n\n  export default {\n    props: ['input', 'top', 'type'],\n    methods: {\n      goPreview() {\n        console.log(this.input, 222)\n        let self = this\n        // 分享者判断这个字段\n        if (this.input.has_page) {\n          this.$router.push({\n            path: `/webPage/detail/${this.input.has_page}`\n          })\n        }\n        // 自己查看自己\n        else if (this.input.has_usertemp) {\n          this.$router.push({\n            path: `/webPage/detail/${this.input.has_usertemp.id}`\n          })\n        } else if (this.input.id === (this.user ? this.user.id : this.user)) {\n          // 如果是自己，网页没完善则调到完善网页去\n          dialogService.confirm('你还没有完善个人网页,是否前往完善', (state) => {\n\n            if (state) {\n              self.$router.push({\n                path: `/webPage/mine`\n              })\n            }\n\n          })\n        } else {\n          dialogService.alert('Ta还没有完善个人网页，暂时不能查看')\n        }\n      },\n      async follow() {\n        if (!this.user) {\n          loginTip(this)\n          return false\n        }\n        if (this.input.id === 0) {\n          // 后端要求\n          return false\n        }\n        try {\n          if (!this.input.is_follow) {\n            let res = await Article.follow(this.input.id)\n            if (res.status !== 0) {\n              throw new Error(res.message)\n            }\n            this.input.is_follow = true\n          } else {\n            let res = await Article.unfollow(this.input.id)\n            if (res.status !== 0) {\n              throw new Error(res.message)\n            }\n            this.input.is_follow = false\n          }\n        } catch (err) {\n          dialogService.toast(err.message)\n        }\n      }\n    },\n    computed: {\n      ...mapState({\n        user: state => state.user.userInfo\n      })\n    }\n  }\n</script>\n\n<style lang=\"scss\" scoped>\n  .author {\n    width: 100%;\n    padding: 2px 20px 0;\n    background: #ffffff;\n    box-sizing: border-box;\n    z-index: 10;\n\n    &.active {\n      box-shadow: 0 2px 16px rgba(0, 0, 0, 0.06);\n    }\n\n    .content {\n      display: flex;\n      padding: 18px 21px;\n\n      .content-left {\n        flex: 1;\n        font-size: 0;\n\n        .head {\n          width: 64px;\n          height: 64px;\n        }\n\n        .head,\n        .name {\n          display: inline-block;\n          vertical-align: top;\n\n          img {\n            width: 64px;\n            height: 64px;\n            border-radius: 50%;\n          }\n        }\n\n        .name {\n          width: 432px;\n          overflow: hidden;\n          line-height: 23px;\n          white-space: nowrap;\n          text-overflow: ellipsis;\n          font-size: 26px;\n          padding-left: 16px;\n          line-height: 64px;\n          color: #222;\n\n          span:nth-child(1) {\n            display: block;\n            line-height: 36px;\n            font-weight: bold;\n            font-size: 28px;\n          }\n\n          span:nth-child(2) {\n            font-size: 24px;\n            line-height: 24px;\n            display: block;\n            margin-top: 4px;\n            color: #666;\n          }\n        }\n      }\n    }\n\n    .content-right {\n      flex: 0 0 130px;\n      height: 50px;\n      width: 130px;\n      margin-top: 7px;\n\n      .card {\n        font-size: 24px;\n        line-height: 50px;\n        background: #4388e1;\n        box-sizing: border-box;\n        color: #ffffff;\n        border-radius: 25px;\n        text-align: center;\n\n        &.off {\n          background: #999;\n        }\n\n        &.active {\n          background: #fff;\n          border: 2px solid #e8e8e8;\n          color: #999;\n        }\n      }\n    }\n  }\n</style>"],"sourceRoot":"src/components/ArticleHeader"}]}
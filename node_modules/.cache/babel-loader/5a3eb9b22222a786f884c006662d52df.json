{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/module/article/index/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/module/article/index/index.vue","mtime":1547618571855},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.object.assign\";\nimport _objectSpread from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Wrapper from '../../../components/Wrapper';\nimport Aritcle from '../../../api/article';\nimport { mapState, mapActions } from 'vuex';\nimport ArticleItem from '../../../components/ArticleItem';\nimport AppHeader from '../../../components/AppHeader';\nimport ArticleAd from '../../../components/ArticleAd';\nimport dialogService from '../../../service/dialogService.js';\nimport FollowItem from '../../../components/FollowItem';\nimport AppLoading from '../../../components/AppLoading';\nimport FollowDetail from '../../../components/FollowDetail';\nimport Swiper from 'swiper';\nimport 'swiper/dist/css/swiper.min.css';\nimport guideService from '../../../service/guideService';\nexport default {\n  name: 'articleIndex',\n  data: function data() {\n    return {\n      defalutCategories: [{\n        id: 9999,\n        title: '关注',\n        is_modify: 0\n      }, {\n        id: 9998,\n        title: '推荐',\n        is_modify: 0\n      }],\n      // 默认必须加的标签\n      categories: [],\n      // 标签列表\n      categorieId: 9998,\n      // 默认推荐\n      article: [],\n      //文章\n      followUser: [],\n      // 关注作者\n      followId: null,\n      //作者id\n      followArticle: [],\n      // 关注作者发的文章\n      windowHeight: null,\n      // 可见区域高度\n      page: 1,\n      // 默认第一页\n      total: 1,\n      // 总页数\n      isRequest: false,\n      //是否正在请求\n      firstFollow: true,\n      // 是否第一次请求关注 false 不是 true 是\n      isShowPop: false // 是否显示弹窗\n\n    };\n  },\n  mounted: function () {\n    var _mounted = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!this.user) this.firstFollow = false;\n              this.windowHeight = document.documentElement.clientHeight;\n              this.init();\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function mounted() {\n      return _mounted.apply(this, arguments);\n    }\n\n    return mounted;\n  }(),\n  methods: _objectSpread({}, mapActions(['articles/setSelectedCategory', 'articles/setUnSelectedCategory', 'articles/setCategorysId', 'system/updateRouter', 'articles/updateArticleList']), {\n    // 关注作者详情\n    goUser: function goUser(id) {\n      this.followId = id;\n      this.isShowPop = true;\n    },\n    // 前往详情\n    gotoDetail: function gotoDetail(id, index) {\n      if (index < 15) {\n        var obj = Object.assign({}, this.articles.articleList);\n        obj[this.categorieId][index].pageviews += 1;\n        this['articles/updateArticleList'](obj);\n      } else {\n        this.$set(this.article[index], 'pageviews', this.article[index].pageviews + 1);\n      }\n\n      this.$router.push(\"/article/detail/\".concat(id));\n    },\n    // 监听滚动翻页\n    scrollHandler: function () {\n      var _scrollHandler = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(scrolled, scrollHeight) {\n        var scrollBottom;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!this.isRequest) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", false);\n\n              case 2:\n                scrollBottom = this.windowHeight + scrolled > scrollHeight - 100;\n\n                if (scrollBottom) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", false);\n\n              case 5:\n                if (!(this.categorieId === 9998)) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                this.getRecommend();\n                return _context2.abrupt(\"return\", false);\n\n              case 8:\n                if (this.page < this.total) {\n                  this.page += 1; // 关注\n\n                  if (this.categorieId === 9999) {\n                    this.getFollowArticle();\n                  } else {\n                    this.getArticle();\n                  }\n                }\n\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function scrollHandler(_x, _x2) {\n        return _scrollHandler.apply(this, arguments);\n      }\n\n      return scrollHandler;\n    }(),\n    init: function () {\n      var _init = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                try {\n                  // 是否登录\n                  if (this.user) {\n                    this.getUserCategories();\n                  } else {\n                    this.getCategories();\n                  }\n\n                  this.categorieId = this.articles.categorysId ? this.articles.categorysId : this.categorieId; // this.article = []\n\n                  this.article = this.articles.articleList[this.categorieId] ? this.articles.articleList[this.categorieId] : [];\n                  this.requestInterface();\n                } catch (error) {\n                  dialogService.toast(error.message);\n                }\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }(),\n    // 根据id判断请求什么接口\n    requestInterface: function () {\n      var _requestInterface = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee4() {\n        var obj;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!(this.categorieId === 9999)) {\n                  _context4.next = 6;\n                  break;\n                }\n\n                if (!this.user) {\n                  _context4.next = 4;\n                  break;\n                }\n\n                _context4.next = 4;\n                return this.getFollow();\n\n              case 4:\n                _context4.next = 13;\n                break;\n\n              case 6:\n                if (!(this.categorieId === 9998)) {\n                  _context4.next = 11;\n                  break;\n                }\n\n                _context4.next = 9;\n                return this.getRecommend('refresh');\n\n              case 9:\n                _context4.next = 13;\n                break;\n\n              case 11:\n                _context4.next = 13;\n                return this.getArticle('refresh');\n\n              case 13:\n                obj = Object.assign({}, this.articles.articleList);\n                obj[this.categorieId] = this.article;\n                this['articles/updateArticleList'](obj);\n\n              case 16:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function requestInterface() {\n        return _requestInterface.apply(this, arguments);\n      }\n\n      return requestInterface;\n    }(),\n    // 没登录获取默认标签\n    getCategories: function () {\n      var _getCategories = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee5() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (!this.articles.selectedCategory.length) {\n                  _context5.next = 4;\n                  break;\n                }\n\n                this.categories = this.articles.selectedCategory;\n                _context5.next = 11;\n                break;\n\n              case 4:\n                _context5.next = 6;\n                return Aritcle.getCategories();\n\n              case 6:\n                res = _context5.sent;\n\n                if (!(res.status !== 0)) {\n                  _context5.next = 9;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 9:\n                this.categories = this.defalutCategories.concat(res.data);\n                this['articles/setSelectedCategory'](this.categories);\n\n              case 11:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function getCategories() {\n        return _getCategories.apply(this, arguments);\n      }\n\n      return getCategories;\n    }(),\n    // 登录后获取自己的标签\n    getUserCategories: function () {\n      var _getUserCategories = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee6() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                if (!this.articles.selectedCategory.length) {\n                  _context6.next = 4;\n                  break;\n                }\n\n                this.categories = this.articles.selectedCategory;\n                _context6.next = 13;\n                break;\n\n              case 4:\n                _context6.next = 6;\n                return Aritcle.userCategory();\n\n              case 6:\n                res = _context6.sent;\n\n                if (!(res.status !== 0)) {\n                  _context6.next = 9;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 9:\n                res.data.unset.map(function (item) {\n                  if (item.is_modify === undefined) {\n                    item.is_modify = 1;\n                  }\n\n                  return item;\n                });\n                this.categories = this.defalutCategories.concat(res.data.set);\n                this['articles/setSelectedCategory'](this.categories);\n                this['articles/setUnSelectedCategory'](res.data.unset);\n\n              case 13:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function getUserCategories() {\n        return _getUserCategories.apply(this, arguments);\n      }\n\n      return getUserCategories;\n    }(),\n    // 选择列表\n    selectCategory: function () {\n      var _selectCategory = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee7(item) {\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                try {\n                  this.page = 1;\n                  this.total = 1;\n                  this.categorieId = item.id;\n                  this['articles/setCategorysId'](item.id);\n                  this.article = this.articles.articleList[item.id] ? this.articles.articleList[item.id] : [];\n                  document.documentElement.scrollTop = 0;\n                  this.requestInterface();\n                } catch (error) {\n                  dialogService.toast(error.message);\n                }\n\n              case 1:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function selectCategory(_x3) {\n        return _selectCategory.apply(this, arguments);\n      }\n\n      return selectCategory;\n    }(),\n    // 获取推荐分类\n    getRecommend: function () {\n      var _getRecommend = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee8(type) {\n        var res;\n        return regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                this.isRequest = true;\n                _context8.next = 3;\n                return Aritcle.getRecommend();\n\n              case 3:\n                res = _context8.sent;\n                this.isRequest = false;\n\n                if (!(res.status !== 0)) {\n                  _context8.next = 7;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 7:\n                this.article = type ? res.data.data : this.article.concat(res.data.data);\n\n              case 8:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function getRecommend(_x4) {\n        return _getRecommend.apply(this, arguments);\n      }\n\n      return getRecommend;\n    }(),\n    // 获取文章\n    getArticle: function () {\n      var _getArticle = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee9(type) {\n        var res;\n        return regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                this.isRequest = true;\n                _context9.next = 3;\n                return Aritcle.getArticles(this.page, this.categorieId);\n\n              case 3:\n                res = _context9.sent;\n                this.isRequest = false;\n\n                if (!(res.status !== 0)) {\n                  _context9.next = 7;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 7:\n                this.article = type ? res.data.data : this.article.concat(res.data.data);\n                this.page = res.data.current_page;\n                this.total = res.data.last_page;\n\n              case 10:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function getArticle(_x5) {\n        return _getArticle.apply(this, arguments);\n      }\n\n      return getArticle;\n    }(),\n    // 获取关注文章\n    getFollowArticle: function () {\n      var _getFollowArticle = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee10(type) {\n        var ress;\n        return regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _context10.prev = 0;\n                this.isRequest = true;\n                _context10.next = 4;\n                return Aritcle.getFollowArticle(this.page);\n\n              case 4:\n                ress = _context10.sent;\n                this.isRequest = false;\n\n                if (!(ress.status !== 0)) {\n                  _context10.next = 8;\n                  break;\n                }\n\n                throw new Error(ress.message);\n\n              case 8:\n                this.article = type ? ress.data.data : this.article.concat(ress.data.data);\n                this.page = ress.data.current_page;\n                this.total = ress.data.last_page;\n                _context10.next = 16;\n                break;\n\n              case 13:\n                _context10.prev = 13;\n                _context10.t0 = _context10[\"catch\"](0);\n                dialogService.toast(_context10.t0.message);\n\n              case 16:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this, [[0, 13]]);\n      }));\n\n      function getFollowArticle(_x6) {\n        return _getFollowArticle.apply(this, arguments);\n      }\n\n      return getFollowArticle;\n    }(),\n    // 得到关注信息\n    getFollow: function () {\n      var _getFollow = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee11() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.prev = 0;\n                _context11.next = 3;\n                return Aritcle.getFollowUser();\n\n              case 3:\n                res = _context11.sent;\n                _context11.next = 6;\n                return this.getFollowArticle('refresh');\n\n              case 6:\n                if (!(res.status !== 0)) {\n                  _context11.next = 8;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 8:\n                this.firstFollow = false;\n                this.followUser = res.data; // 作者\n\n                _context11.next = 15;\n                break;\n\n              case 12:\n                _context11.prev = 12;\n                _context11.t0 = _context11[\"catch\"](0);\n                dialogService.toast(_context11.t0.message);\n\n              case 15:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this, [[0, 12]]);\n      }));\n\n      function getFollow() {\n        return _getFollow.apply(this, arguments);\n      }\n\n      return getFollow;\n    }(),\n    // 前往推荐\n    goRecommend: function goRecommend() {\n      if (!this.user) {\n        guideService.login();\n        return false;\n      }\n\n      try {\n        this.categorieId = 9998;\n        this['articles/setCategorysId'](9998);\n        this.getRecommend('refresh');\n      } catch (error) {\n        dialogService.toast(error.message);\n      }\n    }\n  }),\n  beforeRouteLeave: function beforeRouteLeave(to, from, next) {\n    if (!/^\\/article/.test(to.path)) {\n      this['system/updateRouter']({\n        type: 'del',\n        data: 'articleIndex'\n      });\n    } // this.categorieId = 9998\n\n\n    this['articles/setCategorysId'](9998);\n    next(true);\n  },\n  computed: _objectSpread({}, mapState({\n    user: function user(state) {\n      return state.user.userInfo;\n    },\n    articles: function articles(state) {\n      return state.articles;\n    },\n    platform: function platform(state) {\n      return state.system.platform;\n    }\n  }), {\n    paddingTop: function paddingTop() {\n      return this.platform !== 'wechat' ? '162px' : '82px';\n    }\n  }),\n  components: {\n    Wrapper: Wrapper,\n    ArticleItem: ArticleItem,\n    AppHeader: AppHeader,\n    ArticleAd: ArticleAd,\n    FollowItem: FollowItem,\n    AppLoading: AppLoading,\n    FollowDetail: FollowDetail\n  },\n  watch: {\n    $route: function $route(to, from) {\n      var _this = this;\n\n      // 选择标签后，选择的标签取消后应默认推荐\n      if (from.path === '/article/classify') {\n        this.categories = this.articles.selectedCategory;\n        var flag = this.articles.selectedCategory.some(function (item) {\n          return item.id == _this.categorieId;\n        });\n        if (flag) return false;\n        this.categorieId = 9998;\n        this.article = this.articles.articleList[this.categorieId] ? this.articles.articleList[this.categorieId].splice(0, 0) : [];\n        this.goRecommend();\n      } // 当跳出文章板块后再次进入默认推荐\n      // if (to.path.indexOf('/article') === -1) {\n      //   if (to.path === '/login') {\n      //     this.firstFollow = false\n      //     return false;\n      //   }\n      //   this.isShowPop = false\n      //   this['articles/setCategorysId'](9998)\n      //   this.article = []\n      //   // this.article = this.articles.articleList[9998] ?\n      //   //   this.articles.articleList[9998].splice(0, 0) : []\n      //   this.goRecommend();\n      // }\n\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <Wrapper class=\"article\" ref=\"warp\" @scrolling=\"scrollHandler\" :paddingTop=\"paddingTop\" :class=\"[followUser.length?'bg':'',isShowPop?'m-h':'']\">\n    <div ref=\"header\" class=\"header-warp\" style=\"z-index:2;width:100%\">\n      <AppHeader title=\"文库\" iconColor=\"#fff\" fontColor=\"#fff\" background=\"#000\" v-if=\"this.platform!=='wechat'\"></AppHeader>\n      <div class=\"header\">\n        <ul class=\"tab-list\">\n          <li v-for=\"(item,index) in categories\" :key=\"index\" :class=\"categorieId==item.id?'active':''\" @click=\"selectCategory(item)\">{{item.title}}</li>\n        </ul>\n        <div class=\"mask\"></div>\n        <router-link tag=\"div\" class=\"operate\" to=\"/article/classify\">\n          <i class=\"iconfont icon-list\"></i>\n        </router-link>\n      </div>\n    </div>\n    <!-- 关注页面 -->\n    <template v-if=\"categorieId == 9999\">\n      <div class=\"loading-warp\" v-if=\"firstFollow\">\n        <AppLoading v-if=\"firstFollow\"></AppLoading>\n      </div>\n      <div class=\"follow\" v-else-if=\"!followUser.length\">\n        <div class=\"img-warp\">\n          <img src=\"./noNoticer3X.png\" alt=\"\">\n          <p>关注的人更新的动态会在这里出现</p>\n        </div>\n        <div class=\"btn\" @click=\"goRecommend\">关注感兴趣的人</div>\n      </div>\n      <div class=\"follow\" v-else>\n        <ul class=\"follow-list\">\n          <li v-for=\"(item,index) in followUser\" :key=\"index\" @click=\"goUser(item.id)\">\n            <div class=\"avatar\">\n              <img :src=\"item.avatar\" alt=\"\">\n              <img src=\"./more3x.png\" alt=\"\" class=\"level\" v-if=\"false\">\n            </div>\n            <div class=\"name\">{{item.account}}</div>\n          </li>\n        </ul>\n        <ul>\n          <li v-for=\"(item,index) in article\" :key=\"index\">\n            <FollowItem :item=\"item\"></FollowItem>\n          </li>\n        </ul>\n\n      </div>\n    </template>\n    <!-- 非关注页面 -->\n    <template v-else>\n      <div class=\"loading-warp\" v-if=\"isRequest&&!article.length\">\n        <AppLoading v-if=\"true\"></AppLoading>\n      </div>\n      <ul>\n        <li v-for=\"(item,index) in article\" :key=\"index\">\n          <ArticleAd v-if=\"item.is_ad\" :item=\"item\"></ArticleAd>\n          <ArticleItem :item=\"item\" @click.native=\"gotoDetail(item.id,index)\"></ArticleItem>\n        </li>\n        <li class=\"no-more\" v-if=\"this.article.length >6&&this.page === this.total&&this.categorieId!==9998&&!isRequest\">亲，没有更多了哟</li>\n      </ul>\n      <AppLoading v-if=\"isRequest&&article.length>6\" :type=\"'list'\"></AppLoading>\n    </template>\n    <!-- 关注详情 -->\n    <FollowDetail :show=\"isShowPop\" :followUser=\"followUser\" :id=\"followId\">\n      <i class=\"iconfont icon-cuo3\" @click=\"isShowPop=false\"></i>\n    </FollowDetail>\n  </Wrapper>\n</template>\n\n<script>\nimport Wrapper from '../../../components/Wrapper'\nimport Aritcle from '../../../api/article'\nimport { mapState, mapActions } from 'vuex'\nimport ArticleItem from '../../../components/ArticleItem'\nimport AppHeader from '../../../components/AppHeader'\nimport ArticleAd from '../../../components/ArticleAd'\nimport dialogService from '../../../service/dialogService.js'\nimport FollowItem from '../../../components/FollowItem'\nimport AppLoading from '../../../components/AppLoading'\nimport FollowDetail from '../../../components/FollowDetail'\nimport Swiper from 'swiper'\nimport 'swiper/dist/css/swiper.min.css'\nimport guideService from '../../../service/guideService'\nexport default {\n  name: 'articleIndex',\n  data() {\n    return {\n      defalutCategories: [\n        {\n          id: 9999,\n          title: '关注',\n          is_modify: 0\n        },\n        {\n          id: 9998,\n          title: '推荐',\n          is_modify: 0\n        }\n      ], // 默认必须加的标签\n      categories: [], // 标签列表\n      categorieId: 9998, // 默认推荐\n      article: [], //文章\n      followUser: [], // 关注作者\n      followId: null, //作者id\n      followArticle: [], // 关注作者发的文章\n      windowHeight: null, // 可见区域高度\n      page: 1, // 默认第一页\n      total: 1, // 总页数\n      isRequest: false, //是否正在请求\n      firstFollow: true, // 是否第一次请求关注 false 不是 true 是\n      isShowPop: false // 是否显示弹窗\n    }\n  },\n  async mounted() {\n    if (!this.user) this.firstFollow = false\n    this.windowHeight = document.documentElement.clientHeight\n    this.init()\n  },\n  methods: {\n    ...mapActions([\n      'articles/setSelectedCategory',\n      'articles/setUnSelectedCategory',\n      'articles/setCategorysId',\n      'system/updateRouter',\n      'articles/updateArticleList'\n    ]),\n    // 关注作者详情\n    goUser(id) {\n      this.followId = id\n      this.isShowPop = true\n    },\n    // 前往详情\n    gotoDetail(id, index) {\n      if (index < 15) {\n        let obj = Object.assign({}, this.articles.articleList)\n        obj[this.categorieId][index].pageviews += 1\n        this['articles/updateArticleList'](obj)\n      } else {\n        this.$set(\n          this.article[index],\n          'pageviews',\n          this.article[index].pageviews + 1\n        )\n      }\n      this.$router.push(`/article/detail/${id}`)\n    },\n    // 监听滚动翻页\n    async scrollHandler(scrolled, scrollHeight) {\n      if (this.isRequest) return false\n      let scrollBottom = this.windowHeight + scrolled > scrollHeight - 100\n      if (!scrollBottom) return false\n      if (this.categorieId === 9998) {\n        this.getRecommend()\n        return false\n      }\n      if (this.page < this.total) {\n        this.page += 1\n        // 关注\n        if (this.categorieId === 9999) {\n          this.getFollowArticle()\n        } else {\n          this.getArticle()\n        }\n      }\n    },\n    async init() {\n      try {\n        // 是否登录\n        if (this.user) {\n          this.getUserCategories()\n        } else {\n          this.getCategories()\n        }\n        this.categorieId = this.articles.categorysId\n          ? this.articles.categorysId\n          : this.categorieId\n        // this.article = []\n        this.article = this.articles.articleList[this.categorieId]\n          ? this.articles.articleList[this.categorieId]\n          : []\n        this.requestInterface()\n      } catch (error) {\n        dialogService.toast(error.message)\n      }\n    },\n    // 根据id判断请求什么接口\n    async requestInterface() {\n      if (this.categorieId === 9999) {\n        if (this.user) await this.getFollow()\n      } else if (this.categorieId === 9998) {\n        await this.getRecommend('refresh')\n      } else {\n        await this.getArticle('refresh')\n      }\n      let obj = Object.assign({}, this.articles.articleList)\n      obj[this.categorieId] = this.article\n      this['articles/updateArticleList'](obj)\n    },\n    // 没登录获取默认标签\n    async getCategories() {\n      // 判断是否有缓存\n      if (this.articles.selectedCategory.length) {\n        this.categories = this.articles.selectedCategory\n      } else {\n        let res = await Aritcle.getCategories()\n        if (res.status !== 0) {\n          throw new Error(res.message)\n        }\n        this.categories = this.defalutCategories.concat(res.data)\n        this['articles/setSelectedCategory'](this.categories)\n      }\n    },\n    // 登录后获取自己的标签\n    async getUserCategories() {\n      if (this.articles.selectedCategory.length) {\n        this.categories = this.articles.selectedCategory\n      } else {\n        let res = await Aritcle.userCategory()\n        if (res.status !== 0) {\n          throw new Error(res.message)\n        }\n        res.data.unset.map(item => {\n          if (item.is_modify === undefined) {\n            item.is_modify = 1\n          }\n          return item\n        })\n        this.categories = this.defalutCategories.concat(res.data.set)\n        this['articles/setSelectedCategory'](this.categories)\n        this['articles/setUnSelectedCategory'](res.data.unset)\n      }\n    },\n    // 选择列表\n    async selectCategory(item) {\n      try {\n        this.page = 1\n        this.total = 1\n        this.categorieId = item.id\n        this['articles/setCategorysId'](item.id)\n        this.article = this.articles.articleList[item.id]\n          ? this.articles.articleList[item.id]\n          : []\n        document.documentElement.scrollTop = 0\n        this.requestInterface()\n      } catch (error) {\n        dialogService.toast(error.message)\n      }\n    },\n    // 获取推荐分类\n    async getRecommend(type) {\n      this.isRequest = true\n      let res = await Aritcle.getRecommend()\n      this.isRequest = false\n      if (res.status !== 0) {\n        throw new Error(res.message)\n      }\n      this.article = type ? res.data.data : this.article.concat(res.data.data)\n    },\n    // 获取文章\n    async getArticle(type) {\n      this.isRequest = true\n      let res = await Aritcle.getArticles(this.page, this.categorieId)\n      this.isRequest = false\n      if (res.status !== 0) {\n        throw new Error(res.message)\n      }\n      this.article = type ? res.data.data : this.article.concat(res.data.data)\n      this.page = res.data.current_page\n      this.total = res.data.last_page\n    },\n    // 获取关注文章\n    async getFollowArticle(type) {\n      try {\n        this.isRequest = true\n        let ress = await Aritcle.getFollowArticle(this.page)\n        this.isRequest = false\n        if (ress.status !== 0) {\n          throw new Error(ress.message)\n        }\n        this.article = type\n          ? ress.data.data\n          : this.article.concat(ress.data.data)\n        this.page = ress.data.current_page\n        this.total = ress.data.last_page\n      } catch (error) {\n        dialogService.toast(error.message)\n      }\n    },\n    // 得到关注信息\n    async getFollow() {\n      try {\n        let res = await Aritcle.getFollowUser()\n        await this.getFollowArticle('refresh')\n        if (res.status !== 0) {\n          throw new Error(res.message)\n        }\n        this.firstFollow = false\n        this.followUser = res.data\n        // 作者\n      } catch (error) {\n        dialogService.toast(error.message)\n      }\n    },\n    // 前往推荐\n    goRecommend() {\n      if (!this.user) {\n        guideService.login()\n        return false\n      }\n      try {\n        this.categorieId = 9998\n        this['articles/setCategorysId'](9998)\n        this.getRecommend('refresh')\n      } catch (error) {\n        dialogService.toast(error.message)\n      }\n    }\n  },\n  beforeRouteLeave(to, from, next) {\n    if (!/^\\/article/.test(to.path)) {\n      this['system/updateRouter']({\n        type: 'del',\n        data: 'articleIndex'\n      })\n    }\n    // this.categorieId = 9998\n    this['articles/setCategorysId'](9998)\n    next(true)\n  },\n  computed: {\n    ...mapState({\n      user: state => state.user.userInfo,\n      articles: state => state.articles,\n      platform: state => state.system.platform\n    }),\n    paddingTop: function() {\n      return this.platform !== 'wechat' ? '162px' : '82px'\n    }\n  },\n  components: {\n    Wrapper,\n    ArticleItem,\n    AppHeader,\n    ArticleAd,\n    FollowItem,\n    AppLoading,\n    FollowDetail\n  },\n  watch: {\n    $route(to, from) {\n      // 选择标签后，选择的标签取消后应默认推荐\n      if (from.path === '/article/classify') {\n        this.categories = this.articles.selectedCategory\n        let flag = this.articles.selectedCategory.some(item => {\n          return item.id == this.categorieId\n        })\n        if (flag) return false\n        this.categorieId = 9998\n        this.article = this.articles.articleList[this.categorieId]\n          ? this.articles.articleList[this.categorieId].splice(0, 0)\n          : []\n        this.goRecommend()\n      }\n      // 当跳出文章板块后再次进入默认推荐\n      // if (to.path.indexOf('/article') === -1) {\n      //   if (to.path === '/login') {\n      //     this.firstFollow = false\n      //     return false;\n      //   }\n      //   this.isShowPop = false\n      //   this['articles/setCategorysId'](9998)\n      //   this.article = []\n      //   // this.article = this.articles.articleList[9998] ?\n      //   //   this.articles.articleList[9998].splice(0, 0) : []\n      //   this.goRecommend();\n      // }\n    }\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n@import './index.scss';\n</style>"],"sourceRoot":"src/module/article/index"}]}
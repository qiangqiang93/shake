{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/module/spread/shareHistroy/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/module/spread/shareHistroy/index.vue","mtime":1546400155063},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport spread from '../../../api/spread';\nimport dialogService from '../../../service/dialogService';\nexport default {\n  name: 'spreadShareHistory',\n  data: function data() {\n    return {\n      page: 0,\n      // 当前页码\n      list: [],\n      // 所有数据\n      allPage: null,\n      // 总页面数\n      loading: false\n    };\n  },\n  beforeMount: function beforeMount() {\n    this.init();\n  },\n  mounted: function mounted() {\n    window.addEventListener('scroll', this.loadMore, false);\n  },\n  destroyed: function destroyed() {\n    window.removeEventListener('scroll', this.loadMore, false);\n  },\n  methods: {\n    // 获取全民推广的历史记录\n    init: function () {\n      var _init = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return spread.getShareHistory(this.page);\n\n              case 3:\n                res = _context.sent;\n\n                if (!(res.status !== 0)) {\n                  _context.next = 6;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 6:\n                this.list = res.data.data;\n                this.page = res.data.current_page;\n                this.allPage = res.data.last_page;\n                _context.next = 14;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context[\"catch\"](0);\n                dialogService.alert(_context.t0.message);\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 11]]);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }(),\n    // 加载下一页\n    loadMore: function () {\n      var _loadMore = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!this.loading) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 2:\n                if (!(this.page >= this.allPage)) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 4:\n                this.loading = true;\n                _context2.prev = 5;\n                _context2.next = 8;\n                return spread.getShareHistory(this.page + 1);\n\n              case 8:\n                res = _context2.sent;\n\n                if (!(res.status !== 0)) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 11:\n                if (!(res.status !== 0)) {\n                  _context2.next = 13;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 13:\n                this.loading = true;\n                this.page = res.data.current_page;\n                this.list = this.list.concat(res.data.data); // 成功\n\n                _context2.next = 21;\n                break;\n\n              case 18:\n                _context2.prev = 18;\n                _context2.t0 = _context2[\"catch\"](5);\n                dialogService.alert(_context2.t0.message);\n\n              case 21:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[5, 18]]);\n      }));\n\n      function loadMore() {\n        return _loadMore.apply(this, arguments);\n      }\n\n      return loadMore;\n    }(),\n    // 广告详情\n    goToAD: function goToAD(item) {\n      if (item.user_marketing_id) {\n        this.$router.push({\n          path: \"/tools/marketing/detail/\".concat(item.user_marketing_id)\n        });\n      } else {\n        this.$router.push({\n          path: \"/spread/detail/\".concat(item.spread_id)\n        });\n      }\n    },\n    // 名片详情\n    goToCard: function goToCard(id) {\n      this.$router.push({\n        path: \"/card/detail/\".concat(id)\n      });\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"share-history\" :class=\"{'white': !list.length}\">\n    <div class=\"none\">\n      <img v-if=\"!list.length\" src=\"./none.gif\" style=\"width: 100%;\" alt=\"\">\n    </div>\n    <div class=\"share-item\" v-for=\"(item, index) in list\" :key=\"index\">\n      <div class=\"item-detail\" @click=\"goToAD(item)\">\n        <div class=\"item-poster\" :style=\"{'background-image': 'url('+item.cover+')'}\">\n        </div>\n        <div class=\"item-info\">\n          <p v-text=\"item.title\"></p>\n        </div>\n      </div>\n      <div class=\"item-card\">\n        <img :src=\"item.head_picture\" alt=\"\" class=\"head-img\" @click=\"goToCard(item.author_user_id)\">\n        <span class=\"name\" v-text=\"item.user_name\" @click=\"goToCard(item.author_user_id)\"></span>\n        <span class=\"date\">{{item.sharetime|timeFormt('YYYY-MM-DD')}}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport spread from '../../../api/spread'\nimport dialogService from '../../../service/dialogService'\nexport default {\n  name: 'spreadShareHistory',\n  data() {\n    return {\n      page: 0, // 当前页码\n      list: [], // 所有数据\n      allPage: null, // 总页面数\n      loading: false\n    }\n  },\n  beforeMount() {\n    this.init()\n  },\n  mounted() {\n    window.addEventListener('scroll', this.loadMore, false)\n  },\n  destroyed() {\n    window.removeEventListener('scroll', this.loadMore, false)\n  },\n  methods: {\n    // 获取全民推广的历史记录\n    async init() {\n      try {\n        let res = await spread.getShareHistory(this.page)\n        if (res.status !== 0) throw new Error(res.message)\n        this.list = res.data.data\n        this.page = res.data.current_page\n        this.allPage = res.data.last_page\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // 加载下一页\n    async loadMore() {\n      if (this.loading) return\n      if (this.page >= this.allPage) return\n      this.loading = true\n      try {\n        let res = await spread.getShareHistory(this.page + 1)\n        if (res.status !== 0) throw new Error(res.message)\n        if (res.status !== 0) throw new Error(res.message)\n        this.loading = true\n        this.page = res.data.current_page\n        this.list = this.list.concat(res.data.data)\n        // 成功\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // 广告详情\n    goToAD(item) {\n      if (item.user_marketing_id) {\n        this.$router.push({\n          path: `/tools/marketing/detail/${item.user_marketing_id}`\n        })\n      } else {\n        this.$router.push({\n          path: `/spread/detail/${item.spread_id}`\n        })\n      }\n    },\n    // 名片详情\n    goToCard(id) {\n      this.$router.push({\n        path: `/card/detail/${id}`\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.share-history {\n  width: 100%;\n  overflow: hidden;\n  min-height: 100vh;\n  background: #ededed;\n  &.white {\n    background: #fff;\n  }\n}\n.share-item {\n  width: 100%;\n  height: 304px;\n  padding: 30px;\n  margin-top: 20px;\n  background: #fff;\n  box-sizing: border-box;\n}\n.item-detail {\n  width: 100%;\n  height: 188px;\n  background: #f5f5f5;\n  box-sizing: border-box;\n  padding: 20px 30px 20px 20px;\n  .item-poster {\n    float: left;\n    width: 114px;\n    height: 150px;\n    overflow: hidden;\n    margin-right: 20px;\n    border-radius: 4px;\n    background-size: cover;\n    background-position: center;\n  }\n  .item-info {\n    float: left;\n    width: 490px;\n    height: 150px;\n    overflow: hidden;\n    padding-top: 20px;\n    box-sizing: border-box;\n    p {\n      font-size: 48px;\n      overflow: hidden;\n      line-height: 48px;\n      display: -webkit-box;\n      -webkit-line-clamp: 2;\n      -webkit-box-orient: vertical;\n      font-family: 'PingFang SC Medium';\n    }\n  }\n}\n.item-card {\n  height: 40px;\n  padding: 0 10px;\n  font-size: 24px;\n  color: #999999;\n  overflow: hidden;\n  margin-top: 24px;\n  box-sizing: border-box;\n  font-family: 'PingFang SC Medium';\n  img {\n    float: left;\n    width: 40px;\n    height: 40px;\n    overflow: hidden;\n    border-radius: 50%;\n  }\n  .name {\n    float: left;\n    line-height: 40px;\n    padding-left: 20px;\n    box-sizing: border-box;\n  }\n  .date {\n    float: right;\n    line-height: 40px;\n    margin-right: 30px;\n  }\n}\n</style>\n"],"sourceRoot":"src/module/spread/shareHistroy"}]}
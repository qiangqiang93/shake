{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/hytx-rebuild/node_modules/eslint-loader/index.js??ref--13-0!/Users/qiang/work/hytx/hytx-rebuild/src/service/sdkService.js","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/service/sdkService.js","mtime":1546946999382},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.typed.uint32-array\";\nimport \"core-js/modules/es6.typed.uint8-array\";\nimport store from '../store';\nimport wx from 'weixin-js-sdk';\nimport circle from '../api/circle';\nimport dialogService from '../service/dialogService';\nimport { isIos, pageCover, getArticleCover, getParamsFromUrl } from '@/utils'; // 微信签名随机字符串\n\nvar randomChar = function randomChar() {\n  var nonceStr = '';\n  var character = '0123456789qwertyuioplkjhgfdsazxcvbnm';\n\n  for (var i = 0; i < 16; i++) {\n    nonceStr += character[Math.ceil(Math.random() * 36)];\n  }\n\n  return nonceStr;\n};\n/* \n    @nname  sha1加密函数\n    @desc   sha1加密函数\n    @params\n            s string\n*/\n\n\nvar sha1 = function sha1(s) {\n  // 字符转码\n  var _encodeUTF8 = function _encodeUTF8(s) {\n    var i,\n        c,\n        x,\n        r = [];\n\n    for (i = 0; i < s.length; i++) {\n      if ((c = s.charCodeAt(i)) < 0x80) r.push(c);else if (c < 0x800) r.push(0xc0 + (c >> 6 & 0x1f), 0x80 + (c & 0x3f));else {\n        if ((x = c ^ 0xd800) >> 10 == 0) //对四字节UTF-16转换为Unicode\n          c = (x << 10) + (s.charCodeAt(++i) ^ 0xdc00) + 0x10000, r.push(0xf0 + (c >> 18 & 0x7), 0x80 + (c >> 12 & 0x3f));else r.push(0xe0 + (c >> 12 & 0xf));\n        r.push(0x80 + (c >> 6 & 0x3f), 0x80 + (c & 0x3f));\n      }\n    }\n\n    return r;\n  };\n\n  var data = new Uint8Array(_encodeUTF8(s));\n  var i, j, t;\n  var l = (data.length + 8 >>> 6 << 4) + 16,\n      s = new Uint8Array(l << 2);\n  s.set(new Uint8Array(data.buffer)), s = new Uint32Array(s.buffer);\n\n  for (t = new DataView(s.buffer), i = 0; i < l; i++) {\n    s[i] = t.getUint32(i << 2);\n  }\n\n  s[data.length >> 2] |= 0x80 << 24 - (data.length & 3) * 8;\n  s[l - 1] = data.length << 3;\n\n  var w = [],\n      f = [function () {\n    return m[1] & m[2] | ~m[1] & m[3];\n  }, function () {\n    return m[1] ^ m[2] ^ m[3];\n  }, function () {\n    return m[1] & m[2] | m[1] & m[3] | m[2] & m[3];\n  }, function () {\n    return m[1] ^ m[2] ^ m[3];\n  }],\n      rol = function rol(n, c) {\n    return n << c | n >>> 32 - c;\n  },\n      k = [1518500249, 1859775393, -1894007588, -899497514],\n      m = [1732584193, -271733879, null, null, -1009589776];\n\n  m[2] = ~m[0], m[3] = ~m[1];\n\n  for (i = 0; i < s.length; i += 16) {\n    var o = m.slice(0);\n\n    for (j = 0; j < 80; j++) {\n      w[j] = j < 16 ? s[i + j] : rol(w[j - 3] ^ w[j - 8] ^ w[j - 14] ^ w[j - 16], 1), t = rol(m[0], 5) + f[j / 20 | 0]() + m[4] + w[j] + k[j / 20 | 0] | 0, m[1] = rol(m[1], 30), m.pop(), m.unshift(t);\n    }\n\n    for (j = 0; j < 5; j++) {\n      m[j] = m[j] + o[j] | 0;\n    }\n  }\n\n  t = new DataView(new Uint32Array(m).buffer);\n\n  for (var i = 0; i < 5; i++) {\n    m[i] = t.getUint32(i << 2);\n  }\n\n  var hex = Array.prototype.map.call(new Uint8Array(new Uint32Array(m).buffer), function (e) {\n    return (e < 16 ? '0' : '') + e.toString(16);\n  }).join('');\n  return hex;\n};\n/* \n    @nname  微信签名函数\n    @desc   微信签名函数\n    @params\n            apiList array   需要使用api\n*/\n\n\nvar signnure = function signnure(apiList) {\n  var noncestr = randomChar();\n  var timestamp = new Date().getTime();\n  var appId = store.state.system.signature.app_id;\n  var url = isIos() ? window.url : window.location.href;\n  var jsapi_ticket = store.state.system.signature.jsapi_ticket;\n  var signature = \"jsapi_ticket=\".concat(jsapi_ticket, \"&noncestr=\").concat(noncestr, \"&timestamp=\").concat(timestamp, \"&url=\").concat(url);\n  var options = {\n    debug: false,\n    // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\n    appId: appId,\n    // 必填，公众号的唯一标识\n    nonceStr: noncestr,\n    // 必填，生成签名的随机串\n    timestamp: timestamp,\n    // 必填，生成签名的时间戳\n    signature: sha1(signature),\n    // 必填，签名\n    jsApiList: apiList // 必填，需要使用的JS接口列表\n\n  };\n  return options;\n};\n\nvar ios = isIos();\nvar sdkService = {\n  config: function () {\n    var _config = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee(type) {\n      var apiList, menuList, options;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(ios && type !== 'ios' && type !== 'pay')) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 2:\n              try {\n                menuList = ['menuItem:share:qq', 'menuItem:copyUrl', 'menuItem:readMode', 'menuItem:share:QZone', 'menuItem:share:email', 'menuItem:share:weiboApp', 'menuItem:share:facebook', 'menuItem:openWithSafari', 'menuItem:openWithQQBrowser'];\n\n                if (type === 'ios') {\n                  apiList = ['hideMenuItems', 'onMenuShareTimeline', 'onMenuShareAppMessage'];\n                } else if (type === 'pay') {\n                  apiList = ['chooseWXPay', 'hideMenuItems'];\n                  menuList.push('menuItem:share:timeline');\n                  menuList.push('menuItem:share:appMessage');\n                } else if (type === 'share') {\n                  apiList = ['hideMenuItems', 'onMenuShareTimeline', 'onMenuShareAppMessage'];\n                } else if (type === 'shareTask') {\n                  apiList = ['hideMenuItems', 'onMenuShareTimeline'];\n                  menuList.push('menuItem:share:appMessage');\n                } else {\n                  apiList = ['hideMenuItems', 'onMenuShareTimeline', 'onMenuShareAppMessage'];\n                }\n\n                options = signnure(apiList);\n                wx.config(options);\n                wx.ready(function () {\n                  wx.hideMenuItems({\n                    menuList: menuList\n                  });\n                });\n              } catch (err) {\n                console.log(err);\n              }\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function config(_x) {\n      return _config.apply(this, arguments);\n    }\n\n    return config;\n  }(),\n\n  /*\n    options: {\n        link: link,                         // 分享链接 *\n        desc: desc,                         // 分享描述 *\n        title: title,                       // 分享标题 *\n        imgUrl: imgUrl,                     // 分享封面 *\n        cancel: function() {},\n        success: function() {},\n        type: '',                           // 分享类型,music、video或link，不填默认为link\n        dataUrl: '',                        // 如果type是music或video，则要提供数据链接，默认为空\n    }\n  */\n  share: function share(options) {\n    wx.onMenuShareTimeline(options);\n    wx.onMenuShareAppMessage(options);\n  },\n\n  /* \n    @name   articleConfig\n    @desc   文章分享配置 \n    @params \n            article,\n            shareId,\n            callback\n  */\n  articleConfig: function articleConfig(article, shareId, callback) {\n    var options, isTask, userId, userInfo;\n    userInfo = store.state.user.userInfo;\n    if (userInfo) userId = userInfo.id;\n    isTask = getParamsFromUrl('task');\n    shareId = shareId || userId;\n    options = {\n      title: article.title,\n      desc: article.content.substring(0, 40),\n      imgUrl: getArticleCover(article.cover),\n      link: \"\".concat(window.host, \"/?#/article/detail/\").concat(article.uuid || article.id, \"/\").concat(shareId),\n      success: function () {\n        var _success = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee2() {\n          return regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  store.commit('system/shareGuide', false);\n\n                  if (!isTask) {\n                    _context2.next = 7;\n                    break;\n                  }\n\n                  _context2.next = 4;\n                  return circle.shareMatchedInfo({\n                    user_id: userId,\n                    material_style: 1,\n                    material_id: article.uuid || article.id\n                  });\n\n                case 4:\n                  if (callback) callback();\n                  _context2.next = 8;\n                  break;\n\n                case 7:\n                  if (callback) callback();\n\n                case 8:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this);\n        }));\n\n        function success() {\n          return _success.apply(this, arguments);\n        }\n\n        return success;\n      }()\n    };\n    return options;\n  },\n\n  /* \n    @name   cardConfig\n    @desc   名片分享配置 \n    @params \n            card,\n            cardUserId,\n            callback\n  */\n  cardConfig: function cardConfig(card, cardUserId, callback) {\n    var options, isTask, userId, userInfo;\n    userInfo = store.state.user.userInfo;\n    if (userInfo) userId = userInfo.id;\n    isTask = getParamsFromUrl('task');\n    options = {\n      imgUrl: card.portrait,\n      title: \"\".concat(card.name, \"\\u7684\\u540D\\u7247\"),\n      desc: \"\\u6211\\u662F\".concat(card.name, \"\\uFF0C\\u9080\\u8BF7\\u60A8\\u4E0E\\u6211\\u5171\\u4EAB\\u5343\\u4E07\\u8425\\u9500\\u4EBA\\u540D\\u7247\"),\n      link: \"\".concat(window.host, \"/?#/card/detail/\").concat(cardUserId),\n      success: function success() {\n        store.commit('system/shareGuide', false);\n\n        if (isTask) {\n          circle.shareMatchedInfo({\n            user_id: userId,\n            material_style: 4,\n            material_id: card.id\n          });\n          if (callback) callback();\n        } else {\n          if (callback) callback();\n        }\n      }\n    };\n    return options;\n  },\n\n  /* \n    @name   webPageConfig\n    @desc   个人微网分享配置 \n    @params \n            webPage,\n            callback\n  */\n  webPageConfig: function webPageConfig(webPage, callback) {\n    var options, isTask, userId, userInfo;\n    userInfo = store.state.user.userInfo;\n    if (userInfo) userId = userInfo.id;\n    isTask = getParamsFromUrl('task');\n    var cover = pageCover(webPage);\n    options = {\n      title: webPage.title,\n      desc: webPage.motto || '汇脉宝——共享流量，专注营销',\n      link: \"\".concat(window.host, \"/?#/webPage/detail/\").concat(webPage.id),\n      imgUrl: /^http/.test(cover) ? cover : \"\".concat(window.host + cover),\n      success: function success() {\n        store.commit('system/shareGuide', false);\n\n        if (isTask) {\n          circle.shareMatchedInfo({\n            user_id: userId,\n            material_style: 2,\n            material_id: webPage.id\n          });\n          if (callback) callback();\n        } else {\n          if (callback) callback();\n        }\n      }\n    };\n    return options;\n  },\n  // 分享营销网页\n  marketingConfig: function marketingConfig(marketing) {\n    var options, isTask, userId, userInfo;\n    userInfo = store.state.user.userInfo;\n    if (userInfo) userId = userInfo.id;\n    isTask = getParamsFromUrl('task');\n    options = {\n      title: marketing.title,\n      imgUrl: marketing.cover,\n      desc: '汇脉宝——共享流量，专注营销',\n      link: \"\".concat(window.host, \"/?#/marketing/detail/\").concat(marketing.id),\n      success: function success() {\n        store.commit('system/shareGuide', false);\n\n        if (isTask) {\n          circle.shareMatchedInfo({\n            user_id: userId,\n            material_style: 3,\n            material_id: marketing.id\n          });\n          if (callback) callback();\n        } else {\n          if (callback) callback();\n        }\n      }\n    };\n    return options;\n  },\n  // 默认分享\n  defaultShare: function defaultShare() {\n    var options = {\n      type: '',\n      dataUrl: '',\n      title: '汇脉宝',\n      link: window.host + '/?#/article',\n      desc: '汇脉宝——共享流量，专注营销',\n      imgUrl: \"\".concat(window.host, \"/static/full-logo.png\")\n    };\n    wx.ready(function () {\n      wx.onMenuShareTimeline(options);\n      wx.onMenuShareAppMessage(options);\n    });\n  },\n\n  /*\n    options: {\n        timeStamp: 0,                   // 支付签名时间戳，注意微信jssdk中的所有使用timestamp字段均为小写。但最新版的支付后台生成签名使用的timeStamp字段名需大写其中的S字符\n        nonceStr: '',                   // 支付签名随机串，不长于 32 位\n        package: '',                    // 统一支付接口返回的prepay_id参数值，提交格式如：prepay_id=\\*\\*\\*）\n        signType: '',                   // 签名方式，默认为'SHA1'，使用新版支付需传入'MD5'\n        paySign: '',                    // 支付签名\n        success: function(res) {}\n    }\n  */\n  pay: function pay(options) {\n    wx.chooseWXPay({\n      timestamp: options.timeStamp,\n      nonceStr: options.nonceStr,\n      signType: options.signType,\n      package: options.package,\n      paySign: options.paySign,\n      success: function success(res) {\n        options.success(res);\n      },\n      fail: function fail(res) {\n        dialogService.alert(res);\n      }\n    });\n  }\n};\nwx.error(function (res) {\n  console.log(res);\n});\nexport default sdkService;",{"version":3,"sources":["/Users/qiang/work/hytx/hytx-rebuild/src/service/sdkService.js"],"names":["store","wx","circle","dialogService","isIos","pageCover","getArticleCover","getParamsFromUrl","randomChar","nonceStr","character","i","Math","ceil","random","sha1","s","_encodeUTF8","c","x","r","length","charCodeAt","push","data","Uint8Array","j","t","l","set","buffer","Uint32Array","DataView","getUint32","w","f","m","rol","n","k","o","slice","pop","unshift","hex","Array","prototype","map","call","e","toString","join","signnure","apiList","noncestr","timestamp","Date","getTime","appId","state","system","signature","app_id","url","window","location","href","jsapi_ticket","options","debug","jsApiList","ios","sdkService","config","type","menuList","ready","hideMenuItems","err","console","log","share","onMenuShareTimeline","onMenuShareAppMessage","articleConfig","article","shareId","callback","isTask","userId","userInfo","user","id","title","desc","content","substring","imgUrl","cover","link","host","uuid","success","commit","shareMatchedInfo","user_id","material_style","material_id","cardConfig","card","cardUserId","portrait","name","webPageConfig","webPage","motto","test","marketingConfig","marketing","defaultShare","dataUrl","pay","chooseWXPay","timeStamp","signType","package","paySign","res","fail","alert","error"],"mappings":"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","sourcesContent":["import store from '../store'\nimport wx from 'weixin-js-sdk'\nimport circle from '../api/circle'\nimport dialogService from '../service/dialogService'\nimport {\n  isIos,\n  pageCover,\n  getArticleCover,\n  getParamsFromUrl\n} from '@/utils'\n\n// 微信签名随机字符串\nconst randomChar = function () {\n  let nonceStr = ''\n  let character = '0123456789qwertyuioplkjhgfdsazxcvbnm'\n  for (let i = 0; i < 16; i++) {\n    nonceStr += character[Math.ceil(Math.random() * 36)]\n  }\n  return nonceStr\n}\n\n/* \n    @nname  sha1加密函数\n    @desc   sha1加密函数\n    @params\n            s string\n*/\nconst sha1 = function (s) {\n  // 字符转码\n  const _encodeUTF8 = function (s) {\n    var i,\n      c,\n      x,\n      r = []\n    for (i = 0; i < s.length; i++)\n      if ((c = s.charCodeAt(i)) < 0x80) r.push(c)\n    else if (c < 0x800) r.push(0xc0 + ((c >> 6) & 0x1f), 0x80 + (c & 0x3f))\n    else {\n      if ((x = c ^ 0xd800) >> 10 == 0)\n        //对四字节UTF-16转换为Unicode\n        (c = (x << 10) + (s.charCodeAt(++i) ^ 0xdc00) + 0x10000),\n        r.push(0xf0 + ((c >> 18) & 0x7), 0x80 + ((c >> 12) & 0x3f))\n      else r.push(0xe0 + ((c >> 12) & 0xf))\n      r.push(0x80 + ((c >> 6) & 0x3f), 0x80 + (c & 0x3f))\n    }\n    return r\n  }\n\n  var data = new Uint8Array(_encodeUTF8(s))\n  var i, j, t\n  var l = (((data.length + 8) >>> 6) << 4) + 16,\n    s = new Uint8Array(l << 2)\n  s.set(new Uint8Array(data.buffer)), (s = new Uint32Array(s.buffer))\n  for (t = new DataView(s.buffer), i = 0; i < l; i++) s[i] = t.getUint32(i << 2)\n  s[data.length >> 2] |= 0x80 << (24 - (data.length & 3) * 8)\n  s[l - 1] = data.length << 3\n  var w = [],\n    f = [\n      function () {\n        return (m[1] & m[2]) | (~m[1] & m[3])\n      },\n      function () {\n        return m[1] ^ m[2] ^ m[3]\n      },\n      function () {\n        return (m[1] & m[2]) | (m[1] & m[3]) | (m[2] & m[3])\n      },\n      function () {\n        return m[1] ^ m[2] ^ m[3]\n      }\n    ],\n    rol = function (n, c) {\n      return (n << c) | (n >>> (32 - c))\n    },\n    k = [1518500249, 1859775393, -1894007588, -899497514],\n    m = [1732584193, -271733879, null, null, -1009589776];\n  (m[2] = ~m[0]), (m[3] = ~m[1])\n  for (i = 0; i < s.length; i += 16) {\n    var o = m.slice(0)\n    for (j = 0; j < 80; j++)\n      (w[j] =\n        j < 16 ?\n        s[i + j] :\n        rol(w[j - 3] ^ w[j - 8] ^ w[j - 14] ^ w[j - 16], 1)),\n      (t =\n        (rol(m[0], 5) + f[(j / 20) | 0]() + m[4] + w[j] + k[(j / 20) | 0]) |\n        0),\n      (m[1] = rol(m[1], 30)),\n      m.pop(),\n      m.unshift(t)\n    for (j = 0; j < 5; j++) m[j] = (m[j] + o[j]) | 0\n  }\n  t = new DataView(new Uint32Array(m).buffer)\n  for (var i = 0; i < 5; i++) m[i] = t.getUint32(i << 2)\n\n  var hex = Array.prototype.map\n    .call(new Uint8Array(new Uint32Array(m).buffer), function (e) {\n      return (e < 16 ? '0' : '') + e.toString(16)\n    })\n    .join('')\n  return hex\n}\n\n/* \n    @nname  微信签名函数\n    @desc   微信签名函数\n    @params\n            apiList array   需要使用api\n*/\nconst signnure = function (apiList) {\n  let noncestr = randomChar()\n  let timestamp = new Date().getTime()\n  let appId = store.state.system.signature.app_id\n  let url = isIos() ? window.url : window.location.href\n  let jsapi_ticket = store.state.system.signature.jsapi_ticket\n  let signature = `jsapi_ticket=${jsapi_ticket}&noncestr=${noncestr}&timestamp=${timestamp}&url=${url}`\n  let options = {\n    debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\n    appId: appId, // 必填，公众号的唯一标识\n    nonceStr: noncestr, // 必填，生成签名的随机串\n    timestamp: timestamp, // 必填，生成签名的时间戳\n    signature: sha1(signature), // 必填，签名\n    jsApiList: apiList // 必填，需要使用的JS接口列表\n  }\n  return options\n}\n\nconst ios = isIos()\n\nconst sdkService = {\n  config: async function (type) {\n    if (ios && (type !== 'ios' && type !== 'pay')) return\n    try {\n      let apiList\n      let menuList = [\n        'menuItem:share:qq',\n        'menuItem:copyUrl',\n        'menuItem:readMode',\n        'menuItem:share:QZone',\n        'menuItem:share:email',\n        'menuItem:share:weiboApp',\n        'menuItem:share:facebook',\n        'menuItem:openWithSafari',\n        'menuItem:openWithQQBrowser'\n      ]\n      if (type === 'ios') {\n        apiList = [\n          'hideMenuItems',\n          'onMenuShareTimeline',\n          'onMenuShareAppMessage'\n        ]\n      } else if (type === 'pay') {\n        apiList = ['chooseWXPay', 'hideMenuItems']\n        menuList.push('menuItem:share:timeline')\n        menuList.push('menuItem:share:appMessage')\n      } else if (type === 'share') {\n        apiList = [\n          'hideMenuItems',\n          'onMenuShareTimeline',\n          'onMenuShareAppMessage'\n        ]\n      } else if (type === 'shareTask') {\n        apiList = ['hideMenuItems', 'onMenuShareTimeline']\n        menuList.push('menuItem:share:appMessage')\n      } else {\n        apiList = [\n          'hideMenuItems',\n          'onMenuShareTimeline',\n          'onMenuShareAppMessage'\n        ]\n      }\n\n      let options = signnure(apiList)\n      wx.config(options)\n      wx.ready(function () {\n        wx.hideMenuItems({\n          menuList\n        })\n      })\n    } catch (err) {\n      console.log(err)\n    }\n  },\n  /*\n    options: {\n        link: link,                         // 分享链接 *\n        desc: desc,                         // 分享描述 *\n        title: title,                       // 分享标题 *\n        imgUrl: imgUrl,                     // 分享封面 *\n        cancel: function() {},\n        success: function() {},\n        type: '',                           // 分享类型,music、video或link，不填默认为link\n        dataUrl: '',                        // 如果type是music或video，则要提供数据链接，默认为空\n    }\n  */\n  share: function (options) {\n    wx.onMenuShareTimeline(options)\n    wx.onMenuShareAppMessage(options)\n  },\n  /* \n    @name   articleConfig\n    @desc   文章分享配置 \n    @params \n            article,\n            shareId,\n            callback\n  */\n  articleConfig(article, shareId, callback) {\n    let options, isTask, userId, userInfo\n    userInfo = store.state.user.userInfo\n    if (userInfo) userId = userInfo.id\n    isTask = getParamsFromUrl('task')\n    shareId = shareId || userId\n    options = {\n      title: article.title,\n      desc: article.content.substring(0, 40),\n      imgUrl: getArticleCover(article.cover),\n      link: `${window.host}/?#/article/detail/${article.uuid ||\n        article.id}/${shareId}`,\n      success: async function () {\n        store.commit('system/shareGuide', false)\n        if (isTask) {\n          await circle.shareMatchedInfo({\n            user_id: userId,\n            material_style: 1,\n            material_id: article.uuid || article.id\n          })\n          if (callback) callback()\n        } else {\n          if (callback) callback()\n        }\n      }\n    }\n    return options\n  },\n  /* \n    @name   cardConfig\n    @desc   名片分享配置 \n    @params \n            card,\n            cardUserId,\n            callback\n  */\n  cardConfig(card, cardUserId, callback) {\n    let options, isTask, userId, userInfo\n    userInfo = store.state.user.userInfo\n    if (userInfo) userId = userInfo.id\n    isTask = getParamsFromUrl('task')\n    options = {\n      imgUrl: card.portrait,\n      title: `${card.name}的名片`,\n      desc: `我是${card.name}，邀请您与我共享千万营销人名片`,\n      link: `${window.host}/?#/card/detail/${cardUserId}`,\n      success: function () {\n        store.commit('system/shareGuide', false)\n        if (isTask) {\n          circle.shareMatchedInfo({\n            user_id: userId,\n            material_style: 4,\n            material_id: card.id\n          })\n          if (callback) callback()\n        } else {\n          if (callback) callback()\n        }\n      }\n    }\n    return options\n  },\n  /* \n    @name   webPageConfig\n    @desc   个人微网分享配置 \n    @params \n            webPage,\n            callback\n  */\n  webPageConfig(webPage, callback) {\n    let options, isTask, userId, userInfo\n    userInfo = store.state.user.userInfo\n    if (userInfo) userId = userInfo.id\n    isTask = getParamsFromUrl('task')\n    let cover = pageCover(webPage)\n    options = {\n      title: webPage.title,\n      desc: webPage.motto || '汇脉宝——共享流量，专注营销',\n      link: `${window.host}/?#/webPage/detail/${webPage.id}`,\n      imgUrl: /^http/.test(cover) ? cover : `${window.host + cover}`,\n      success: function () {\n        store.commit('system/shareGuide', false)\n        if (isTask) {\n          circle.shareMatchedInfo({\n            user_id: userId,\n            material_style: 2,\n            material_id: webPage.id\n          })\n          if (callback) callback()\n        } else {\n          if (callback) callback()\n        }\n      }\n    }\n    return options\n  },\n  // 分享营销网页\n  marketingConfig(marketing) {\n    let options, isTask, userId, userInfo\n    userInfo = store.state.user.userInfo\n    if (userInfo) userId = userInfo.id\n    isTask = getParamsFromUrl('task')\n    options = {\n      title: marketing.title,\n      imgUrl: marketing.cover,\n      desc: '汇脉宝——共享流量，专注营销',\n      link: `${window.host}/?#/marketing/detail/${marketing.id}`,\n      success: function () {\n        store.commit('system/shareGuide', false)\n        if (isTask) {\n          circle.shareMatchedInfo({\n            user_id: userId,\n            material_style: 3,\n            material_id: marketing.id\n          })\n          if (callback) callback()\n        } else {\n          if (callback) callback()\n        }\n      }\n    }\n    return options\n  },\n  // 默认分享\n  defaultShare: function () {\n    let options = {\n      type: '',\n      dataUrl: '',\n      title: '汇脉宝',\n      link: window.host + '/?#/article',\n      desc: '汇脉宝——共享流量，专注营销',\n      imgUrl: `${window.host}/static/full-logo.png`\n    }\n    wx.ready(function () {\n      wx.onMenuShareTimeline(options)\n      wx.onMenuShareAppMessage(options)\n    })\n  },\n  /*\n    options: {\n        timeStamp: 0,                   // 支付签名时间戳，注意微信jssdk中的所有使用timestamp字段均为小写。但最新版的支付后台生成签名使用的timeStamp字段名需大写其中的S字符\n        nonceStr: '',                   // 支付签名随机串，不长于 32 位\n        package: '',                    // 统一支付接口返回的prepay_id参数值，提交格式如：prepay_id=\\*\\*\\*）\n        signType: '',                   // 签名方式，默认为'SHA1'，使用新版支付需传入'MD5'\n        paySign: '',                    // 支付签名\n        success: function(res) {}\n    }\n  */\n  pay: function (options) {\n    wx.chooseWXPay({\n      timestamp: options.timeStamp,\n      nonceStr: options.nonceStr,\n      signType: options.signType,\n      package: options.package,\n      paySign: options.paySign,\n      success: function (res) {\n        options.success(res)\n      },\n      fail: function (res) {\n        dialogService.alert(res)\n      }\n    })\n  }\n}\n\nwx.error(function (res) {\n  console.log(res)\n})\n\nexport default sdkService"]}]}
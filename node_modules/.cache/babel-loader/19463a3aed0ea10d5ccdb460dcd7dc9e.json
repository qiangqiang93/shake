{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/module/spread/index/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/module/spread/index/index.vue","mtime":1547781185297},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime/regenerator\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// import config from \"@/config\";\nimport spread from '../../../api/spread';\nimport { mapState, mapActions } from 'vuex';\nimport { getMarketingCover } from '../../../utils'; // import sdkService from \"@/service/sdkService\";\n\nimport SpreadItem from '../../../components/SpreadItem';\nimport dialogService from '../../../service/dialogService';\nexport default {\n  name: 'spreadIndex',\n  data: function data() {\n    return {\n      pos: null,\n      // 触摸开始的坐标\n      page: null,\n      // 当前页码\n      spreads: [],\n      // 广告列表\n      noMore: false,\n      // 是否显示没有更多\n      allPage: null,\n      // 总页码\n      refresh: true,\n      // 是否刷新\n      shareCount: 5,\n      // 剩余分享次数\n      spreadIndex: 0,\n      // 当前索引\n      showCoin: false,\n      // 是否显示硬币\n      showMenu: false,\n      // 是否显示菜单\n      canOperate: true,\n      // 是否可以操作[在刷新、滑动的时候禁止操作]\n      coinRotate: false,\n      // 硬币旋转效果\n      clientHeight: null // 可视区域高度\n\n    };\n  },\n  mounted: function mounted() {\n    this.init();\n    this.clientHeight = document.documentElement.clientHeight;\n  },\n  methods: _objectSpread({}, mapActions(['spread/updateSpreadAD', 'system/shareGuide']), {\n    init: function () {\n      var _init = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                this.getRewardCount();\n                _context.next = 4;\n                return spread.getSpreadList(1);\n\n              case 4:\n                res = _context.sent;\n\n                if (!(res.status !== 0)) {\n                  _context.next = 7;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 7:\n                this.spreads = this._combine(res); // this.shareConfig()\n\n                if (this.spreads.length) {\n                  this.$set(this.spreads[0], 'browse_num', this.spreads[0].browse_num + 1);\n                  spread.updateVisited(this.spreads[0].id);\n                }\n\n                this.$nextTick(function () {\n                  _this.refresh = false;\n\n                  _this.animationInit();\n                });\n                _context.next = 15;\n                break;\n\n              case 12:\n                _context.prev = 12;\n                _context.t0 = _context[\"catch\"](0);\n                dialogService.alert(_context.t0.message);\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 12]]);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }(),\n    animationInit: function animationInit() {\n      var clientViews = this.$refs.clientView.querySelectorAll('.clientView');\n\n      if (clientViews.length === 3) {\n        clientViews[1].style.cssText = 'z-index: 1';\n        clientViews[0].style.cssText = 'z-index: 2;transform: translate3d(0,-100%,0);';\n        clientViews[2].style.cssText = 'z-index: 2;transform: translate3d(0,100%,0);';\n      } else if (clientViews.length === 2) {\n        if (this.spreadIndex === 0) {\n          clientViews[0].style.cssText = 'z-index: 1';\n          clientViews[1].style.cssText = 'z-index: 2;transform: translate3d(0,100%,0);';\n        } else if (this.spreadIndex === this.spreads.length - 1) {\n          clientViews[1].style.cssText = 'z-index: 1';\n          clientViews[0].style.cssText = 'z-index: 2;transform: translate3d(0,-100%,0);';\n        }\n      }\n    },\n    // 刷新\n    refreshFun: function () {\n      var _refreshFun = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var _this2 = this;\n\n        var res;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return spread.getSpreadList(1);\n\n              case 3:\n                res = _context2.sent;\n\n                if (!(res.status !== 0)) {\n                  _context2.next = 6;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 6:\n                this.spreads = [];\n                setTimeout(function () {\n                  _this2.spreadIndex = 0;\n                  _this2.spreads = _this2._combine(res); //   this.shareConfig()\n\n                  if (_this2.spreads.length) {\n                    _this2.$set(_this2.spreads[0], 'browse_num', _this2.spreads[0].browse_num + 1);\n\n                    spread.updateVisited(_this2.spreads[0].id);\n                  }\n\n                  _this2.$nextTick(function () {\n                    _this2.animationInit();\n\n                    _this2.refresh = false;\n                    _this2.canOperate = true;\n                    _this2.$refs.clientView.style.transform = \"translate3d(0,0,0)\";\n                  });\n                });\n                _context2.next = 15;\n                break;\n\n              case 10:\n                _context2.prev = 10;\n                _context2.t0 = _context2[\"catch\"](0);\n                this.refresh = false;\n                this.canOperate = true;\n                dialogService.alert(_context2.t0.message);\n\n              case 15:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 10]]);\n      }));\n\n      function refreshFun() {\n        return _refreshFun.apply(this, arguments);\n      }\n\n      return refreshFun;\n    }(),\n    // 加载更多\n    loadMore: function () {\n      var _loadMore = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n\n                if (!(this.page === this.allPage)) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\");\n\n              case 3:\n                _context3.next = 5;\n                return spread.getSpreadList(this.page + 1);\n\n              case 5:\n                res = _context3.sent;\n\n                if (!(res.status !== 0)) {\n                  _context3.next = 8;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 8:\n                this.spreads = this.spreads.concat(this._combine(res)); // this.page = res.data.current_page\n\n                _context3.next = 14;\n                break;\n\n              case 11:\n                _context3.prev = 11;\n                _context3.t0 = _context3[\"catch\"](0);\n                dialogService.alert(_context3.t0.message);\n\n              case 14:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 11]]);\n      }));\n\n      function loadMore() {\n        return _loadMore.apply(this, arguments);\n      }\n\n      return loadMore;\n    }(),\n    // toogleMenu\n    toggleMenu: function toggleMenu() {\n      this.showMenu = !this.showMenu;\n    },\n    // 跳转到路径\n    goPath: function goPath(path) {\n      if (path === '/spread/create') {\n        this['spread/updateSpreadAD'](null);\n      }\n\n      this.$router.push({\n        path: path\n      });\n    },\n    // 获取今日奖励次数\n    getRewardCount: function () {\n      var _getRewardCount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return spread.getRewardCount();\n\n              case 3:\n                res = _context4.sent;\n\n                if (!(res.status !== 0)) {\n                  _context4.next = 6;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 6:\n                this.shareCount = 5 - res.data.spread_share_num;\n                _context4.next = 12;\n                break;\n\n              case 9:\n                _context4.prev = 9;\n                _context4.t0 = _context4[\"catch\"](0);\n                dialogService.alert(_context4.t0.message);\n\n              case 12:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 9]]);\n      }));\n\n      function getRewardCount() {\n        return _getRewardCount.apply(this, arguments);\n      }\n\n      return getRewardCount;\n    }(),\n    //     // 分享配置\n    //     shareConfig() {\n    //       // 先判断是否有营销网页\n    //       let _self = this;\n    //       let title, cover, url, link;\n    //       if (!this.spreads.length) return;\n    //       let desc = this.spreads[this.spreadIndex].motto;\n    //       let shareId = this.spreads[this.spreadIndex].id;\n    //       if (this.spreads[this.spreadIndex].user_marketing_id) {\n    //         let marketing = JSON.parse(this.spreads[this.spreadIndex].contents);\n    //         title = marketing.title;\n    //         cover = getMarketingCover(marketing.content);\n    //         url = `/marketing/detail/${\n    //           this.spreads[this.spreadIndex].user_marketing_id\n    //         }`;\n    //       } else {\n    //         url = `/spread/detail/${shareId}`;\n    //         title = this.spreads[this.spreadIndex].title;\n    //         cover = this.spreads[this.spreadIndex].cover;\n    //       }\n    //       sdkService.share({\n    //         desc: desc,\n    //         title: title,\n    //         imgUrl: cover,\n    //         link: `${config.host}/?#/share?target=${encodeURIComponent(url)}`,\n    //         success: async function() {\n    //           // 如果还有奖励次数\n    //           _self.showGuid = false;\n    //           try {\n    //             let res = await spread.shareAD(shareId);\n    //             _self.$set(\n    //               _self.spreads[_self.spreadIndex],\n    //               \"share_num\",\n    //               _self.spreads[_self.spreadIndex].share_num + 1\n    //             );\n    //             if (res.status === -2) {\n    //               dialogService.alert(\"该广告的奖励已经被领完了,分享其他的广告吧\");\n    //             }\n    //             if (res.status !== 0) throw new Error(res.message);\n    //             if (_self.shareCount === 0) return;\n    //             _self.shareCount = _self.shareCount - 1;\n    //             // 显示获得脉宝的动画\n    //             _self.coinanimation();\n    //           } catch (err) {\n    //             // nohting\n    //           }\n    //         }\n    //       });\n    //     },\n    // 开始滑动\n    touchstart: function touchstart(event) {\n      if (!this.canOperate) return;\n      this.showMenu = false;\n      this.canOperate = false;\n      this.pos = {\n        x: event.touches[0].pageX,\n        y: event.touches[0].pageY\n      };\n    },\n    // 结束滑动\n    touchend: function touchend(event) {\n      var _this3 = this;\n\n      if (!this.pos) return;\n      var pos = {\n        x: event.changedTouches[0].pageX,\n        y: event.changedTouches[0].pageY\n      };\n      var distanceX = pos.x - this.pos.x;\n      var distanceY = pos.y - this.pos.y;\n      var horizontal = Math.abs(distanceX) >= Math.abs(distanceY);\n\n      if (horizontal) {\n        this.animationInit();\n        this.canOperate = true;\n        this.$refs.clientView.style.transform = \"translate3d(0,0,0)\";\n        if (Math.abs(distanceX) < 40) return;\n\n        if (distanceX >= 40) {\n          // 向右滑(往左滚动)\n          var index = this.spreads[this.spreadIndex].index || 0;\n          index = index > 0 ? index - 1 : 0;\n          this.$set(this.spreads[this.spreadIndex], 'index', index);\n        } else {\n          // 向左滑(往右滚动)\n          var _index = this.spreads[this.spreadIndex].index || 0;\n\n          var length = JSON.parse(this.spreads[this.spreadIndex].content).length;\n          _index = _index === length - 1 ? _index : _index + 1;\n          this.$set(this.spreads[this.spreadIndex], 'index', _index);\n        }\n      } else {\n        var clientViews = this.$refs.clientView.querySelectorAll('.clientView');\n\n        if (this.spreadIndex !== 0) {\n          clientViews[0].style.transition = 'all 0.4s ease';\n        }\n\n        if (this.spreadIndex !== this.spreads.length - 1) {\n          clientViews[clientViews.length - 1].style.transition = 'all 0.4s ease';\n        } // 高度不超过40 return\n\n\n        if (Math.abs(distanceY) < 40) {\n          this.animationInit();\n          this.canOperate = true;\n          this.$refs.clientView.style.transform = \"translate3d(0,0,0)\";\n          return;\n        }\n\n        if (distanceY >= 40) {\n          // 向下滑(往下滚动) 第一个\n          if (this.spreadIndex === 0) {\n            if (this.refresh) return;\n            this.refresh = true;\n            this.refreshFun();\n          } else {\n            clientViews[0].style.transform = \"translate3d(0,0,0)\";\n            setTimeout(function () {\n              _this3.spreadIndex = _this3.spreadIndex - 1;\n\n              _this3.$nextTick(function () {\n                _this3.animationInit();\n\n                _this3.canOperate = true;\n              });\n            }, 300);\n          }\n        } else {\n          // 向上滑(往上滚动) 最后一个\n          if (this.spreadIndex === this.spreads.length - 1) {\n            this.noMore = true;\n            setTimeout(function () {\n              _this3.noMore = false;\n              _this3.canOperate = true;\n            }, 1500);\n          } else {\n            // 判断还剩下多少个广告,剩下3个时预加载下一页的广告\n            clientViews[clientViews.length - 1].style.transform = \"translate3d(0,0,0)\";\n            setTimeout(function () {\n              _this3.spreadIndex = _this3.spreadIndex + 1;\n\n              _this3.$nextTick(function () {\n                _this3.animationInit();\n\n                _this3.canOperate = true;\n              });\n            }, 300);\n\n            if (this.spreads.length - 1 - this.spreadIndex === 3) {\n              this.loadMore();\n            }\n          }\n        }\n      }\n\n      this.pos = null;\n    },\n    // 开始滑动 => 暂时只判断上下滑动\n    touchmove: function touchmove(event) {\n      if (!this.pos) return;\n      var posY = event.changedTouches[0].pageY;\n      var distance = posY - (this.pos ? this.pos.y : 0);\n      var clientViews = this.$refs.clientView.querySelectorAll('.clientView');\n\n      if (distance > 0) {\n        // 向下滑动 => 下拉刷新\n        if (this.spreadIndex === 0) {\n          distance = distance > 75 ? 75 : distance;\n          this.$refs.clientView.style.transform = \"translate3d(0,\".concat(distance, \"px,0)\");\n        } else {\n          distance = -this.clientHeight + distance;\n          clientViews[0].style.transform = \"translate3d(0,\".concat(distance, \"px,0)\");\n        }\n      } else {\n        // 向上滑动\n        if (this.spreadIndex === this.spreads.length - 1) return;\n        var last = clientViews.length - 1;\n        distance = this.clientHeight + distance;\n        clientViews[last].style.transform = \"translate3d(0,\".concat(distance, \"px,0)\");\n      }\n    },\n    //     // 脉宝的动画\n    //     coinanimation() {\n    //       this.showCoin = true;\n    //       setTimeout(() => {\n    //         this.coinRotate = true;\n    //         setTimeout(() => {\n    //           this.showCoin = false;\n    //           this.coinRotate = false;\n    //         }, 3000);\n    //       });\n    //     },\n    //     // 显示引导\n    // 接口调整后,整合数据\n    _combine: function _combine(res) {\n      var cards = res.data.cards;\n      var spread = res.data.data.data;\n      var marketing = res.data.marketing;\n      var enterprise = res.data.enterprise;\n      spread = spread.map(function (item) {\n        if (item.type === 1 && enterprise[item.user_id]) {\n          // 企业\n          item.motto = enterprise[item.user_id].name;\n          item.head_picture = enterprise[item.user_id].logo;\n        } else if (cards[item.card_id]) {\n          // 个人\n          item.motto = cards[item.card_id].motto;\n          item.head_picture = cards[item.card_id].head_picture;\n        }\n\n        item.user_marketing_title = item.user_marketing_id ? marketing[item.user_marketing_id].title : null;\n        return item;\n      });\n      this.page = res.data.current_page;\n      this.allPage = res.data.last_page;\n      return spread;\n    }\n  }),\n  components: {\n    SpreadItem: SpreadItem\n  },\n  watch: {\n    $route: function () {\n      var _$route = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(to, from) {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (from.path === '/tools') {\n                  this.refresh = true;\n                  this.refreshFun();\n                } else {// await sdkService.config('shareTask')\n                  // this.shareConfig()\n                }\n\n              case 1:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function $route(_x, _x2) {\n        return _$route.apply(this, arguments);\n      }\n\n      return $route;\n    }(),\n    spreadIndex: function spreadIndex(newVal) {\n      try {\n        // this.shareConfig()\n        this.$set(this.spreads[newVal], 'browse_num', this.spreads[newVal].browse_num + 1);\n      } catch (err) {// nothing\n      }\n\n      spread.updateVisited(this.spreads[newVal].id);\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"spread-wrapper\" @touchstart.prevent=\"touchstart($event)\" @touchmove=\"touchmove($event)\" @touchend.prevent=\"touchend($event)\">\n    <div class=\"spread-header\">\n      <p>你今天还有<span v-text=\"shareCount\"></span>次分享奖励</p>\n      <span class=\"more\" @touchstart.stop=\"toggleMenu()\" @touchend.stop=\"\">+</span>\n      <div class=\"spread-menus\" v-show=\"showMenu\">\n        <p @touchstart.stop=\"goPath('/spread/create')\" @touchend.stop=\"\">发布广告</p>\n        <p @touchstart.stop=\"goPath('/spread/shareHistory')\" @touchend.stop=\"\">分享记录</p>\n        <p @touchstart.stop=\"goPath('/spread/manger')\" @touchend.stop=\"\">发布管理</p>\n      </div>\n    </div>\n    <!-- 下拉的时候刷新 -->\n    <div class=\"refresh\">\n      <template v-if=\"refresh\">\n        <img class=\"img\" src=\"./loading.gif\" alt=\"\">\n        <span class=\"span\">正在刷新...</span>\n      </template>\n      <template v-else>\n        <span v-if=\"spreads.length\">释放刷新</span>\n        <span v-else>暂时没有发布记录</span>\n      </template>\n    </div>\n    <!-- 主滑动区域 -->\n    <div class=\"slider-container\" ref=\"clientView\" :class=\"{'refresh': refresh}\">\n      <template v-for=\"(item, index) in spreads\">\n        <div class=\"clientView\" :key=\"index\" :ref=\"'clientView_' + index\" v-if=\"(index >= spreadIndex - 1) && (index <= spreadIndex + 1)\">\n          <SpreadItem :input=\"item\" :index=\"item.index || 0\"></SpreadItem>\n        </div>\n      </template>\n    </div>\n    <!-- 没有更多 -->\n    <div class=\"no-more\" :class=\"{'show': noMore}\">\n      没有更多了!\n    </div>\n    <!-- 分享成功之后的硬币 -->\n    <div v-show=\"showCoin\" class=\"coin-box\" :class=\"{'rotate': coinRotate}\">\n      <div class=\"coin-front\">\n        <img src=\"./front.png\" alt=\"\">\n      </div>\n      <div class=\"coin-back\">\n        <span v-text=\"'+' + (spreads[spreadIndex] ? spreads[spreadIndex].maibao_spend_num : '')\"></span>\n        <img src=\"./back.png\" alt=\"\">\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n// import config from \"@/config\";\nimport spread from '../../../api/spread'\nimport { mapState, mapActions } from 'vuex'\nimport { getMarketingCover } from '../../../utils'\n// import sdkService from \"@/service/sdkService\";\nimport SpreadItem from '../../../components/SpreadItem'\nimport dialogService from '../../../service/dialogService'\nexport default {\n  name: 'spreadIndex',\n  data() {\n    return {\n      pos: null, // 触摸开始的坐标\n      page: null, // 当前页码\n      spreads: [], // 广告列表\n      noMore: false, // 是否显示没有更多\n      allPage: null, // 总页码\n      refresh: true, // 是否刷新\n      shareCount: 5, // 剩余分享次数\n      spreadIndex: 0, // 当前索引\n      showCoin: false, // 是否显示硬币\n      showMenu: false, // 是否显示菜单\n      canOperate: true, // 是否可以操作[在刷新、滑动的时候禁止操作]\n      coinRotate: false, // 硬币旋转效果\n      clientHeight: null // 可视区域高度\n    }\n  },\n  mounted() {\n    this.init()\n    this.clientHeight = document.documentElement.clientHeight\n  },\n  methods: {\n    ...mapActions(['spread/updateSpreadAD', 'system/shareGuide']),\n    async init() {\n      try {\n        this.getRewardCount()\n        let res = await spread.getSpreadList(1)\n        if (res.status !== 0) throw new Error(res.message)\n        this.spreads = this._combine(res)\n        // this.shareConfig()\n        if (this.spreads.length) {\n          this.$set(\n            this.spreads[0],\n            'browse_num',\n            this.spreads[0].browse_num + 1\n          )\n          spread.updateVisited(this.spreads[0].id)\n        }\n        this.$nextTick(() => {\n          this.refresh = false\n          this.animationInit()\n        })\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    animationInit() {\n      let clientViews = this.$refs.clientView.querySelectorAll('.clientView')\n      if (clientViews.length === 3) {\n        clientViews[1].style.cssText = 'z-index: 1'\n        clientViews[0].style.cssText =\n          'z-index: 2;transform: translate3d(0,-100%,0);'\n        clientViews[2].style.cssText =\n          'z-index: 2;transform: translate3d(0,100%,0);'\n      } else if (clientViews.length === 2) {\n        if (this.spreadIndex === 0) {\n          clientViews[0].style.cssText = 'z-index: 1'\n          clientViews[1].style.cssText =\n            'z-index: 2;transform: translate3d(0,100%,0);'\n        } else if (this.spreadIndex === this.spreads.length - 1) {\n          clientViews[1].style.cssText = 'z-index: 1'\n          clientViews[0].style.cssText =\n            'z-index: 2;transform: translate3d(0,-100%,0);'\n        }\n      }\n    },\n    // 刷新\n    async refreshFun() {\n      try {\n        let res = await spread.getSpreadList(1)\n        if (res.status !== 0) throw new Error(res.message)\n        this.spreads = []\n        setTimeout(() => {\n          this.spreadIndex = 0\n          this.spreads = this._combine(res)\n          //   this.shareConfig()\n          if (this.spreads.length) {\n            this.$set(\n              this.spreads[0],\n              'browse_num',\n              this.spreads[0].browse_num + 1\n            )\n            spread.updateVisited(this.spreads[0].id)\n          }\n          this.$nextTick(() => {\n            this.animationInit()\n            this.refresh = false\n            this.canOperate = true\n            this.$refs.clientView.style.transform = `translate3d(0,0,0)`\n          })\n        })\n      } catch (err) {\n        this.refresh = false\n        this.canOperate = true\n        dialogService.alert(err.message)\n      }\n    },\n    // 加载更多\n    async loadMore() {\n      try {\n        if (this.page === this.allPage) return\n        let res = await spread.getSpreadList(this.page + 1)\n        if (res.status !== 0) throw new Error(res.message)\n        this.spreads = this.spreads.concat(this._combine(res))\n        // this.page = res.data.current_page\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // toogleMenu\n    toggleMenu() {\n      this.showMenu = !this.showMenu\n    },\n    // 跳转到路径\n    goPath(path) {\n      if (path === '/spread/create') {\n        this['spread/updateSpreadAD'](null)\n      }\n      this.$router.push({ path: path })\n    },\n    // 获取今日奖励次数\n    async getRewardCount() {\n      try {\n        let res = await spread.getRewardCount()\n        if (res.status !== 0) throw new Error(res.message)\n        this.shareCount = 5 - res.data.spread_share_num\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    //     // 分享配置\n    //     shareConfig() {\n    //       // 先判断是否有营销网页\n    //       let _self = this;\n    //       let title, cover, url, link;\n    //       if (!this.spreads.length) return;\n    //       let desc = this.spreads[this.spreadIndex].motto;\n    //       let shareId = this.spreads[this.spreadIndex].id;\n    //       if (this.spreads[this.spreadIndex].user_marketing_id) {\n    //         let marketing = JSON.parse(this.spreads[this.spreadIndex].contents);\n    //         title = marketing.title;\n    //         cover = getMarketingCover(marketing.content);\n    //         url = `/marketing/detail/${\n    //           this.spreads[this.spreadIndex].user_marketing_id\n    //         }`;\n    //       } else {\n    //         url = `/spread/detail/${shareId}`;\n    //         title = this.spreads[this.spreadIndex].title;\n    //         cover = this.spreads[this.spreadIndex].cover;\n    //       }\n    //       sdkService.share({\n    //         desc: desc,\n    //         title: title,\n    //         imgUrl: cover,\n    //         link: `${config.host}/?#/share?target=${encodeURIComponent(url)}`,\n    //         success: async function() {\n    //           // 如果还有奖励次数\n    //           _self.showGuid = false;\n    //           try {\n    //             let res = await spread.shareAD(shareId);\n    //             _self.$set(\n    //               _self.spreads[_self.spreadIndex],\n    //               \"share_num\",\n    //               _self.spreads[_self.spreadIndex].share_num + 1\n    //             );\n    //             if (res.status === -2) {\n    //               dialogService.alert(\"该广告的奖励已经被领完了,分享其他的广告吧\");\n    //             }\n    //             if (res.status !== 0) throw new Error(res.message);\n    //             if (_self.shareCount === 0) return;\n    //             _self.shareCount = _self.shareCount - 1;\n    //             // 显示获得脉宝的动画\n    //             _self.coinanimation();\n    //           } catch (err) {\n    //             // nohting\n    //           }\n    //         }\n    //       });\n    //     },\n    // 开始滑动\n    touchstart(event) {\n      if (!this.canOperate) return\n      this.showMenu = false\n      this.canOperate = false\n      this.pos = {\n        x: event.touches[0].pageX,\n        y: event.touches[0].pageY\n      }\n    },\n    // 结束滑动\n    touchend(event) {\n      if (!this.pos) return\n      let pos = {\n        x: event.changedTouches[0].pageX,\n        y: event.changedTouches[0].pageY\n      }\n      let distanceX = pos.x - this.pos.x\n      let distanceY = pos.y - this.pos.y\n      let horizontal = Math.abs(distanceX) >= Math.abs(distanceY)\n      if (horizontal) {\n        this.animationInit()\n        this.canOperate = true\n        this.$refs.clientView.style.transform = `translate3d(0,0,0)`\n        if (Math.abs(distanceX) < 40) return\n        if (distanceX >= 40) {\n          // 向右滑(往左滚动)\n          let index = this.spreads[this.spreadIndex].index || 0\n          index = index > 0 ? index - 1 : 0\n          this.$set(this.spreads[this.spreadIndex], 'index', index)\n        } else {\n          // 向左滑(往右滚动)\n          let index = this.spreads[this.spreadIndex].index || 0\n          let length = JSON.parse(this.spreads[this.spreadIndex].content).length\n          index = index === length - 1 ? index : index + 1\n          this.$set(this.spreads[this.spreadIndex], 'index', index)\n        }\n      } else {\n        let clientViews = this.$refs.clientView.querySelectorAll('.clientView')\n        if (this.spreadIndex !== 0) {\n          clientViews[0].style.transition = 'all 0.4s ease'\n        }\n        if (this.spreadIndex !== this.spreads.length - 1) {\n          clientViews[clientViews.length - 1].style.transition = 'all 0.4s ease'\n        }\n        // 高度不超过40 return\n        if (Math.abs(distanceY) < 40) {\n          this.animationInit()\n          this.canOperate = true\n          this.$refs.clientView.style.transform = `translate3d(0,0,0)`\n          return\n        }\n        if (distanceY >= 40) {\n          // 向下滑(往下滚动) 第一个\n          if (this.spreadIndex === 0) {\n            if (this.refresh) return\n            this.refresh = true\n            this.refreshFun()\n          } else {\n            clientViews[0].style.transform = `translate3d(0,0,0)`\n            setTimeout(() => {\n              this.spreadIndex = this.spreadIndex - 1\n              this.$nextTick(() => {\n                this.animationInit()\n                this.canOperate = true\n              })\n            }, 300)\n          }\n        } else {\n          // 向上滑(往上滚动) 最后一个\n          if (this.spreadIndex === this.spreads.length - 1) {\n            this.noMore = true\n            setTimeout(() => {\n              this.noMore = false\n              this.canOperate = true\n            }, 1500)\n          } else {\n            // 判断还剩下多少个广告,剩下3个时预加载下一页的广告\n            clientViews[\n              clientViews.length - 1\n            ].style.transform = `translate3d(0,0,0)`\n            setTimeout(() => {\n              this.spreadIndex = this.spreadIndex + 1\n              this.$nextTick(() => {\n                this.animationInit()\n                this.canOperate = true\n              })\n            }, 300)\n            if (this.spreads.length - 1 - this.spreadIndex === 3) {\n              this.loadMore()\n            }\n          }\n        }\n      }\n      this.pos = null\n    },\n    // 开始滑动 => 暂时只判断上下滑动\n    touchmove(event) {\n      if (!this.pos) return\n      let posY = event.changedTouches[0].pageY\n      let distance = posY - (this.pos ? this.pos.y : 0)\n      let clientViews = this.$refs.clientView.querySelectorAll('.clientView')\n      if (distance > 0) {\n        // 向下滑动 => 下拉刷新\n        if (this.spreadIndex === 0) {\n          distance = distance > 75 ? 75 : distance\n          this.$refs.clientView.style.transform = `translate3d(0,${distance}px,0)`\n        } else {\n          distance = -this.clientHeight + distance\n          clientViews[0].style.transform = `translate3d(0,${distance}px,0)`\n        }\n      } else {\n        // 向上滑动\n        if (this.spreadIndex === this.spreads.length - 1) return\n        let last = clientViews.length - 1\n        distance = this.clientHeight + distance\n        clientViews[last].style.transform = `translate3d(0,${distance}px,0)`\n      }\n    },\n    //     // 脉宝的动画\n    //     coinanimation() {\n    //       this.showCoin = true;\n    //       setTimeout(() => {\n    //         this.coinRotate = true;\n    //         setTimeout(() => {\n    //           this.showCoin = false;\n    //           this.coinRotate = false;\n    //         }, 3000);\n    //       });\n    //     },\n    //     // 显示引导\n\n    // 接口调整后,整合数据\n    _combine(res) {\n      let cards = res.data.cards\n      let spread = res.data.data.data\n      let marketing = res.data.marketing\n      let enterprise = res.data.enterprise\n      spread = spread.map(item => {\n        if (item.type === 1 && enterprise[item.user_id]) {\n          // 企业\n          item.motto = enterprise[item.user_id].name\n          item.head_picture = enterprise[item.user_id].logo\n        } else if (cards[item.card_id]) {\n          // 个人\n          item.motto = cards[item.card_id].motto\n          item.head_picture = cards[item.card_id].head_picture\n        }\n        item.user_marketing_title = item.user_marketing_id\n          ? marketing[item.user_marketing_id].title\n          : null\n        return item\n      })\n\n      this.page = res.data.current_page\n      this.allPage = res.data.last_page\n      return spread\n    }\n  },\n  components: {\n    SpreadItem\n  },\n  watch: {\n    async $route(to, from) {\n      if (from.path === '/tools') {\n        this.refresh = true\n        this.refreshFun()\n      } else {\n        // await sdkService.config('shareTask')\n        // this.shareConfig()\n      }\n    },\n    spreadIndex: function(newVal) {\n      try {\n        // this.shareConfig()\n        this.$set(\n          this.spreads[newVal],\n          'browse_num',\n          this.spreads[newVal].browse_num + 1\n        )\n      } catch (err) {\n        // nothing\n      }\n      spread.updateVisited(this.spreads[newVal].id)\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.spread-wrapper {\n  width: 100%;\n  height: 100vh;\n  overflow: hidden;\n  position: relative;\n  background: #f2f2f2;\n}\n.spread-header {\n  width: 100%;\n  z-index: 2;\n  height: 80px;\n  color: #fff;\n  position: fixed;\n  font-size: 24px;\n  line-height: 80px;\n  text-align: center;\n  font-family: 'PingFang SC Medium';\n  background: linear-gradient(rgba(27, 27, 27, 0.3), rgba(0, 0, 0, 0));\n  .more {\n    top: 0;\n    right: 0;\n    font-size: 72px;\n    font-weight: 300;\n    font-weight: 100;\n    line-height: 80px;\n    position: absolute;\n    padding-right: 10px;\n  }\n  .spread-menus {\n    top: 54px;\n    right: 20px;\n    width: 203px;\n    height: 212px;\n    overflow: hidden;\n    position: absolute;\n    box-sizing: border-box;\n    background-size: cover;\n    padding: 32px 20px 16px;\n    background-image: url(./menu.png);\n    p {\n      line-height: 60px;\n    }\n  }\n}\n.refresh {\n  left: 0;\n  top: 80px;\n  width: 100%;\n  display: flex;\n  font-size: 28px;\n  position: absolute;\n  align-items: center;\n  flex-direction: column;\n  justify-content: center;\n  .img {\n    width: 40px;\n    margin-top: 20px;\n  }\n  .span {\n    margin: 20px;\n  }\n}\n\n.slider-container {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: relative;\n  transition: all 0.3s ease;\n  &.refresh {\n    transform: translate3d(0, 150px, 0);\n  }\n}\n.clientView {\n  top: 0;\n  left: 0;\n  z-index: 1;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n}\n.coin-box {\n  top: 50%;\n  left: 50%;\n  z-index: 3;\n  width: 120px;\n  height: 120px;\n  position: absolute;\n  margin-top: -60px;\n  margin-left: -60px;\n  backface-visibility: hidden;\n  transform-style: preserve-3d;\n  transition: all 2s cubic-bezier(0, 0, 0.2, 0.8);\n  &.rotate {\n    transform: rotateY(900deg);\n  }\n  .coin-front,\n  .coin-back {\n    top: 0;\n    left: 0;\n    width: 120px;\n    height: 120px;\n    position: absolute;\n    backface-visibility: hidden;\n    img {\n      width: 100%;\n    }\n  }\n  .coin-back {\n    transform: rotateY(180deg);\n    span {\n      width: 120px;\n      font-size: 24px;\n      color: #fef4d3;\n      position: absolute;\n      text-align: center;\n      line-height: 120px;\n      font-family: 'PingFang SC Bold';\n    }\n  }\n}\n.no-more {\n  bottom: 0;\n  opacity: 0;\n  z-index: 99;\n  width: 200px;\n  height: 70px;\n  left: 275px;\n  color: #fff;\n  font-size: 30px;\n  position: absolute;\n  text-align: center;\n  line-height: 70px;\n  text-align: center;\n  border-radius: 35px;\n  transition: all 0.3s ease;\n  background: rgba(0, 0, 0, 0.5);\n  &.show {\n    opacity: 1;\n    bottom: 60px;\n  }\n}\n</style>\n"],"sourceRoot":"src/module/spread/index"}]}
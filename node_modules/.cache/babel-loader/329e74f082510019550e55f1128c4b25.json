{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/components/CircleBall/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/components/CircleBall/index.vue","mtime":1546844922780},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _parseInt from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime-corejs2/core-js/parse-int\";\nimport _classCallCheck from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar BallItem =\n/*#__PURE__*/\nfunction () {\n  function BallItem(x, y, z, ele) {\n    _classCallCheck(this, BallItem);\n\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    this.ele = ele;\n    this.radius = this.ele.offsetWidth / 2;\n  } // 圆心和半径\n\n\n  _createClass(BallItem, [{\n    key: \"move\",\n    value: function move(x, y, r) {\n      var scale = r / (r - this.z / 2);\n      var alpha = (this.z + r) / (2 * r);\n      var top = this.y + y - this.radius + 'px';\n      var left = this.x + x - this.radius + 'px';\n      var transform = \"translate3d(\".concat(left, \", \").concat(top, \", 0) scale(\").concat(scale, \")\");\n      this.ele.style.opacity = alpha + 0.5;\n      this.ele.style.transform = transform;\n      this.ele.style.webkitTransform = transform;\n      this.ele.style.zIndex = _parseInt(scale * 100);\n    }\n  }]);\n\n  return BallItem;\n}();\n\nexport default {\n  props: ['data'],\n  data: function data() {\n    return {\n      radius: null,\n      // 半径\n      center: null,\n      // 圆心\n      children: [],\n      // 小球\n      offset: null,\n      // 坐标偏移量\n      animate: null,\n      // 动画计时器\n      angleY: Math.PI / 2000,\n      angleX: Math.PI / 2000\n    };\n  },\n  mounted: function mounted() {\n    var radius = this.$refs.ballWrapper.offsetWidth / 2;\n    this.radius = radius - 40;\n    this.offset = {\n      y: this.$refs.ballWrapper.offsetTop,\n      x: this.$refs.ballWrapper.offsetLeft\n    };\n    this.center = {\n      x: radius,\n      y: radius\n    };\n  },\n  methods: {\n    // init 绘制初始坐标\n    init: function init() {\n      var _this = this;\n\n      this.stopAnimation();\n      var children = document.querySelectorAll('.ball-item');\n      children.forEach(function (item, index) {\n        var a = Math.acos((2 * index + 1) / children.length - 1);\n        var b = a * Math.sqrt(children.length * Math.PI);\n        var x = _this.radius * Math.sin(a) * Math.cos(b);\n        var y = _this.radius * Math.sin(a) * Math.sin(b);\n        var z = _this.radius * Math.cos(a);\n        var it = new BallItem(x, y, z, item);\n\n        _this.children.push(it);\n      });\n      this.startAnimation();\n    },\n    rotateX: function rotateX() {\n      var cos = Math.cos(this.angleX);\n      var sin = Math.sin(this.angleX);\n      this.children.forEach(function (item) {\n        var y = item.y * cos - item.z * sin;\n        var z = item.z * cos + item.y * sin;\n        item.y = y;\n        item.z = z;\n      });\n    },\n    rotateY: function rotateY() {\n      var cos = Math.cos(this.angleY);\n      var sin = Math.sin(this.angleY);\n      this.children.forEach(function (item, index) {\n        var x = item.x * cos - item.z * sin;\n        var z = item.z * cos + item.x * sin;\n        item.x = x;\n        item.z = z;\n      });\n    },\n    // animation\n    animation: function animation() {\n      var _this2 = this;\n\n      this.rotateX();\n      this.rotateY();\n      this.children.forEach(function (item) {\n        item.move(_this2.center.x, _this2.center.y, _this2.radius);\n      });\n    },\n    // startAnimation\n    startAnimation: function startAnimation() {\n      var _this3 = this;\n\n      this.animate = setInterval(function () {\n        _this3.animation();\n      }, 20);\n    },\n    // stopAnimation\n    stopAnimation: function stopAnimation() {\n      clearInterval(this.animate);\n      this.animate = null;\n    },\n    // touchstart\n    touchstart: function touchstart() {\n      this.stopAnimation();\n    },\n    // touchmove\n    touchmove: function touchmove(event) {\n      var x = event.touches[0].clientX - this.center.x;\n      var y = event.touches[0].clientY - this.center.y;\n      this.angleY = x * -0.0001;\n      this.angleX = y * -0.0001;\n      this.animation();\n    },\n    // touchend\n    touchend: function touchend() {\n      var x = event.changedTouches[0].clientX - this.center.x;\n      var y = event.changedTouches[0].clientY - this.center.y;\n      this.angleY = x * -0.0001;\n      this.angleX = y * -0.0001;\n      this.startAnimation();\n    },\n    // 点击ball-item\n    childTouch: function childTouch(item) {\n      this.$router.push(\"/circle/match/\".concat(item.id));\n    }\n  },\n  computed: {},\n  components: {\n    BallItem: BallItem\n  },\n  watch: {\n    data: function data(newVal) {\n      var _this4 = this;\n\n      this.$nextTick(function () {\n        _this4.init();\n      });\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<!--\n\n\n-->\n<template>\n  <div ref=\"ballWrapper\" class=\"circle-ball\" @touchstart.stop.prevent=\"touchstart()\" @touchmove.stop.prevent=\"touchmove($event)\" @touchend.stop.prevent=\"touchend($event)\">\n    <div class=\"ball-item\" v-for=\"(item,index) in data\" :key=\"index\" :item=\"item\" @touchstart=\"childTouch(item)\">\n      <img v-if=\"item.head_picture\" :src=\"item.head_picture\" alt=\"\" class=\"ball-item-head\">\n      <img v-else src=\"/static/img/default-header.png\" alt=\"\" class=\"ball-item-head\">\n    </div>\n  </div>\n</template>\n\n<script>\nclass BallItem {\n  constructor(x, y, z, ele) {\n    this.x = x\n    this.y = y\n    this.z = z\n    this.ele = ele\n    this.radius = this.ele.offsetWidth / 2\n  }\n  // 圆心和半径\n  move(x, y, r) {\n    let scale = r / (r - this.z / 2)\n    let alpha = (this.z + r) / (2 * r)\n    let top = this.y + y - this.radius + 'px'\n    let left = this.x + x - this.radius + 'px'\n    let transform = `translate3d(${left}, ${top}, 0) scale(${scale})`\n    this.ele.style.opacity = alpha + 0.5\n    this.ele.style.transform = transform\n    this.ele.style.webkitTransform = transform\n    this.ele.style.zIndex = parseInt(scale * 100)\n  }\n}\n\nexport default {\n  props: ['data'],\n  data() {\n    return {\n      radius: null, // 半径\n      center: null, // 圆心\n      children: [], // 小球\n      offset: null, // 坐标偏移量\n      animate: null, // 动画计时器\n      angleY: Math.PI / 2000,\n      angleX: Math.PI / 2000\n    }\n  },\n  mounted() {\n    let radius = this.$refs.ballWrapper.offsetWidth / 2\n    this.radius = radius - 40\n    this.offset = {\n      y: this.$refs.ballWrapper.offsetTop,\n      x: this.$refs.ballWrapper.offsetLeft\n    }\n    this.center = { x: radius, y: radius }\n  },\n  methods: {\n    // init 绘制初始坐标\n    init() {\n      this.stopAnimation()\n      let children = document.querySelectorAll('.ball-item')\n      children.forEach((item, index) => {\n        let a = Math.acos((2 * index + 1) / children.length - 1)\n        let b = a * Math.sqrt(children.length * Math.PI)\n        let x = this.radius * Math.sin(a) * Math.cos(b)\n        let y = this.radius * Math.sin(a) * Math.sin(b)\n        let z = this.radius * Math.cos(a)\n        let it = new BallItem(x, y, z, item)\n        this.children.push(it)\n      })\n      this.startAnimation()\n    },\n    rotateX() {\n      let cos = Math.cos(this.angleX)\n      let sin = Math.sin(this.angleX)\n      this.children.forEach(item => {\n        let y = item.y * cos - item.z * sin\n        let z = item.z * cos + item.y * sin\n        item.y = y\n        item.z = z\n      })\n    },\n    rotateY() {\n      let cos = Math.cos(this.angleY)\n      let sin = Math.sin(this.angleY)\n      this.children.forEach((item, index) => {\n        let x = item.x * cos - item.z * sin\n        let z = item.z * cos + item.x * sin\n        item.x = x\n        item.z = z\n      })\n    },\n    // animation\n    animation() {\n      this.rotateX()\n      this.rotateY()\n      this.children.forEach(item => {\n        item.move(this.center.x, this.center.y, this.radius)\n      })\n    },\n    // startAnimation\n    startAnimation() {\n      this.animate = setInterval(() => {\n        this.animation()\n      }, 20)\n    },\n    // stopAnimation\n    stopAnimation() {\n      clearInterval(this.animate)\n      this.animate = null\n    },\n    // touchstart\n    touchstart() {\n      this.stopAnimation()\n    },\n    // touchmove\n    touchmove(event) {\n      let x = event.touches[0].clientX - this.center.x\n      let y = event.touches[0].clientY - this.center.y\n      this.angleY = x * -0.0001\n      this.angleX = y * -0.0001\n      this.animation()\n    },\n    // touchend\n    touchend() {\n      let x = event.changedTouches[0].clientX - this.center.x\n      let y = event.changedTouches[0].clientY - this.center.y\n      this.angleY = x * -0.0001\n      this.angleX = y * -0.0001\n      this.startAnimation()\n    },\n    // 点击ball-item\n    childTouch(item) {\n      this.$router.push(`/circle/match/${item.id}`)\n    }\n  },\n  computed: {},\n  components: {\n    BallItem\n  },\n  watch: {\n    data(newVal) {\n      this.$nextTick(() => {\n        this.init()\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.circle-ball {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.ball-item {\n  top: 0;\n  left: 0;\n  opacity: 0;\n  width: 40px;\n  height: 40px;\n  overflow: hidden;\n  position: absolute;\n  border-radius: 20px;\n  box-sizing: border-box;\n  border: 2px solid #8aa1ff;\n}\n.ball-item-head {\n  width: 100%;\n  height: 100%;\n}\n</style>\n"],"sourceRoot":"src/components/CircleBall"}]}
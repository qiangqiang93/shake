{"remainingRequest":"/Users/qiang/work/hytx/circle/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/circle/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/qiang/work/hytx/circle/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/circle/src/components/ArticleHeader/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/circle/src/components/ArticleHeader/index.vue","mtime":1548313186311},{"path":"/Users/qiang/work/hytx/circle/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/circle/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/circle/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/circle/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"/Users/qiang/work/hytx/circle/node_modules/@babel/runtime/regenerator\";\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState } from 'vuex';\nimport Article from '../../api/article/index';\nimport guideService from '../../service/guideService';\nimport dialogService from '../../service/dialogService';\nexport default {\n  props: ['input', 'isAuthor'],\n  methods: {\n    // 关注/取消关注\n    toggleFollow: function () {\n      var _toggleFollow = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var followType, res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!this.user) {\n                  _context.next = 16;\n                  break;\n                }\n\n                _context.prev = 1;\n                followType = this.input.is_follow ? 'unfollow' : 'follow';\n                _context.next = 5;\n                return Article[followType](this.input.id);\n\n              case 5:\n                res = _context.sent;\n\n                if (!(res.status !== 0)) {\n                  _context.next = 8;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 8:\n                this.input.is_follow = !this.input.is_follow;\n                _context.next = 14;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context[\"catch\"](1);\n                dialogService.alert(_context.t0.message);\n\n              case 14:\n                _context.next = 17;\n                break;\n\n              case 16:\n                guideService.login();\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 11]]);\n      }));\n\n      function toggleFollow() {\n        return _toggleFollow.apply(this, arguments);\n      }\n\n      return toggleFollow;\n    }(),\n    // 跳转到个人微网\n    goWebPage: function goWebPage() {\n      var _self = this;\n\n      var userId = this.user ? this.user.id : null;\n\n      if (this.input.id === userId) {\n        if (this.input.has_usertemp) {\n          this.$router.push(\"/webPage/detail/\".concat(this.input.has_usertemp.id));\n        } else {\n          dialogService.confirm('你还没有完善个人微网,是否前往完善', function (state) {\n            if (state) self.$router.push(\"/webPage/edit\");\n          });\n        }\n      } else {\n        if (this.input.has_page) {\n          this.$router.push(\"/webPage/detail/\".concat(this.input.has_page));\n        } else {\n          dialogService.alert('Ta还没有完善个人微网，暂时不能查看');\n        }\n      }\n    }\n  },\n  computed: _objectSpread({}, mapState({\n    user: function user(state) {\n      return state.user.userInfo;\n    }\n  }))\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0CA,SAAA,QAAA,QAAA,MAAA;AAEA,OAAA,OAAA,MAAA,yBAAA;AAEA,OAAA,YAAA,MAAA,4BAAA;AACA,OAAA,aAAA,MAAA,6BAAA;AAEA,eAAA;AACA,EAAA,KAAA,EAAA,CAAA,OAAA,EAAA,UAAA,CADA;AAEA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,YAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAGA,KAAA,IAHA;AAAA;AAAA;AAAA;;AAAA;AAKA,gBAAA,UALA,GAKA,KAAA,KAAA,CAAA,SAAA,GAAA,UAAA,GAAA,QALA;AAAA;AAAA,uBAMA,OAAA,CAAA,UAAA,CAAA,CAAA,KAAA,KAAA,CAAA,EAAA,CANA;;AAAA;AAMA,gBAAA,GANA;;AAAA,sBAOA,GAAA,CAAA,MAAA,KAAA,CAPA;AAAA;AAAA;AAAA;;AAAA,sBAOA,IAAA,KAAA,CAAA,GAAA,CAAA,OAAA,CAPA;;AAAA;AAQA,qBAAA,KAAA,CAAA,SAAA,GAAA,CAAA,KAAA,KAAA,CAAA,SAAA;AARA;AAAA;;AAAA;AAAA;AAAA;AAUA,gBAAA,aAAA,CAAA,KAAA,CAAA,YAAA,OAAA;;AAVA;AAAA;AAAA;;AAAA;AAaA,gBAAA,YAAA,CAAA,KAAA;;AAbA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAgBA;AACA,IAAA,SAjBA,uBAiBA;AACA,UAAA,KAAA,GAAA,IAAA;;AACA,UAAA,MAAA,GAAA,KAAA,IAAA,GAAA,KAAA,IAAA,CAAA,EAAA,GAAA,IAAA;;AACA,UAAA,KAAA,KAAA,CAAA,EAAA,KAAA,MAAA,EAAA;AACA,YAAA,KAAA,KAAA,CAAA,YAAA,EAAA;AACA,eAAA,OAAA,CAAA,IAAA,2BAAA,KAAA,KAAA,CAAA,YAAA,CAAA,EAAA;AACA,SAFA,MAEA;AACA,UAAA,aAAA,CAAA,OAAA,CAAA,mBAAA,EAAA,UAAA,KAAA,EAAA;AACA,gBAAA,KAAA,EAAA,IAAA,CAAA,OAAA,CAAA,IAAA;AACA,WAFA;AAGA;AACA,OARA,MAQA;AACA,YAAA,KAAA,KAAA,CAAA,QAAA,EAAA;AACA,eAAA,OAAA,CAAA,IAAA,2BAAA,KAAA,KAAA,CAAA,QAAA;AACA,SAFA,MAEA;AACA,UAAA,aAAA,CAAA,KAAA,CAAA,oBAAA;AACA;AACA;AACA;AAnCA,GAFA;AAuCA,EAAA,QAAA,oBACA,QAAA,CAAA;AACA,IAAA,IAAA,EAAA,cAAA,KAAA;AAAA,aAAA,KAAA,CAAA,IAAA,CAAA,QAAA;AAAA;AADA,GAAA,CADA;AAvCA,CAAA","sourcesContent":["<!-- \n    @name           ArticleHeader\n    @desc           文章详情头部\n    @props \n        input       <object>    作者或分享人信息\n        isAuthor    <boolean>   是否为作者\n -->\n\n<template>\n  <div class=\"article-header-wrapper\" :class=\"{'has-border': !isAuthor}\">\n    <div class=\"article-header-left\" v-if=\"input\">\n      <div class=\"article-header-head\">\n        <img :src=\"input.avatar||input.portrait||'/static/logo.png'\" alt=\"\" class=\"article-header-head-img\">\n      </div>\n      <div class=\"article-header-info\">\n        <template v-if=\"isAuthor\">\n          <span class=\"article-header-name\" v-text=\"input.name\"></span>\n          <span class=\"article-header-desc\" v-text=\"input.created_at?input.created_at.substring(0,10):''\"></span>\n        </template>\n        <template v-else>\n          <span class=\"article-header-name\" v-text=\"input.name\"></span>\n          <span class=\"article-header-desc\" v-text=\"input.motto||'流量  资源  财富'\"></span>\n        </template>\n      </div>\n    </div>\n    <div class=\"article-header-right\">\n      <template v-if=\"isAuthor\">\n        <div class=\"article-header-btn\" v-if=\"input.id !== '0'\" :class=\"{'follow': input.is_follow}\" @click=\"toggleFollow()\">\n          <span v-text=\"input.is_follow ? '已关注' : '关注'\"></span>\n        </div>\n      </template>\n      <template v-else>\n        <div class=\"article-header-btn\" @click=\"goWebPage()\">\n          <span>点击进入</span>\n        </div>\n      </template>\n    </div>\n  </div>\n</template>\n\n\n<script>\nimport { mapState } from 'vuex'\n\nimport Article from '../../api/article/index'\n\nimport guideService from '../../service/guideService'\nimport dialogService from '../../service/dialogService'\n\nexport default {\n  props: ['input', 'isAuthor'],\n  methods: {\n    // 关注/取消关注\n    async toggleFollow() {\n      if (this.user) {\n        try {\n          let followType = this.input.is_follow ? 'unfollow' : 'follow'\n          let res = await Article[followType](this.input.id)\n          if (res.status !== 0) throw new Error(res.message)\n          this.input.is_follow = !this.input.is_follow\n        } catch (err) {\n          dialogService.alert(err.message)\n        }\n      } else {\n        guideService.login()\n      }\n    },\n    // 跳转到个人微网\n    goWebPage() {\n      let _self = this\n      let userId = this.user ? this.user.id : null\n      if (this.input.id === userId) {\n        if (this.input.has_usertemp) {\n          this.$router.push(`/webPage/detail/${this.input.has_usertemp.id}`)\n        } else {\n          dialogService.confirm('你还没有完善个人微网,是否前往完善', state => {\n            if (state) self.$router.push(`/webPage/edit`)\n          })\n        }\n      } else {\n        if (this.input.has_page) {\n          this.$router.push(`/webPage/detail/${this.input.has_page}`)\n        } else {\n          dialogService.alert('Ta还没有完善个人微网，暂时不能查看')\n        }\n      }\n    }\n  },\n  computed: {\n    ...mapState({\n      user: state => state.user.userInfo\n    })\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.article-header-wrapper {\n  width: 100%;\n  z-index: 10;\n  display: flex;\n  padding: 20px 40px;\n  background: #ffffff;\n  box-sizing: border-box;\n  &.has-border {\n    box-shadow: 0 2px 16px rgba(0, 0, 0, 0.06);\n  }\n}\n.article-header-left {\n  flex: 1;\n  display: flex;\n  .article-header-head {\n    width: 64px;\n    height: 64px;\n  }\n  .article-header-head-img {\n    width: 64px;\n    height: 64px;\n    border-radius: 50%;\n  }\n  .article-header-info {\n    width: 432px;\n    color: #222;\n    font-size: 26px;\n    overflow: hidden;\n    line-height: 23px;\n    line-height: 64px;\n    padding-left: 16px;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n  }\n  .article-header-name {\n    display: block;\n    font-size: 28px;\n    line-height: 36px;\n    font-weight: bold;\n  }\n  .article-header-desc {\n    color: #666;\n    display: block;\n    font-size: 24px;\n    margin-top: 4px;\n    line-height: 24px;\n  }\n}\n.article-header-right {\n  width: 130px;\n  height: 50px;\n  flex: 0 0 130px;\n  margin-top: 7px;\n  .article-header-btn {\n    font-size: 24px;\n    color: #ffffff;\n    line-height: 50px;\n    text-align: center;\n    border-radius: 25px;\n    background: #4388e1;\n    box-sizing: border-box;\n    &.follow {\n      background: #fff;\n      border: 2px solid #e8e8e8;\n      color: #999;\n    }\n  }\n}\n</style>"],"sourceRoot":"src/components/ArticleHeader"}]}
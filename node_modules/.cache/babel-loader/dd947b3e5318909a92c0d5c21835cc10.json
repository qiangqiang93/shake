{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/hytx-rebuild/node_modules/eslint-loader/index.js??ref--13-0!/Users/qiang/work/hytx/hytx-rebuild/src/utils/tools.js","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/utils/tools.js","mtime":1547620596129},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport store from '../store';\nimport config from '../config';\nimport sdkService from '../service/sdkService';\nimport system from '../api/system';\nimport { isShare, getParamsFromUrl, isIos } from '../utils/index';\nvar IsIos = isIos();\nvar firstIn = true; // 获取签名信息并储存\n\nvar getSignatureConfig = function getSignatureConfig() {\n  if (store.state.system.platform !== 'wechat') return;\n  system.getSignature();\n};\n\nvar sdkSignature = function sdkSignature(to, from) {\n  // state    boolean     true/false      true为非支付、非分享路径\n  var _IosFirst = function _IosFirst(state) {\n    if (IsIos && firstIn) {\n      window.url = location.href;\n      firstIn = false;\n      if (state) sdkService.config('ios');\n    } else {\n      if (state) sdkService.config();\n    }\n  };\n\n  var _signature = function _signature() {\n    var reg = new RegExp(to.fullPath.replace(/\\?/, '\\\\?') + '$');\n    if (!reg.test(location.href)) return;\n\n    if (config.payPath.includes(to.path)) {\n      _IosFirst();\n\n      sdkService.config('pay');\n    } else if (isShare(to.path)) {\n      _IosFirst();\n\n      if (getParamsFromUrl('task') || to.path === '/circle/match') {\n        sdkService.config('shareTask');\n      } else {\n        sdkService.config('share');\n      }\n    } else {\n      _IosFirst(true);\n\n      sdkService.defaultShare();\n    }\n  }; // 如果来自分享任务则关闭分享引导\n\n\n  if (store.state.system.platform !== 'wechat') return;\n\n  if (isShare(from.path)) {\n    store.commit('system/shareGuide', false);\n  }\n\n  setTimeout(function () {\n    if (store.state.system.signature.app_id) {\n      _signature();\n    } else {\n      setTimeout(function () {\n        _signature();\n      }, 200);\n    }\n  }, 200);\n};\n\nexport { getSignatureConfig, sdkSignature };",{"version":3,"sources":["/Users/qiang/work/hytx/hytx-rebuild/src/utils/tools.js"],"names":["store","config","sdkService","system","isShare","getParamsFromUrl","isIos","IsIos","firstIn","getSignatureConfig","state","platform","getSignature","sdkSignature","to","from","_IosFirst","window","url","location","href","_signature","reg","RegExp","fullPath","replace","test","payPath","includes","path","defaultShare","commit","setTimeout","signature","app_id"],"mappings":";;;;AAAA,OAAOA,KAAP,MAAkB,UAAlB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,UAAP,MAAuB,uBAAvB;AACA,OAAOC,MAAP,MAAmB,eAAnB;AAEA,SACEC,OADF,EAEEC,gBAFF,EAGEC,KAHF,QAIO,gBAJP;AAKA,IAAMC,KAAK,GAAGD,KAAK,EAAnB;AACA,IAAIE,OAAO,GAAG,IAAd,C,CACA;;AACA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,GAAY;AACrC,MAAIT,KAAK,CAACU,KAAN,CAAYP,MAAZ,CAAmBQ,QAAnB,KAAgC,QAApC,EAA8C;AAC9CR,EAAAA,MAAM,CAACS,YAAP;AACD,CAHD;;AAKA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAUC,EAAV,EAAcC,IAAd,EAAoB;AACvC;AACA,MAAMC,SAAS,GAAG,SAAZA,SAAY,CAAUN,KAAV,EAAiB;AACjC,QAAIH,KAAK,IAAIC,OAAb,EAAsB;AACpBS,MAAAA,MAAM,CAACC,GAAP,GAAaC,QAAQ,CAACC,IAAtB;AACAZ,MAAAA,OAAO,GAAG,KAAV;AACA,UAAIE,KAAJ,EAAWR,UAAU,CAACD,MAAX,CAAkB,KAAlB;AACZ,KAJD,MAIO;AACL,UAAIS,KAAJ,EAAWR,UAAU,CAACD,MAAX;AACZ;AACF,GARD;;AASA,MAAMoB,UAAU,GAAG,SAAbA,UAAa,GAAY;AAC7B,QAAIC,GAAG,GAAG,IAAIC,MAAJ,CAAWT,EAAE,CAACU,QAAH,CAAYC,OAAZ,CAAoB,IAApB,EAA0B,KAA1B,IAAmC,GAA9C,CAAV;AACA,QAAI,CAACH,GAAG,CAACI,IAAJ,CAASP,QAAQ,CAACC,IAAlB,CAAL,EAA8B;;AAC9B,QAAInB,MAAM,CAAC0B,OAAP,CAAeC,QAAf,CAAwBd,EAAE,CAACe,IAA3B,CAAJ,EAAsC;AACpCb,MAAAA,SAAS;;AACTd,MAAAA,UAAU,CAACD,MAAX,CAAkB,KAAlB;AACD,KAHD,MAGO,IAAIG,OAAO,CAACU,EAAE,CAACe,IAAJ,CAAX,EAAsB;AAC3Bb,MAAAA,SAAS;;AACT,UAAIX,gBAAgB,CAAC,MAAD,CAAhB,IAA4BS,EAAE,CAACe,IAAH,KAAY,eAA5C,EAA6D;AAC3D3B,QAAAA,UAAU,CAACD,MAAX,CAAkB,WAAlB;AACD,OAFD,MAEO;AACLC,QAAAA,UAAU,CAACD,MAAX,CAAkB,OAAlB;AACD;AACF,KAPM,MAOA;AACLe,MAAAA,SAAS,CAAC,IAAD,CAAT;;AACAd,MAAAA,UAAU,CAAC4B,YAAX;AACD;AACF,GAjBD,CAXuC,CA6BvC;;;AACA,MAAI9B,KAAK,CAACU,KAAN,CAAYP,MAAZ,CAAmBQ,QAAnB,KAAgC,QAApC,EAA8C;;AAC9C,MAAIP,OAAO,CAACW,IAAI,CAACc,IAAN,CAAX,EAAwB;AACtB7B,IAAAA,KAAK,CAAC+B,MAAN,CAAa,mBAAb,EAAkC,KAAlC;AACD;;AACDC,EAAAA,UAAU,CAAC,YAAM;AACf,QAAIhC,KAAK,CAACU,KAAN,CAAYP,MAAZ,CAAmB8B,SAAnB,CAA6BC,MAAjC,EAAyC;AACvCb,MAAAA,UAAU;AACX,KAFD,MAEO;AACLW,MAAAA,UAAU,CAAC,YAAM;AACfX,QAAAA,UAAU;AACX,OAFS,EAEP,GAFO,CAAV;AAGD;AACF,GARS,EAQP,GARO,CAAV;AASD,CA3CD;;AA6CA,SACEZ,kBADF,EAEEI,YAFF","sourcesContent":["import store from '../store'\nimport config from '../config'\nimport sdkService from '../service/sdkService'\nimport system from '../api/system'\n\nimport {\n  isShare,\n  getParamsFromUrl,\n  isIos\n} from '../utils/index'\nconst IsIos = isIos()\nlet firstIn = true\n// 获取签名信息并储存\nconst getSignatureConfig = function () {\n  if (store.state.system.platform !== 'wechat') return\n  system.getSignature()\n}\n\nconst sdkSignature = function (to, from) {\n  // state    boolean     true/false      true为非支付、非分享路径\n  const _IosFirst = function (state) {\n    if (IsIos && firstIn) {\n      window.url = location.href\n      firstIn = false\n      if (state) sdkService.config('ios')\n    } else {\n      if (state) sdkService.config()\n    }\n  }\n  const _signature = function () {\n    let reg = new RegExp(to.fullPath.replace(/\\?/, '\\\\?') + '$')\n    if (!reg.test(location.href)) return\n    if (config.payPath.includes(to.path)) {\n      _IosFirst()\n      sdkService.config('pay')\n    } else if (isShare(to.path)) {\n      _IosFirst()\n      if (getParamsFromUrl('task') || to.path === '/circle/match') {\n        sdkService.config('shareTask')\n      } else {\n        sdkService.config('share')\n      }\n    } else {\n      _IosFirst(true)\n      sdkService.defaultShare()\n    }\n  }\n  // 如果来自分享任务则关闭分享引导\n  if (store.state.system.platform !== 'wechat') return\n  if (isShare(from.path)) {\n    store.commit('system/shareGuide', false)\n  }\n  setTimeout(() => {\n    if (store.state.system.signature.app_id) {\n      _signature()\n    } else {\n      setTimeout(() => {\n        _signature()\n      }, 200)\n    }\n  }, 200)\n}\n\nexport {\n  getSignatureConfig,\n  sdkSignature\n}"]}]}
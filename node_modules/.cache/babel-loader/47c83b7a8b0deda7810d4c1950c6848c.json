{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/module/webPage/mine/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/module/webPage/mine/index.vue","mtime":1547020310201},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport CloneDialog from '@/components/CloneDialog';\nimport dialogService from '@/service/dialogService';\nimport Operator from '../../../components/Operator';\nimport AndroidHeader from '../../../components/AndroidHeader/index';\nimport Wrapper from '../../../components/Wrapper/index';\nimport Loading from '../../../components/Loading/index';\nimport httpService from '@/service/httpService';\nimport { mapState, mapActions } from 'vuex';\nexport default {\n  name: 'webPageMine',\n  data: function data() {\n    return {\n      windowHeight: null,\n      //高度\n      loading: false,\n      // 是否在加载\n      last_page: null,\n      // 总页数\n      page: 1,\n      // 当前页数\n      firstIn: true,\n      //第一次进入\n      showOperator: false,\n      //管理底部弹出\n      show: false,\n      // clone\n      selectInfo: {\n        type: null,\n        index: null\n      },\n      allList: []\n    };\n  },\n  components: {\n    AndroidHeader: AndroidHeader,\n    Wrapper: Wrapper,\n    Operator: Operator,\n    CloneDialog: CloneDialog,\n    Loading: Loading\n  },\n  computed: _objectSpread({}, mapState({\n    userInfo: function userInfo(state) {\n      return state.user.userInfo;\n    }\n  })),\n  mounted: function () {\n    var _mounted = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      var _self;\n\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              this.getlist();\n              _self = this;\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function mounted() {\n      return _mounted.apply(this, arguments);\n    }\n\n    return mounted;\n  }(),\n  methods: _objectSpread({}, mapActions(['system/updateBeVipPath']), {\n    // 获取列表\n    getlist: function () {\n      var _getlist = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(load) {\n        var res;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.loading = true;\n                if (load) this.page += 1;\n                _context2.next = 4;\n                return httpService.get('/front/personal_page/all', {\n                  page: this.page\n                });\n\n              case 4:\n                res = _context2.sent;\n\n                if (!(res.status !== 0)) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                dialogService.toast(res.message);\n                return _context2.abrupt(\"return\");\n\n              case 8:\n                if (load) {\n                  this.allList = this.allList.concat(res.data.data);\n                } else {\n                  this.allList = res.data.data;\n                  this.firstIn = false;\n                }\n\n                this.last_page = res.data.last_page;\n                this.windowHeight = document.documentElement.clientHeight;\n                this.loading = false;\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getlist(_x) {\n        return _getlist.apply(this, arguments);\n      }\n\n      return getlist;\n    }(),\n    nextPage: function nextPage(scrolled, scrollHeight) {\n      var scrollBottom = this.windowHeight + scrolled > scrollHeight - 100;\n\n      if (!scrollBottom || this.loading || this.page >= this.last_page) {\n        return false;\n      } else {\n        this.getlist(true);\n      }\n    },\n    // 管理按钮\n    manage: function manage(type, index) {\n      this.showOperator = true;\n      this.selectInfo.type = type;\n      this.selectInfo.index = index;\n    },\n    // 开通会员操作\n    _openVip: function _openVip(msg) {\n      var _self = this;\n\n      dialogService.confirm('开通会员才能制作多个网页哦，是否去开通？', function (ok) {\n        if (ok) {\n          _self['system/updateBeVipPath']('/webPage/mine');\n\n          _self.$router.push({\n            path: '/vipCenter'\n          });\n        }\n      });\n    },\n    // 跳转页面\n    toPage: function toPage(where) {\n      if (where == 'do') {\n        if (this.allList.length >= 1) {\n          if (this.userInfo.vip_level) {\n            this.$router.push('/webPage/edit');\n          } else {\n            this._openVip();\n          }\n        }\n      } else if (where == 'clone') {\n        this.$router.push(\"/cloneRank\");\n      }\n    },\n    // 跳转到自定义网页详情\n    goMarketingDetail: function goMarketingDetail(index, showGuide) {\n      this.$router.push(\"/webPage/detail/\".concat(this.allList[index].id));\n    },\n    // 克隆弹窗\n    closeHandle: function () {\n      var _closeHandle = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3(input) {\n        var res;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!input) {\n                  _context3.next = 11;\n                  break;\n                }\n\n                if (!this.cloneSettingId) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                _context3.next = 4;\n                return httpService.put(\"/front/personal_page/customs/\".concat(this.cloneSettingId), input);\n\n              case 4:\n                res = _context3.sent;\n                if (res.status !== 0) dialogService.alert(res.message); // 修改成功后操作\n\n                dialogService.toast('修改成功');\n                this.showOperator = false;\n                this.show = false;\n\n              case 9:\n                _context3.next = 12;\n                break;\n\n              case 11:\n                this.show = false;\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function closeHandle(_x2) {\n        return _closeHandle.apply(this, arguments);\n      }\n\n      return closeHandle;\n    }(),\n    // 设置默认\n    setDefault: function () {\n      var _setDefault = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee4(key, type, index) {\n        var res;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!this[key][index].is_default) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                this.showOperator = false;\n                return _context4.abrupt(\"return\", false);\n\n              case 3:\n                _context4.prev = 3;\n                _context4.next = 6;\n                return httpService.post(\"/front/personal_page/user_default_temp/\".concat(this[key][index].id));\n\n              case 6:\n                res = _context4.sent;\n                httpService.get('/front/inter-push-info', {\n                  type: 'edit',\n                  interpush_type: 1,\n                  interpush_article: this[key][index].id\n                });\n\n                if (!(res.status !== 0)) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 10:\n                this[key] = this[key].map(function (item, _index) {\n                  item.is_default = index === _index ? 1 : 0;\n                  return item;\n                });\n                this.showOperator = false;\n                dialogService.alert('设置成功');\n                _context4.next = 18;\n                break;\n\n              case 15:\n                _context4.prev = 15;\n                _context4.t0 = _context4[\"catch\"](3);\n                dialogService.alert(_context4.t0.message);\n\n              case 18:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[3, 15]]);\n      }));\n\n      function setDefault(_x3, _x4, _x5) {\n        return _setDefault.apply(this, arguments);\n      }\n\n      return setDefault;\n    }(),\n    // 编辑网页\n    editPage: function editPage(key, type, index) {\n      this.showOperator = false;\n\n      if (type === 1) {\n        this.$router.push({\n          path: \"/tools/personal/template/\".concat(this[key][index].template_id, \"?edit=1\")\n        });\n      }\n\n      if (type === 2) {\n        this.$router.push({\n          path: \"/webPage/edit/\".concat(this[key][index].id)\n        });\n      }\n    },\n    // 删除网页\n    delPage: function delPage(key, type, index) {\n      var _self = this;\n\n      var _delpage =\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee5() {\n          var res, _res;\n\n          return regeneratorRuntime.wrap(function _callee5$(_context5) {\n            while (1) {\n              switch (_context5.prev = _context5.next) {\n                case 0:\n                  _context5.prev = 0;\n\n                  if (!(type === 1)) {\n                    _context5.next = 7;\n                    break;\n                  }\n\n                  _context5.next = 4;\n                  return httpService.delete(\"/front/personal_page/user_temp/\".concat(_self[key][index].id));\n\n                case 4:\n                  res = _context5.sent;\n\n                  if (!(res.status !== 0)) {\n                    _context5.next = 7;\n                    break;\n                  }\n\n                  throw new Error(res.message);\n\n                case 7:\n                  if (!(type === 2)) {\n                    _context5.next = 13;\n                    break;\n                  }\n\n                  _context5.next = 10;\n                  return httpService.delete(\"/front/personal_page/customs/\".concat(_self[key][index].id));\n\n                case 10:\n                  _res = _context5.sent;\n\n                  if (!(_res.status !== 0)) {\n                    _context5.next = 13;\n                    break;\n                  }\n\n                  throw new Error(_res.message);\n\n                case 13:\n                  dialogService.alert('删除成功！');\n                  _self.showOperator = false;\n\n                  _self[key].splice(index, 1);\n\n                  _context5.next = 21;\n                  break;\n\n                case 18:\n                  _context5.prev = 18;\n                  _context5.t0 = _context5[\"catch\"](0);\n                  dialogService.alert(_context5.t0.message);\n\n                case 21:\n                case \"end\":\n                  return _context5.stop();\n              }\n            }\n          }, _callee5, this, [[0, 18]]);\n        }));\n\n        return function _delpage() {\n          return _ref.apply(this, arguments);\n        };\n      }();\n\n      dialogService.confirm('您确定要删除该模板吗？', function (ok) {\n        _self.showOperator = false;\n\n        if (ok) {\n          _delpage();\n        }\n      });\n    },\n    // 获取当前网页的封面\n    getItemCover: function getItemCover(item) {\n      var cover = '/static/cover_custom.1.png'; //   item.type = 1\n\n      if (item.type === 1) {\n        switch (item.cate) {\n          case '推荐':\n            cover = '/static/cover_tuijian.png';\n            break;\n\n          case '节日':\n            cover = '/static/cover_jieri.png';\n            break;\n\n          case '商务':\n            cover = '/static/cover_shangwu.png';\n            break;\n\n          case '微商':\n            cover = '/static/cover_weishang.png';\n            break;\n\n          case '科技':\n            // cover = '/static/cover/cover_keji.png'\n            break;\n\n          default:\n            break;\n        }\n      } else {\n        var content = JSON.parse(item.content);\n\n        for (var i = 0; i < content.length; i++) {\n          if (content[i].type === 'slider' && content[i].isShow) {\n            cover = content[i].children[0].img.src;\n            break;\n          }\n        }\n      }\n\n      return cover;\n    },\n    // 克隆设置\n    cloneSetting: function cloneSetting(index) {\n      this.cloneSettingId = this.allList[index].id;\n      this.show = true;\n    },\n    // 去相应页面\n    goModal: function goModal(type) {\n      if (type === 1) {\n        this.$router.push({\n          path: \"/tools/personal\"\n        });\n      } else {\n        this.$router.push({\n          path: \"/tools/personal/customIndex\"\n        });\n      }\n    }\n  })\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["/**\n*  我的网页改版\n*/\n\n<template>\n  <div class=\"wraper\">\n    <Wrapper @scrolling=\"nextPage\" style=\"padding-bottom: 120px;\">\n      <AndroidHeader ref=\"header\" title=\"个人微网\" iconColor=\"#000\" fontColor=\"#000\" background=\"#fff\">\n        <span style=\"float:right\" class=\"productValue\">产品价值</span>\n      </AndroidHeader>\n      <Loading v-show=\"firstIn\"></Loading>\n      <p @click=\"toPage('do')\" v-show=\"!allList.length&&!firstIn\" class=\"lack\"><img src=\"./lack.jpg\" /></p>\n      <div class=\"marketing-item\" @click=\"goMarketingDetail(index)\" v-for=\"(item, index) in allList\" :key=\"index\">\n        <img src=\"./moren.png\" class=\"default\" v-if=\"item.is_default\" />\n        <div class=\"marketing-item-poster\">\n          <img :src=\"getItemCover(item)\" />\n        </div>\n        <div class=\"marketing-item-info\">\n          <p class=\"marketing-item-title\" v-text=\"item.title\"></p>\n          <p class=\"marketing-item-counter\">\n            <span class=\"marketing-item-visited\">\n              <i class=\"iconfont icon-liulan\"></i>\n              <em>99</em>\n            </span>\n            <span class=\"marketing-item-shared\">\n              <i class=\"iconfont icon-fenxiang4\"></i>\n              <em>99</em>\n            </span>\n          </p>\n          <p class=\"marketing-item-date\" v-text=\"item.created_at.substring(0,10)\"></p>\n          <p class=\"marketing-item-operate\">\n            <span class=\"marketing-item-share\" @click.stop=\"goMarketingDetail(index,true)\">\n              <i class=\"iconfont icon-fenxiang\"></i>\n              分享\n            </span>\n            <span class=\"marketing-item-manager\" @click.stop=\"manage(item.type,index)\">\n              <i class=\"iconfont icon-setting\"></i>\n              管理\n            </span>\n          </p>\n        </div>\n      </div>\n      <p class=\"tips\" v-show=\"allList.length\">{{loading?'正在加载...':'暂无更多'}}</p>\n      <div ref=\"footer\" class=\"footBar\">\n        <div class=\"button button-do\" @click=\"toPage('do')\">去制作</div>\n        <div class=\"button button-clone\" @click=\"toPage('clone')\">去克隆</div>\n      </div>\n      <Operator :show=\"showOperator\" v-model=\"showOperator\">\n        <div v-if=\"selectInfo.type===2\" class=\"operate\" @click=\"cloneSetting(selectInfo.index)\">\n          <div class=\"operate-icon\">\n            <i class=\"iconfont icon-setting\"></i>\n          </div>\n          <p class=\"operate-text\">克隆设置</p>\n        </div>\n        <div class=\"operate\" @click=\"editPage('allList', selectInfo.type, selectInfo.index)\">\n          <div class=\"operate-icon\">\n            <i class=\"iconfont icon-edit-b\"></i>\n          </div>\n          <p class=\"operate-text\">修改</p>\n        </div>\n        <div class=\"operate\" @click=\"setDefault('allList', selectInfo.type, selectInfo.index)\">\n          <div class=\"operate-icon\">\n            <i class=\"iconfont icon-Group-\"></i>\n          </div>\n          <p class=\"operate-text\">设为默认</p>\n        </div>\n        <div class=\"operate\" @click=\"delPage('allList', selectInfo.type, selectInfo.index)\">\n          <div class=\"operate-icon\">\n            <i class=\"iconfont icon-shanchu3\"></i>\n          </div>\n          <p class=\"operate-text\">删除</p>\n        </div>\n      </Operator>\n      <CloneDialog v-if=\"show\" @closeHandle=\"closeHandle\"></CloneDialog>\n    </Wrapper>\n  </div>\n</template>\n\n<script>\nimport CloneDialog from '@/components/CloneDialog'\nimport dialogService from '@/service/dialogService'\nimport Operator from '../../../components/Operator'\nimport AndroidHeader from '../../../components/AndroidHeader/index'\nimport Wrapper from '../../../components/Wrapper/index'\nimport Loading from '../../../components/Loading/index'\nimport httpService from '@/service/httpService'\nimport { mapState, mapActions } from 'vuex'\n\nexport default {\n  name: 'webPageMine',\n  data() {\n    return {\n      windowHeight: null, //高度\n      loading: false, // 是否在加载\n      last_page: null, // 总页数\n      page: 1, // 当前页数\n      firstIn: true, //第一次进入\n      showOperator: false, //管理底部弹出\n      show: false, // clone\n      selectInfo: { type: null, index: null },\n      allList: []\n    }\n  },\n  components: {\n    AndroidHeader,\n    Wrapper,\n    Operator,\n    CloneDialog,\n    Loading\n  },\n  computed: {\n    ...mapState({\n      userInfo: state => state.user.userInfo\n    })\n  },\n  async mounted() {\n    this.getlist()\n    let _self = this\n  },\n  methods: {\n    ...mapActions(['system/updateBeVipPath']),\n    // 获取列表\n    async getlist(load) {\n      this.loading = true\n      if (load) this.page += 1\n      let res = await httpService.get('/front/personal_page/all', {\n        page: this.page\n      })\n      if (res.status !== 0) {\n        dialogService.toast(res.message)\n        return\n      }\n      if (load) {\n        this.allList = this.allList.concat(res.data.data)\n      } else {\n        this.allList = res.data.data\n        this.firstIn = false\n      }\n      this.last_page = res.data.last_page\n      this.windowHeight = document.documentElement.clientHeight\n      this.loading = false\n    },\n    nextPage(scrolled, scrollHeight) {\n      let scrollBottom = this.windowHeight + scrolled > scrollHeight - 100\n      if (!scrollBottom || this.loading || this.page >= this.last_page) {\n        return false\n      } else {\n        this.getlist(true)\n      }\n    },\n    // 管理按钮\n    manage(type, index) {\n      this.showOperator = true\n      this.selectInfo.type = type\n      this.selectInfo.index = index\n    },\n    // 开通会员操作\n    _openVip(msg) {\n      let _self = this\n      dialogService.confirm('开通会员才能制作多个网页哦，是否去开通？', ok => {\n        if (ok) {\n          _self['system/updateBeVipPath']('/webPage/mine')\n          _self.$router.push({\n            path: '/vipCenter'\n          })\n        }\n      })\n    },\n    // 跳转页面\n    toPage(where) {\n      if (where == 'do') {\n        if (this.allList.length >= 1) {\n          if (this.userInfo.vip_level) {\n            this.$router.push('/webPage/edit')\n          } else {\n            this._openVip()\n          }\n        }\n      } else if (where == 'clone') {\n        this.$router.push(`/cloneRank`)\n      }\n    },\n    // 跳转到自定义网页详情\n    goMarketingDetail(index, showGuide) {\n      this.$router.push(`/webPage/detail/${this.allList[index].id}`)\n    },\n    // 克隆弹窗\n    async closeHandle(input) {\n      if (input) {\n        if (this.cloneSettingId) {\n          let res = await httpService.put(\n            `/front/personal_page/customs/${this.cloneSettingId}`,\n            input\n          )\n          if (res.status !== 0) dialogService.alert(res.message)\n          // 修改成功后操作\n          dialogService.toast('修改成功')\n          this.showOperator = false\n          this.show = false\n        }\n      } else {\n        this.show = false\n      }\n    },\n    // 设置默认\n    async setDefault(key, type, index) {\n      if (this[key][index].is_default) {\n        this.showOperator = false\n        return false\n      }\n      try {\n        let res = await httpService.post(\n          `/front/personal_page/user_default_temp/${this[key][index].id}`\n        )\n        httpService.get('/front/inter-push-info', {\n          type: 'edit',\n          interpush_type: 1,\n          interpush_article: this[key][index].id\n        })\n        if (res.status !== 0) throw new Error(res.message)\n        this[key] = this[key].map((item, _index) => {\n          item.is_default = index === _index ? 1 : 0\n          return item\n        })\n        this.showOperator = false\n        dialogService.alert('设置成功')\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // 编辑网页\n    editPage(key, type, index) {\n      this.showOperator = false\n      if (type === 1) {\n        this.$router.push({\n          path: `/tools/personal/template/${\n            this[key][index].template_id\n          }?edit=1`\n        })\n      }\n      if (type === 2) {\n        this.$router.push({\n          path: `/webPage/edit/${this[key][index].id}`\n        })\n      }\n    },\n    // 删除网页\n    delPage(key, type, index) {\n      let _self = this\n      const _delpage = async function() {\n        try {\n          if (type === 1) {\n            let res = await httpService.delete(\n              `/front/personal_page/user_temp/${_self[key][index].id}`\n            )\n            if (res.status !== 0) throw new Error(res.message)\n          }\n          if (type === 2) {\n            let res = await httpService.delete(\n              `/front/personal_page/customs/${_self[key][index].id}`\n            )\n            if (res.status !== 0) throw new Error(res.message)\n          }\n          dialogService.alert('删除成功！')\n          _self.showOperator = false\n          _self[key].splice(index, 1)\n        } catch (err) {\n          dialogService.alert(err.message)\n        }\n      }\n      dialogService.confirm('您确定要删除该模板吗？', function(ok) {\n        _self.showOperator = false\n        if (ok) {\n          _delpage()\n        }\n      })\n    },\n    // 获取当前网页的封面\n    getItemCover(item) {\n      let cover = '/static/cover_custom.1.png'\n      //   item.type = 1\n      if (item.type === 1) {\n        switch (item.cate) {\n          case '推荐':\n            cover = '/static/cover_tuijian.png'\n            break\n          case '节日':\n            cover = '/static/cover_jieri.png'\n            break\n          case '商务':\n            cover = '/static/cover_shangwu.png'\n            break\n          case '微商':\n            cover = '/static/cover_weishang.png'\n            break\n          case '科技':\n            // cover = '/static/cover/cover_keji.png'\n            break\n          default:\n            break\n        }\n      } else {\n        let content = JSON.parse(item.content)\n        for (let i = 0; i < content.length; i++) {\n          if (content[i].type === 'slider' && content[i].isShow) {\n            cover = content[i].children[0].img.src\n            break\n          }\n        }\n      }\n      return cover\n    },\n    // 克隆设置\n    cloneSetting(index) {\n      this.cloneSettingId = this.allList[index].id\n      this.show = true\n    },\n    // 去相应页面\n    goModal(type) {\n      if (type === 1) {\n        this.$router.push({\n          path: `/tools/personal`\n        })\n      } else {\n        this.$router.push({\n          path: `/tools/personal/customIndex`\n        })\n      }\n    }\n  }\n}\n</script>\n<style scoped lang='scss'>\n.tips {\n  font-size: 28px;\n  text-align: center;\n  margin-top: 40px;\n  padding-bottom: 20px;\n}\n.lack {\n  text-align: center;\n  padding-top: 100px;\n}\n.operate {\n  text-align: center;\n  .iconfont {\n    font-size: 42px;\n  }\n}\n.operate-text {\n  color: #333;\n  font-size: 24px;\n  margin-top: 15px;\n  font-family: 'PingFang SC Medium';\n}\n.operate-icon {\n  width: 100px;\n  height: 100px;\n  display: flex;\n  color: #333333;\n  overflow: hidden;\n  align-items: center;\n  border-radius: 50px;\n  background: #f4f4f4;\n  justify-content: center;\n}\n.footBar {\n  width: 100%;\n  height: 120px;\n  box-sizing: border-box;\n  background: #fff;\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n  .button {\n    width: 325px;\n    height: 80px;\n    line-height: 80px;\n    border-radius: 5px;\n    text-align: center;\n    font-size: 30px;\n  }\n  .button-clone {\n    color: #274ff3;\n    border: 2px solid #7777ff;\n  }\n  .button-do {\n    background: #274ff3;\n    color: #fff;\n  }\n}\n.productValue {\n  position: absolute;\n  right: 30px;\n  top: 0;\n  font-size: 28px;\n}\n.wraper {\n  background: #f6f6f6;\n}\n.marketing-item {\n  margin: auto;\n  width: 689px;\n  height: 220px;\n  padding: 30px;\n  overflow: hidden;\n  position: relative;\n  background: #fff;\n  border-radius: 6px;\n  margin-bottom: 20px;\n  box-sizing: border-box;\n  box-shadow: 0px 0px 15px 0px rgba(0, 0, 0, 0.08);\n  .default {\n    position: absolute;\n    top: 20px;\n    left: 20px;\n    width: 92px;\n    height: 90px;\n  }\n}\n.marketing-item-poster {\n  float: left;\n  width: 288px;\n  height: 162px;\n  overflow: hidden;\n  margin-right: 20px;\n  border-radius: 6px;\n  box-sizing: border-box;\n  background-size: cover;\n  background-position: center;\n  img {\n    object-fit: cover;\n    width: 100%;\n    height: 100%;\n    border: 1px solid #dadada;\n    box-sizing: border-box;\n  }\n}\n.marketing-item-info {\n  float: left;\n  width: 320px;\n  height: 160px;\n  overflow: hidden;\n}\n.marketing-item-title {\n  height: 28px;\n  font-size: 28px;\n  color: #000000;\n  overflow: hidden;\n  line-height: 28px;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  font-family: 'PingFang SC Medium';\n}\n.marketing-item-date,\n.marketing-item-counter {\n  font-size: 20px;\n  color: #999999;\n  overflow: hidden;\n  font-family: 'PingFang SC Medium';\n}\n.marketing-item-shared,\n.marketing-item-visited {\n  float: left;\n  width: 114px;\n  height: 26px;\n  display: block;\n  margin-top: 15px;\n  line-height: 26px;\n  .iconfont {\n    float: left;\n    display: block;\n    font-size: 26px;\n    margin-right: 18px;\n  }\n  em {\n    float: left;\n    display: block;\n    font-style: normal;\n  }\n}\n.marketing-item-date {\n  margin-top: 16px;\n}\n.marketing-item-operate {\n  font-size: 24px;\n  color: #333333;\n  padding-top: 28px;\n  text-align: right;\n  line-height: 24px;\n  font-family: 'PingFang SC Medium';\n  .marketing-item-share {\n    margin-right: 36px;\n  }\n  .icon-fenxiang {\n    font-size: 22px;\n  }\n  .icon-setting {\n    font-size: 26px;\n  }\n}\n</style>\n"],"sourceRoot":"src/module/webPage/mine"}]}
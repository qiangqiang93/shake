{"remainingRequest":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/hytx-rebuild/src/module/webPage/edit/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/hytx-rebuild/src/module/webPage/edit/index.vue","mtime":1547004851851},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/hytx-rebuild/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport _objectSpread from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/qiang/work/hytx/hytx-rebuild/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// import html2canvas from 'html2canvas'\nimport appHeader from '../components/appHeader/index';\nimport AppAblum from '@/components/AppAblum';\nimport eventBus from '@/utils/eventBus';\nimport { mapState, mapActions } from 'vuex';\nimport httpService from '@/service/httpService';\nimport CloneDialog from '@/components/CloneDialog';\nimport dialogService from '@/service/dialogService';\nimport CustomComponent from '@/components/CustomComponent';\nimport ComponentHandler from '@/components/ComponentHandler';\nimport Wrapper from '@/components/Wrapper';\nexport default {\n  name: 'webPageEdit',\n  data: function data() {\n    return {\n      addIndex: null,\n      // 添加组件到指定位置\n      id: null,\n      idArr: [],\n      //\n      datas: [],\n      //clonePage的content\n      ablum: null,\n      canEdit: true,\n      pageTitle: '',\n      operateType: null,\n      operateComponent: null,\n      indexa: null,\n      bgcolor: 'fff',\n      // 背景颜色\n      isSample: false,\n      // 是否显示示列\n      cloneUserId: null,\n      // 克隆模板主人id\n      windowHeight: null,\n      // offsetHeight\n      showCloneDialog: false,\n      // 是否显示克隆设置\n      cloneId: this.vuexCloneId,\n      // 克隆id\n      isSave: false //提示还没保存\n\n    };\n  },\n  mounted: function () {\n    var _mounted = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      var _self, data, hasCard, cardInfo, res;\n\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _self = this;\n              this['webPage/updateSelectShow'](false);\n              this['webPage/updateCloneId'](null);\n\n              if (!this.$route.params.id) {\n                _context.next = 7;\n                break;\n              }\n\n              this.editInit();\n              _context.next = 33;\n              break;\n\n            case 7:\n              this.isEditVideo();\n              this.isPurchase();\n\n              if (!(this.clonePage !== null)) {\n                _context.next = 33;\n                break;\n              }\n\n              data = JSON.parse(this.clonePage.content); // 如果数据中包含了名片信息，则替换名片信息\n\n              hasCard = data.some(function (item) {\n                return item.type === 'baseInfo';\n              });\n\n              if (!hasCard) {\n                _context.next = 24;\n                break;\n              }\n\n              cardInfo = null;\n\n              if (!this.cardInfo) {\n                _context.next = 18;\n                break;\n              }\n\n              cardInfo = this.cardInfo;\n              _context.next = 23;\n              break;\n\n            case 18:\n              _context.next = 20;\n              return httpService.get('/front/card', {\n                user_id: this.user.id\n              });\n\n            case 20:\n              res = _context.sent;\n              cardInfo = res.data;\n              this['webPage/updateCardInfo'](res.data);\n\n            case 23:\n              data.forEach(function (item) {\n                if (item.type === 'baseInfo') {\n                  item.infos.name = cardInfo.name;\n                  item.infos.jobs = cardInfo.profession;\n                  item.infos.company = cardInfo.company;\n                  item.infos.avatar.href = cardInfo.portrait;\n                }\n              });\n\n            case 24:\n              this.datas = data; // 解决修改已保存的自定义网页时，没上传6张图片时没显示6个点的问题\n\n              this.datas.map(function (el) {\n                if (el.type === 'slider') {\n                  el.children.map(function (ele) {\n                    ele.isSliderItem = true;\n                  });\n                }\n              });\n              this.pageTitle = this.clonePage.title;\n              this.bgcolor = this.clonePage.background;\n              this.cloneUserId = this.clonePage.user_id;\n              this.idArr = this.clonePage.components && this.clonePage.components.split(',');\n              this['webPage/updateClonePage']({\n                type: 'clean',\n                data: {}\n              });\n              _context.next = 33;\n              break;\n\n            case 33:\n              this.windowHeight = document.documentElement.offsetHeight; // window.addEventListener('resize', this.onResize)\n\n            case 34:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function mounted() {\n      return _mounted.apply(this, arguments);\n    }\n\n    return mounted;\n  }(),\n  methods: _objectSpread({}, mapActions(['webPage/updateSelectShow', 'webPage/updateEditVideo', 'webPage/updateTempDatas', 'webPage/updateVideoIndex', 'webPage/updateCardInfo', 'webPage/updateCloneId', 'webPage/updateClonePage', 'webPage/updatePreviewGoods', 'system/updateRouter', 'system/updateCropper']), {\n    // 新上传图片\n    upload: function upload(index, data) {\n      if (this.datas[index].type === 'baseInfo') {\n        this.datas[index].infos.avatar.href = data.path;\n      } else if (this.datas[index].type === 'goods') {\n        this.datas[index].goods[data.index].img.src = data.path; // 解决没有添加图片就不可以添加超链接\n\n        this.datas[index].isAddSuperLink = true;\n      } else if (this.datas[index].type === 'video') {\n        this.datas[index].video.img.src = data.path; // 解决没有添加图片就不可以添加超链接\n\n        this.datas[index].isAddSuperLink = true;\n      } else {\n        this.datas[index].children[data.index].img.src = data.path; // 解决没有添加图片就不可以添加超链接\n\n        this.datas[index].isAddSuperLink = true;\n      }\n    },\n    actions: function actions(action) {\n      if (action == 'review') {\n        this.toggleEdit();\n      } else if (action == 'save') {\n        this.save();\n      } else if (action == 'back') {\n        this.$router.back();\n      }\n    },\n    // 克隆弹出层\n    closeHandle: function closeHandle(input) {\n      if (input) {\n        var reg = /\\/tools\\/personal\\/customTemplate/;\n\n        if (reg.test(this.$route.path)) {\n          this.saveHandler(input);\n          this.showCloneDialog = false;\n        } else {\n          this.saveHandler(input);\n          this.showCloneDialog = false;\n        }\n      } else {\n        this.showCloneDialog = false;\n      }\n    },\n    // 判断是否处于编辑视频状态\n    isEditVideo: function isEditVideo() {\n      if (this.editVideo) {\n        this.datas = this.tempDatas;\n        this.childOperation('addVideo', this.videoIndex);\n        this['webPage/updateEditVideo'](false);\n        this['webPage/updateTempDatas'](null);\n        this['webPage/updateVideoIndex'](null);\n        return false;\n      } else {\n        return true;\n      }\n    },\n    // 判断是否点击立即购买\n    isPurchase: function isPurchase() {\n      if (this.previewGoods) {\n        this.datas = this.tempDatas;\n        this.canEdit = false;\n        this['webPage/updatePreviewGoods'](false);\n        return false;\n      } else {\n        return true;\n      }\n    },\n    // 如果是编辑的情况\n    editInit: function () {\n      var _editInit = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.id = this.$route.params.id;\n\n                if (this.isEditVideo()) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", false);\n\n              case 3:\n                if (this.isPurchase()) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", false);\n\n              case 5:\n                _context2.prev = 5;\n                _context2.next = 8;\n                return httpService.get(\"/front/personal_page/customs/\".concat(this.id));\n\n              case 8:\n                res = _context2.sent;\n\n                if (!(res.status !== 0)) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 11:\n                this.datas = JSON.parse(res.data.content); // 解决修改已保存的自定义网页时，没上传6张图片时没显示6个点的问题\n\n                this.datas.map(function (el) {\n                  if (el.type === 'slider') {\n                    el.children.map(function (ele) {\n                      ele.isSliderItem = true;\n                    });\n                  }\n                });\n                this.pageTitle = res.data.title;\n                this.bgcolor = res.data.background;\n                _context2.next = 20;\n                break;\n\n              case 17:\n                _context2.prev = 17;\n                _context2.t0 = _context2[\"catch\"](5);\n                dialogService.alert(_context2.t0.message);\n\n              case 20:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[5, 17]]);\n      }));\n\n      function editInit() {\n        return _editInit.apply(this, arguments);\n      }\n\n      return editInit;\n    }(),\n    // 改变背景颜色\n    changebgcolor: function changebgcolor(x) {\n      this.bgcolor = x;\n    },\n    // 改变背景颜色\n    changebgpic: function changebgpic(x) {\n      this.$refs.customWrapper.style.background = \"url(' \".concat(x, \" ') no-repeat fixed center / 100% 100%\");\n      this.bgcolor = \"url(' \".concat(x, \" ') no-repeat fixed center / 100% 100%\");\n    },\n    // 显示组件选择\n    showSelect: function showSelect() {\n      this['webPage/updateSelectShow'](true);\n      this.operateType = 'component';\n    },\n    // 子组件添加一个组件\n    selectComponent: function selectComponent(item) {\n      var _this = this;\n\n      if (item.type === 'slider') {\n        item.children.forEach(function (ele, index) {\n          ele.isSliderItem = true;\n        });\n      }\n\n      if (this.addIndex) {\n        this.datas.splice(this.addIndex, 0, item);\n        this.addIndex = null;\n      } else {\n        this.datas.push(item);\n      }\n\n      this.$nextTick(function () {\n        _this.$refs.customComponents.scrollIntoView(false);\n      });\n    },\n    // 子组件的操作[上移、下移、删除、置顶、切换布局、添加超链接]\n    childOperation: function childOperation(type, index) {\n      var _this2 = this;\n\n      var temp;\n      var arr = JSON.parse(JSON.stringify(this.datas));\n      this.datas = [];\n\n      switch (type) {\n        case 'moveUp':\n          temp = arr[index - 1];\n          arr.splice(index - 1, 1, arr[index]);\n          arr.splice(index, 1, temp);\n          setTimeout(function () {\n            _this2.datas = arr;\n          });\n          break;\n\n        case 'moveDown':\n          temp = arr[index + 1];\n          arr.splice(index + 1, 1, arr[index]);\n          arr.splice(index, 1, temp);\n          setTimeout(function () {\n            _this2.datas = arr;\n          });\n          break;\n\n        case 'addComponent':\n          this.addIndex = index + 1;\n          this.showSelect();\n          setTimeout(function () {\n            _this2.datas = arr;\n          });\n          break;\n\n        case 'delete':\n          arr.splice(index, 1);\n          setTimeout(function () {\n            _this2.datas = arr;\n          });\n          break;\n\n        case 'toggleLayout':\n          this['webPage/updateSelectShow'](true);\n          this.operateType = 'layout';\n          this.operateComponent = arr[index];\n          this.indexa = index;\n          this.datas = arr;\n          break;\n\n        case 'addSuperLink':\n          this['webPage/updateSelectShow'](true);\n          this.operateType = 'superLink';\n          this.indexa = index;\n          this.operateComponent = arr[index];\n          this.datas = arr;\n          break;\n\n        case 'addVideo':\n          this['webPage/updateSelectShow'](true);\n          this.operateType = 'video';\n          this.operateComponent = arr[index];\n          this.indexa = index;\n          this.datas = arr;\n          break;\n\n        default: // nothing\n\n      }\n    },\n    // 子组件调用，内容修改（包含切换布局和添加链接）\n    editComponent: function editComponent(index, item) {\n      this.datas.splice(index, 1, item);\n    },\n    // 删除swiper图\n    delswiper: function delswiper(index, i) {\n      this.datas[index].children[i].img.src = '';\n    },\n    // 预览\n    toggleEdit: function toggleEdit() {\n      var _this3 = this;\n\n      if (this.datas.length === 0) {\n        dialogService.alert('未添加编辑模块内容');\n        return;\n      }\n\n      if (this.canEdit) {\n        this.dataTurnFun();\n      } else {\n        this.datas = this.datas.map(function (item) {\n          item.isShow = true;\n\n          if (item.type === 'slider') {\n            item.children.forEach(function (ele, index) {\n              ele.isSliderItem = true;\n            });\n          }\n\n          return item;\n        });\n      }\n\n      var temp = JSON.parse(JSON.stringify(this.datas));\n      this.datas = [];\n      setTimeout(function () {\n        _this3.datas = temp;\n      });\n      this.canEdit = !this.canEdit;\n    },\n    // 保存\n    save: function save() {\n      var self = this;\n      var flag = false;\n      this.dataTurnFun();\n      flag = this.datas.some(function (item) {\n        return item.isShow;\n      });\n\n      if (this.datas.length < 1 || !flag) {\n        this.datas.map(function (el) {\n          if (el.type === 'slider') {\n            el.children.map(function (ele) {\n              ele.isSliderItem = true;\n            });\n          }\n        });\n        dialogService.alert('请填写内容');\n        return;\n      } else if (this.pageTitle.length === 0) {\n        dialogService.alert('请输入网页名称');\n        return;\n      } else {} // nothing\n      // 判断是否允许克隆\n\n\n      if (!this.id) {\n        this.authClone();\n      } else {\n        this.saveHandler();\n      }\n    },\n    // 数据校验、不填写的数据不显示\n    dataTurnFun: function dataTurnFun() {\n      var idArr = [];\n      var datas = this.datas.map(function (item) {\n        idArr.push(item.id);\n\n        if (item.type === 'title') {\n          item.isShow = item.title || item.subTitle;\n        } else if (item.type === 'baseInfo') {\n          item.isShow = item.infos.name || item.infos.jobs || item.infos.avatar.href || item.infos.company;\n        } else if (item.type === 'text') {\n          item.isShow = item.children.some(function (it) {\n            return it.text;\n          });\n        } else if (item.type === 'slider') {\n          item.children.forEach(function (ele, index) {\n            ele.isSliderItem = !ele.img.src ? false : true;\n          });\n          item.isShow = item.children.some(function (it) {\n            return it.img.src;\n          });\n        } else if (item.type === 'goods') {\n          item.isShow = item.goods.some(function (it) {\n            // 解决只有it.type = 'text' 时img为null没有it.img.src就会报错\n            var src = it.img.src;\n            return it.title || it.lowPrice || it.highPrice || src;\n          });\n        } else if (item.type === 'video') {\n          item.isShow = item.video.title || item.video.content || item.video.img.src;\n        } else {\n          item.isShow = item.children.some(function (it) {\n            // 解决只有it.type = 'text' 时img为null没有it.img.src就会报错\n            var src = it.img ? it.img.src : it.img;\n            return it.text || src;\n          });\n        }\n\n        return item;\n      });\n      this.idArr = idArr;\n      this.datas = datas;\n    },\n    // 相册\n    scale: function scale(index, i, ra) {\n      var ablum = [];\n\n      if (i === 'baseInfo') {\n        ablum = [this.datas[index].infos.avatar.href];\n        i = 0;\n      } else if (ra === 'goods') {\n        ablum = [this.datas[index].goods.img.src];\n      } else {\n        this.datas[index].children.forEach(function (element) {\n          if (element.type !== 'text') {\n            if (element.type === 'slider') {\n              if (element.isSliderItem) {\n                ablum.push(element.img);\n              }\n            } else {\n              ablum.push(element.img);\n            }\n          }\n        });\n      }\n\n      this.ablum = {\n        ablum: ablum,\n        index: i\n      };\n    },\n    // 关闭相册\n    closeScale: function closeScale() {\n      this.ablum = null;\n    },\n    // 授权是否允许克隆\n    authClone: function authClone() {\n      var _self = this;\n\n      this.showCloneDialog = true;\n    },\n    // 保存提交\n    saveHandler: function () {\n      var _saveHandler = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3(input) {\n        var res, self;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                res = null;\n                self = this; // 生成封面\n                // let cover = await html2canvas(document.querySelector('html'))\n                // cover = cover.toDataURL('image/jpeg')\n\n                if (!this.id) {\n                  _context3.next = 14;\n                  break;\n                }\n\n                _context3.next = 6;\n                return httpService.put(\"/front/personal_page/customs/\".concat(this.id), {\n                  //   cover,\n                  title: this.pageTitle,\n                  components: this.idArr,\n                  background: this.bgcolor,\n                  content: JSON.stringify(this.datas)\n                });\n\n              case 6:\n                res = _context3.sent;\n\n                if (!(res.status !== 0)) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 9:\n                // 修改成功后操作\n                dialogService.alert('修改成功');\n                self.isSave = true;\n                self.$router.replace({\n                  path: '/webPage/mine'\n                });\n                _context3.next = 22;\n                break;\n\n              case 14:\n                _context3.next = 16;\n                return httpService.post('/front/personal_page/customs', {\n                  // cover,\n                  is_clone: input.is_clone,\n                  clone_price: input.clone_price,\n                  title: this.pageTitle,\n                  components: this.idArr,\n                  clone_id: this.cloneId,\n                  background: this.bgcolor,\n                  content: JSON.stringify(this.datas)\n                });\n\n              case 16:\n                res = _context3.sent;\n\n                if (!(res.status !== 0)) {\n                  _context3.next = 19;\n                  break;\n                }\n\n                throw new Error(res.message);\n\n              case 19:\n                self.isSave = true;\n                dialogService.alert('保存成功');\n                self.$router.replace({\n                  path: '/webPage/mine'\n                });\n\n              case 22:\n                _context3.next = 27;\n                break;\n\n              case 24:\n                _context3.prev = 24;\n                _context3.t0 = _context3[\"catch\"](0);\n                dialogService.alert(_context3.t0.message);\n\n              case 27:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 24]]);\n      }));\n\n      function saveHandler(_x) {\n        return _saveHandler.apply(this, arguments);\n      }\n\n      return saveHandler;\n    }()\n  }),\n  computed: _objectSpread({}, mapState({\n    selectShow: function selectShow(state) {\n      return state.webPage.selectShow;\n    },\n    cardInfo: function cardInfo(state) {\n      return state.webPage.cardInfo;\n    },\n    editVideo: function editVideo(state) {\n      return state.webPage.editVideo;\n    },\n    tempDatas: function tempDatas(state) {\n      return state.webPage.tempDatas;\n    },\n    videoIndex: function videoIndex(state) {\n      return state.webPage.videoIndex;\n    },\n    clonePage: function clonePage(state) {\n      return state.webPage.clonePage;\n    },\n    vuexCloneId: function vuexCloneId(state) {\n      return state.webPage.cloneId;\n    },\n    previewGoods: function previewGoods(state) {\n      return state.webPage.previewGoods;\n    },\n    user: function user(state) {\n      return state.user.userInfo;\n    }\n  })),\n  components: {\n    AppAblum: AppAblum,\n    appHeader: appHeader,\n    CloneDialog: CloneDialog,\n    CustomComponent: CustomComponent,\n    ComponentHandler: ComponentHandler,\n    Wrapper: Wrapper\n  },\n  //   beforeRouteLeave(to, from, next) {\n  //     if (to.fullPath === '/tools/personal' && this.datas.length) {\n  //       next(false)\n  //       dialogService.confirm({\n  //         msg: '您还没保存，确定要离开？',\n  //         onConfirm: function() {\n  //           eventBus.$emit('closeCropper')\n  //           next()\n  //         }\n  //       })\n  //     } else {\n  //       next()\n  //     }\n  //   }\n  beforeRouteLeave: function beforeRouteLeave(to, from, next) {\n    var that = this;\n\n    if (to.path == '/cropper') {\n      next();\n      return;\n    }\n\n    if (!this.isSave) {\n      next(false);\n      dialogService.confirm('您还没保存，确定要离开？', function (ok) {\n        if (ok) {\n          eventBus.$emit('closeCropper'); // 离开清除缓存\n\n          if (to.path !== '/cropper') {\n            that['system/updateRouter']({\n              type: 'del',\n              data: 'webPageEdit'\n            });\n          }\n\n          if (to.path == '/pay') {\n            that.$router.go(-2);\n          }\n\n          next();\n        }\n      });\n    } else {\n      // 离开清除缓存\n      if (to.path !== '/cropper') {\n        that['system/updateRouter']({\n          type: 'del',\n          data: 'webPageEdit'\n        });\n      }\n\n      if (to.path == '/pay') {\n        that.$router.go(-2);\n      }\n\n      next();\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA,OAAA,SAAA,MAAA,+BAAA;AACA,OAAA,QAAA,MAAA,uBAAA;AACA,OAAA,QAAA,MAAA,kBAAA;AACA,SAAA,QAAA,EAAA,UAAA,QAAA,MAAA;AACA,OAAA,WAAA,MAAA,uBAAA;AACA,OAAA,WAAA,MAAA,0BAAA;AACA,OAAA,aAAA,MAAA,yBAAA;AACA,OAAA,eAAA,MAAA,8BAAA;AACA,OAAA,gBAAA,MAAA,+BAAA;AACA,OAAA,OAAA,MAAA,sBAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,aADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,QAAA,EAAA,IADA;AACA;AACA,MAAA,EAAA,EAAA,IAFA;AAGA,MAAA,KAAA,EAAA,EAHA;AAGA;AACA,MAAA,KAAA,EAAA,EAJA;AAIA;AACA,MAAA,KAAA,EAAA,IALA;AAMA,MAAA,OAAA,EAAA,IANA;AAOA,MAAA,SAAA,EAAA,EAPA;AAQA,MAAA,WAAA,EAAA,IARA;AASA,MAAA,gBAAA,EAAA,IATA;AAUA,MAAA,MAAA,EAAA,IAVA;AAWA,MAAA,OAAA,EAAA,KAXA;AAWA;AACA,MAAA,QAAA,EAAA,KAZA;AAYA;AACA,MAAA,WAAA,EAAA,IAbA;AAaA;AACA,MAAA,YAAA,EAAA,IAdA;AAcA;AACA,MAAA,eAAA,EAAA,KAfA;AAeA;AACA,MAAA,OAAA,EAAA,KAAA,WAhBA;AAgBA;AACA,MAAA,MAAA,EAAA,KAjBA,CAiBA;;AAjBA,KAAA;AAmBA,GAtBA;AAuBA,EAAA,OAvBA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAwBA,cAAA,KAxBA,GAwBA,IAxBA;AAyBA,mBAAA,0BAAA,EAAA,KAAA;AACA,mBAAA,uBAAA,EAAA,IAAA;;AA1BA,mBA2BA,KAAA,MAAA,CAAA,MAAA,CAAA,EA3BA;AAAA;AAAA;AAAA;;AA4BA,mBAAA,QAAA;AA5BA;AAAA;;AAAA;AA8BA,mBAAA,WAAA;AACA,mBAAA,UAAA;;AA/BA,oBAgCA,KAAA,SAAA,KAAA,IAhCA;AAAA;AAAA;AAAA;;AAiCA,cAAA,IAjCA,GAiCA,IAAA,CAAA,KAAA,CAAA,KAAA,SAAA,CAAA,OAAA,CAjCA,EAkCA;;AACA,cAAA,OAnCA,GAmCA,IAAA,CAAA,IAAA,CAAA,UAAA,IAAA;AAAA,uBAAA,IAAA,CAAA,IAAA,KAAA,UAAA;AAAA,eAAA,CAnCA;;AAAA,mBAoCA,OApCA;AAAA;AAAA;AAAA;;AAqCA,cAAA,QArCA,GAqCA,IArCA;;AAAA,mBAsCA,KAAA,QAtCA;AAAA;AAAA;AAAA;;AAuCA,cAAA,QAAA,GAAA,KAAA,QAAA;AAvCA;AAAA;;AAAA;AAAA;AAAA,qBA0CA,WAAA,CAAA,GAAA,CAAA,aAAA,EAAA;AACA,gBAAA,OAAA,EAAA,KAAA,IAAA,CAAA;AADA,eAAA,CA1CA;;AAAA;AA0CA,cAAA,GA1CA;AA6CA,cAAA,QAAA,GAAA,GAAA,CAAA,IAAA;AACA,mBAAA,wBAAA,EAAA,GAAA,CAAA,IAAA;;AA9CA;AAgDA,cAAA,IAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,oBAAA,IAAA,CAAA,IAAA,KAAA,UAAA,EAAA;AACA,kBAAA,IAAA,CAAA,KAAA,CAAA,IAAA,GAAA,QAAA,CAAA,IAAA;AACA,kBAAA,IAAA,CAAA,KAAA,CAAA,IAAA,GAAA,QAAA,CAAA,UAAA;AACA,kBAAA,IAAA,CAAA,KAAA,CAAA,OAAA,GAAA,QAAA,CAAA,OAAA;AACA,kBAAA,IAAA,CAAA,KAAA,CAAA,MAAA,CAAA,IAAA,GAAA,QAAA,CAAA,QAAA;AACA;AACA,eAPA;;AAhDA;AAyDA,mBAAA,KAAA,GAAA,IAAA,CAzDA,CA0DA;;AACA,mBAAA,KAAA,CAAA,GAAA,CAAA,UAAA,EAAA,EAAA;AACA,oBAAA,EAAA,CAAA,IAAA,KAAA,QAAA,EAAA;AACA,kBAAA,EAAA,CAAA,QAAA,CAAA,GAAA,CAAA,UAAA,GAAA,EAAA;AACA,oBAAA,GAAA,CAAA,YAAA,GAAA,IAAA;AACA,mBAFA;AAGA;AACA,eANA;AAOA,mBAAA,SAAA,GAAA,KAAA,SAAA,CAAA,KAAA;AACA,mBAAA,OAAA,GAAA,KAAA,SAAA,CAAA,UAAA;AACA,mBAAA,WAAA,GAAA,KAAA,SAAA,CAAA,OAAA;AACA,mBAAA,KAAA,GACA,KAAA,SAAA,CAAA,UAAA,IAAA,KAAA,SAAA,CAAA,UAAA,CAAA,KAAA,CAAA,GAAA,CADA;AAEA,mBAAA,yBAAA,EAAA;AACA,gBAAA,IAAA,EAAA,OADA;AAEA,gBAAA,IAAA,EAAA;AAFA,eAAA;AAvEA;AAAA;;AAAA;AA+EA,mBAAA,YAAA,GAAA,QAAA,CAAA,eAAA,CAAA,YAAA,CA/EA,CAgFA;;AAhFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAkFA,EAAA,OAAA,oBACA,UAAA,CAAA,CACA,0BADA,EAEA,yBAFA,EAGA,yBAHA,EAIA,0BAJA,EAKA,wBALA,EAMA,uBANA,EAOA,yBAPA,EAQA,4BARA,EASA,qBATA,EAUA,sBAVA,CAAA,CADA;AAaA;AACA,IAAA,MAdA,kBAcA,KAdA,EAcA,IAdA,EAcA;AACA,UAAA,KAAA,KAAA,CAAA,KAAA,EAAA,IAAA,KAAA,UAAA,EAAA;AACA,aAAA,KAAA,CAAA,KAAA,EAAA,KAAA,CAAA,MAAA,CAAA,IAAA,GAAA,IAAA,CAAA,IAAA;AACA,OAFA,MAEA,IAAA,KAAA,KAAA,CAAA,KAAA,EAAA,IAAA,KAAA,OAAA,EAAA;AACA,aAAA,KAAA,CAAA,KAAA,EAAA,KAAA,CAAA,IAAA,CAAA,KAAA,EAAA,GAAA,CAAA,GAAA,GAAA,IAAA,CAAA,IAAA,CADA,CAEA;;AACA,aAAA,KAAA,CAAA,KAAA,EAAA,cAAA,GAAA,IAAA;AACA,OAJA,MAIA,IAAA,KAAA,KAAA,CAAA,KAAA,EAAA,IAAA,KAAA,OAAA,EAAA;AACA,aAAA,KAAA,CAAA,KAAA,EAAA,KAAA,CAAA,GAAA,CAAA,GAAA,GAAA,IAAA,CAAA,IAAA,CADA,CAEA;;AACA,aAAA,KAAA,CAAA,KAAA,EAAA,cAAA,GAAA,IAAA;AACA,OAJA,MAIA;AACA,aAAA,KAAA,CAAA,KAAA,EAAA,QAAA,CAAA,IAAA,CAAA,KAAA,EAAA,GAAA,CAAA,GAAA,GAAA,IAAA,CAAA,IAAA,CADA,CAEA;;AACA,aAAA,KAAA,CAAA,KAAA,EAAA,cAAA,GAAA,IAAA;AACA;AACA,KA9BA;AA+BA,IAAA,OA/BA,mBA+BA,MA/BA,EA+BA;AACA,UAAA,MAAA,IAAA,QAAA,EAAA;AACA,aAAA,UAAA;AACA,OAFA,MAEA,IAAA,MAAA,IAAA,MAAA,EAAA;AACA,aAAA,IAAA;AACA,OAFA,MAEA,IAAA,MAAA,IAAA,MAAA,EAAA;AACA,aAAA,OAAA,CAAA,IAAA;AACA;AACA,KAvCA;AAwCA;AACA,IAAA,WAzCA,uBAyCA,KAzCA,EAyCA;AACA,UAAA,KAAA,EAAA;AACA,YAAA,GAAA,GAAA,mCAAA;;AACA,YAAA,GAAA,CAAA,IAAA,CAAA,KAAA,MAAA,CAAA,IAAA,CAAA,EAAA;AACA,eAAA,WAAA,CAAA,KAAA;AACA,eAAA,eAAA,GAAA,KAAA;AACA,SAHA,MAGA;AACA,eAAA,WAAA,CAAA,KAAA;AACA,eAAA,eAAA,GAAA,KAAA;AACA;AACA,OATA,MASA;AACA,aAAA,eAAA,GAAA,KAAA;AACA;AACA,KAtDA;AAuDA;AACA,IAAA,WAxDA,yBAwDA;AACA,UAAA,KAAA,SAAA,EAAA;AACA,aAAA,KAAA,GAAA,KAAA,SAAA;AACA,aAAA,cAAA,CAAA,UAAA,EAAA,KAAA,UAAA;AACA,aAAA,yBAAA,EAAA,KAAA;AACA,aAAA,yBAAA,EAAA,IAAA;AACA,aAAA,0BAAA,EAAA,IAAA;AACA,eAAA,KAAA;AACA,OAPA,MAOA;AACA,eAAA,IAAA;AACA;AACA,KAnEA;AAoEA;AACA,IAAA,UArEA,wBAqEA;AACA,UAAA,KAAA,YAAA,EAAA;AACA,aAAA,KAAA,GAAA,KAAA,SAAA;AACA,aAAA,OAAA,GAAA,KAAA;AACA,aAAA,4BAAA,EAAA,KAAA;AACA,eAAA,KAAA;AACA,OALA,MAKA;AACA,eAAA,IAAA;AACA;AACA,KA9EA;AA+EA;AACA,IAAA,QAhFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiFA,qBAAA,EAAA,GAAA,KAAA,MAAA,CAAA,MAAA,CAAA,EAAA;;AAjFA,oBAkFA,KAAA,WAAA,EAlFA;AAAA;AAAA;AAAA;;AAAA,kDAmFA,KAnFA;;AAAA;AAAA,oBAqFA,KAAA,UAAA,EArFA;AAAA;AAAA;AAAA;;AAAA,kDAsFA,KAtFA;;AAAA;AAAA;AAAA;AAAA,uBAyFA,WAAA,CAAA,GAAA,wCACA,KAAA,EADA,EAzFA;;AAAA;AAyFA,gBAAA,GAzFA;;AAAA,sBA4FA,GAAA,CAAA,MAAA,KAAA,CA5FA;AAAA;AAAA;AAAA;;AAAA,sBA4FA,IAAA,KAAA,CAAA,GAAA,CAAA,OAAA,CA5FA;;AAAA;AA6FA,qBAAA,KAAA,GAAA,IAAA,CAAA,KAAA,CAAA,GAAA,CAAA,IAAA,CAAA,OAAA,CAAA,CA7FA,CA8FA;;AACA,qBAAA,KAAA,CAAA,GAAA,CAAA,UAAA,EAAA,EAAA;AACA,sBAAA,EAAA,CAAA,IAAA,KAAA,QAAA,EAAA;AACA,oBAAA,EAAA,CAAA,QAAA,CAAA,GAAA,CAAA,UAAA,GAAA,EAAA;AACA,sBAAA,GAAA,CAAA,YAAA,GAAA,IAAA;AACA,qBAFA;AAGA;AACA,iBANA;AAOA,qBAAA,SAAA,GAAA,GAAA,CAAA,IAAA,CAAA,KAAA;AACA,qBAAA,OAAA,GAAA,GAAA,CAAA,IAAA,CAAA,UAAA;AAvGA;AAAA;;AAAA;AAAA;AAAA;AAyGA,gBAAA,aAAA,CAAA,KAAA,CAAA,aAAA,OAAA;;AAzGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA4GA;AACA,IAAA,aA7GA,yBA6GA,CA7GA,EA6GA;AACA,WAAA,OAAA,GAAA,CAAA;AACA,KA/GA;AAgHA;AACA,IAAA,WAjHA,uBAiHA,CAjHA,EAiHA;AACA,WAAA,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,UAAA,mBAAA,CAAA;AACA,WAAA,OAAA,mBAAA,CAAA;AACA,KApHA;AAqHA;AACA,IAAA,UAtHA,wBAsHA;AACA,WAAA,0BAAA,EAAA,IAAA;AACA,WAAA,WAAA,GAAA,WAAA;AACA,KAzHA;AA0HA;AACA,IAAA,eA3HA,2BA2HA,IA3HA,EA2HA;AAAA;;AACA,UAAA,IAAA,CAAA,IAAA,KAAA,QAAA,EAAA;AACA,QAAA,IAAA,CAAA,QAAA,CAAA,OAAA,CAAA,UAAA,GAAA,EAAA,KAAA,EAAA;AACA,UAAA,GAAA,CAAA,YAAA,GAAA,IAAA;AACA,SAFA;AAGA;;AACA,UAAA,KAAA,QAAA,EAAA;AACA,aAAA,KAAA,CAAA,MAAA,CAAA,KAAA,QAAA,EAAA,CAAA,EAAA,IAAA;AACA,aAAA,QAAA,GAAA,IAAA;AACA,OAHA,MAGA;AACA,aAAA,KAAA,CAAA,IAAA,CAAA,IAAA;AACA;;AACA,WAAA,SAAA,CAAA,YAAA;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,gBAAA,CAAA,cAAA,CAAA,KAAA;AACA,OAFA;AAGA,KA1IA;AA2IA;AACA,IAAA,cA5IA,0BA4IA,IA5IA,EA4IA,KA5IA,EA4IA;AAAA;;AACA,UAAA,IAAA;AACA,UAAA,GAAA,GAAA,IAAA,CAAA,KAAA,CAAA,IAAA,CAAA,SAAA,CAAA,KAAA,KAAA,CAAA,CAAA;AACA,WAAA,KAAA,GAAA,EAAA;;AACA,cAAA,IAAA;AACA,aAAA,QAAA;AACA,UAAA,IAAA,GAAA,GAAA,CAAA,KAAA,GAAA,CAAA,CAAA;AACA,UAAA,GAAA,CAAA,MAAA,CAAA,KAAA,GAAA,CAAA,EAAA,CAAA,EAAA,GAAA,CAAA,KAAA,CAAA;AACA,UAAA,GAAA,CAAA,MAAA,CAAA,KAAA,EAAA,CAAA,EAAA,IAAA;AACA,UAAA,UAAA,CAAA,YAAA;AACA,YAAA,MAAA,CAAA,KAAA,GAAA,GAAA;AACA,WAFA,CAAA;AAGA;;AACA,aAAA,UAAA;AACA,UAAA,IAAA,GAAA,GAAA,CAAA,KAAA,GAAA,CAAA,CAAA;AACA,UAAA,GAAA,CAAA,MAAA,CAAA,KAAA,GAAA,CAAA,EAAA,CAAA,EAAA,GAAA,CAAA,KAAA,CAAA;AACA,UAAA,GAAA,CAAA,MAAA,CAAA,KAAA,EAAA,CAAA,EAAA,IAAA;AACA,UAAA,UAAA,CAAA,YAAA;AACA,YAAA,MAAA,CAAA,KAAA,GAAA,GAAA;AACA,WAFA,CAAA;AAGA;;AACA,aAAA,cAAA;AACA,eAAA,QAAA,GAAA,KAAA,GAAA,CAAA;AACA,eAAA,UAAA;AACA,UAAA,UAAA,CAAA,YAAA;AACA,YAAA,MAAA,CAAA,KAAA,GAAA,GAAA;AACA,WAFA,CAAA;AAGA;;AACA,aAAA,QAAA;AACA,UAAA,GAAA,CAAA,MAAA,CAAA,KAAA,EAAA,CAAA;AACA,UAAA,UAAA,CAAA,YAAA;AACA,YAAA,MAAA,CAAA,KAAA,GAAA,GAAA;AACA,WAFA,CAAA;AAGA;;AACA,aAAA,cAAA;AACA,eAAA,0BAAA,EAAA,IAAA;AACA,eAAA,WAAA,GAAA,QAAA;AACA,eAAA,gBAAA,GAAA,GAAA,CAAA,KAAA,CAAA;AACA,eAAA,MAAA,GAAA,KAAA;AACA,eAAA,KAAA,GAAA,GAAA;AACA;;AACA,aAAA,cAAA;AACA,eAAA,0BAAA,EAAA,IAAA;AACA,eAAA,WAAA,GAAA,WAAA;AACA,eAAA,MAAA,GAAA,KAAA;AACA,eAAA,gBAAA,GAAA,GAAA,CAAA,KAAA,CAAA;AACA,eAAA,KAAA,GAAA,GAAA;AACA;;AACA,aAAA,UAAA;AACA,eAAA,0BAAA,EAAA,IAAA;AACA,eAAA,WAAA,GAAA,OAAA;AACA,eAAA,gBAAA,GAAA,GAAA,CAAA,KAAA,CAAA;AACA,eAAA,MAAA,GAAA,KAAA;AACA,eAAA,KAAA,GAAA,GAAA;AACA;;AACA,gBAnDA,CAoDA;;AApDA;AAsDA,KAtMA;AAuMA;AACA,IAAA,aAxMA,yBAwMA,KAxMA,EAwMA,IAxMA,EAwMA;AACA,WAAA,KAAA,CAAA,MAAA,CAAA,KAAA,EAAA,CAAA,EAAA,IAAA;AACA,KA1MA;AA2MA;AACA,IAAA,SA5MA,qBA4MA,KA5MA,EA4MA,CA5MA,EA4MA;AACA,WAAA,KAAA,CAAA,KAAA,EAAA,QAAA,CAAA,CAAA,EAAA,GAAA,CAAA,GAAA,GAAA,EAAA;AACA,KA9MA;AA+MA;AACA,IAAA,UAhNA,wBAgNA;AAAA;;AACA,UAAA,KAAA,KAAA,CAAA,MAAA,KAAA,CAAA,EAAA;AACA,QAAA,aAAA,CAAA,KAAA,CAAA,WAAA;AACA;AACA;;AACA,UAAA,KAAA,OAAA,EAAA;AACA,aAAA,WAAA;AACA,OAFA,MAEA;AACA,aAAA,KAAA,GAAA,KAAA,KAAA,CAAA,GAAA,CAAA,UAAA,IAAA,EAAA;AACA,UAAA,IAAA,CAAA,MAAA,GAAA,IAAA;;AACA,cAAA,IAAA,CAAA,IAAA,KAAA,QAAA,EAAA;AACA,YAAA,IAAA,CAAA,QAAA,CAAA,OAAA,CAAA,UAAA,GAAA,EAAA,KAAA,EAAA;AACA,cAAA,GAAA,CAAA,YAAA,GAAA,IAAA;AACA,aAFA;AAGA;;AACA,iBAAA,IAAA;AACA,SARA,CAAA;AASA;;AACA,UAAA,IAAA,GAAA,IAAA,CAAA,KAAA,CAAA,IAAA,CAAA,SAAA,CAAA,KAAA,KAAA,CAAA,CAAA;AACA,WAAA,KAAA,GAAA,EAAA;AACA,MAAA,UAAA,CAAA,YAAA;AACA,QAAA,MAAA,CAAA,KAAA,GAAA,IAAA;AACA,OAFA,CAAA;AAGA,WAAA,OAAA,GAAA,CAAA,KAAA,OAAA;AACA,KAxOA;AAyOA;AACA,IAAA,IA1OA,kBA0OA;AACA,UAAA,IAAA,GAAA,IAAA;AACA,UAAA,IAAA,GAAA,KAAA;AACA,WAAA,WAAA;AACA,MAAA,IAAA,GAAA,KAAA,KAAA,CAAA,IAAA,CAAA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,MAAA;AAAA,OAAA,CAAA;;AACA,UAAA,KAAA,KAAA,CAAA,MAAA,GAAA,CAAA,IAAA,CAAA,IAAA,EAAA;AACA,aAAA,KAAA,CAAA,GAAA,CAAA,UAAA,EAAA,EAAA;AACA,cAAA,EAAA,CAAA,IAAA,KAAA,QAAA,EAAA;AACA,YAAA,EAAA,CAAA,QAAA,CAAA,GAAA,CAAA,UAAA,GAAA,EAAA;AACA,cAAA,GAAA,CAAA,YAAA,GAAA,IAAA;AACA,aAFA;AAGA;AACA,SANA;AAOA,QAAA,aAAA,CAAA,KAAA,CAAA,OAAA;AACA;AACA,OAVA,MAUA,IAAA,KAAA,SAAA,CAAA,MAAA,KAAA,CAAA,EAAA;AACA,QAAA,aAAA,CAAA,KAAA,CAAA,SAAA;AACA;AACA,OAHA,MAGA,CAEA,CALA,CAIA;AAEA;;;AACA,UAAA,CAAA,KAAA,EAAA,EAAA;AACA,aAAA,SAAA;AACA,OAFA,MAEA;AACA,aAAA,WAAA;AACA;AACA,KArQA;AAsQA;AACA,IAAA,WAvQA,yBAuQA;AACA,UAAA,KAAA,GAAA,EAAA;AACA,UAAA,KAAA,GAAA,KAAA,KAAA,CAAA,GAAA,CAAA,UAAA,IAAA,EAAA;AACA,QAAA,KAAA,CAAA,IAAA,CAAA,IAAA,CAAA,EAAA;;AACA,YAAA,IAAA,CAAA,IAAA,KAAA,OAAA,EAAA;AACA,UAAA,IAAA,CAAA,MAAA,GAAA,IAAA,CAAA,KAAA,IAAA,IAAA,CAAA,QAAA;AACA,SAFA,MAEA,IAAA,IAAA,CAAA,IAAA,KAAA,UAAA,EAAA;AACA,UAAA,IAAA,CAAA,MAAA,GACA,IAAA,CAAA,KAAA,CAAA,IAAA,IACA,IAAA,CAAA,KAAA,CAAA,IADA,IAEA,IAAA,CAAA,KAAA,CAAA,MAAA,CAAA,IAFA,IAGA,IAAA,CAAA,KAAA,CAAA,OAJA;AAKA,SANA,MAMA,IAAA,IAAA,CAAA,IAAA,KAAA,MAAA,EAAA;AACA,UAAA,IAAA,CAAA,MAAA,GAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA,UAAA,EAAA,EAAA;AACA,mBAAA,EAAA,CAAA,IAAA;AACA,WAFA,CAAA;AAGA,SAJA,MAIA,IAAA,IAAA,CAAA,IAAA,KAAA,QAAA,EAAA;AACA,UAAA,IAAA,CAAA,QAAA,CAAA,OAAA,CAAA,UAAA,GAAA,EAAA,KAAA,EAAA;AACA,YAAA,GAAA,CAAA,YAAA,GAAA,CAAA,GAAA,CAAA,GAAA,CAAA,GAAA,GAAA,KAAA,GAAA,IAAA;AACA,WAFA;AAGA,UAAA,IAAA,CAAA,MAAA,GAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA,UAAA,EAAA,EAAA;AACA,mBAAA,EAAA,CAAA,GAAA,CAAA,GAAA;AACA,WAFA,CAAA;AAGA,SAPA,MAOA,IAAA,IAAA,CAAA,IAAA,KAAA,OAAA,EAAA;AACA,UAAA,IAAA,CAAA,MAAA,GAAA,IAAA,CAAA,KAAA,CAAA,IAAA,CAAA,UAAA,EAAA,EAAA;AACA;AACA,gBAAA,GAAA,GAAA,EAAA,CAAA,GAAA,CAAA,GAAA;AACA,mBAAA,EAAA,CAAA,KAAA,IAAA,EAAA,CAAA,QAAA,IAAA,EAAA,CAAA,SAAA,IAAA,GAAA;AACA,WAJA,CAAA;AAKA,SANA,MAMA,IAAA,IAAA,CAAA,IAAA,KAAA,OAAA,EAAA;AACA,UAAA,IAAA,CAAA,MAAA,GACA,IAAA,CAAA,KAAA,CAAA,KAAA,IAAA,IAAA,CAAA,KAAA,CAAA,OAAA,IAAA,IAAA,CAAA,KAAA,CAAA,GAAA,CAAA,GADA;AAEA,SAHA,MAGA;AACA,UAAA,IAAA,CAAA,MAAA,GAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA,UAAA,EAAA,EAAA;AACA;AACA,gBAAA,GAAA,GAAA,EAAA,CAAA,GAAA,GAAA,EAAA,CAAA,GAAA,CAAA,GAAA,GAAA,EAAA,CAAA,GAAA;AACA,mBAAA,EAAA,CAAA,IAAA,IAAA,GAAA;AACA,WAJA,CAAA;AAKA;;AACA,eAAA,IAAA;AACA,OAtCA,CAAA;AAuCA,WAAA,KAAA,GAAA,KAAA;AACA,WAAA,KAAA,GAAA,KAAA;AACA,KAlTA;AAmTA;AACA,IAAA,KApTA,iBAoTA,KApTA,EAoTA,CApTA,EAoTA,EApTA,EAoTA;AACA,UAAA,KAAA,GAAA,EAAA;;AACA,UAAA,CAAA,KAAA,UAAA,EAAA;AACA,QAAA,KAAA,GAAA,CAAA,KAAA,KAAA,CAAA,KAAA,EAAA,KAAA,CAAA,MAAA,CAAA,IAAA,CAAA;AACA,QAAA,CAAA,GAAA,CAAA;AACA,OAHA,MAGA,IAAA,EAAA,KAAA,OAAA,EAAA;AACA,QAAA,KAAA,GAAA,CAAA,KAAA,KAAA,CAAA,KAAA,EAAA,KAAA,CAAA,GAAA,CAAA,GAAA,CAAA;AACA,OAFA,MAEA;AACA,aAAA,KAAA,CAAA,KAAA,EAAA,QAAA,CAAA,OAAA,CAAA,UAAA,OAAA,EAAA;AACA,cAAA,OAAA,CAAA,IAAA,KAAA,MAAA,EAAA;AACA,gBAAA,OAAA,CAAA,IAAA,KAAA,QAAA,EAAA;AACA,kBAAA,OAAA,CAAA,YAAA,EAAA;AACA,gBAAA,KAAA,CAAA,IAAA,CAAA,OAAA,CAAA,GAAA;AACA;AACA,aAJA,MAIA;AACA,cAAA,KAAA,CAAA,IAAA,CAAA,OAAA,CAAA,GAAA;AACA;AACA;AACA,SAVA;AAWA;;AACA,WAAA,KAAA,GAAA;AACA,QAAA,KAAA,EAAA,KADA;AAEA,QAAA,KAAA,EAAA;AAFA,OAAA;AAIA,KA5UA;AA6UA;AACA,IAAA,UA9UA,wBA8UA;AACA,WAAA,KAAA,GAAA,IAAA;AACA,KAhVA;AAiVA;AACA,IAAA,SAlVA,uBAkVA;AACA,UAAA,KAAA,GAAA,IAAA;;AACA,WAAA,eAAA,GAAA,IAAA;AACA,KArVA;AAsVA;AACA,IAAA,WAvVA;AAAA;AAAA;AAAA,gDAuVA,KAvVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAyVA,gBAAA,GAzVA,GAyVA,IAzVA;AA0VA,gBAAA,IA1VA,GA0VA,IA1VA,EA2VA;AACA;AACA;;AA7VA,qBA+VA,KAAA,EA/VA;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAgWA,WAAA,CAAA,GAAA,wCACA,KAAA,EADA,GAEA;AACA;AACA,kBAAA,KAAA,EAAA,KAAA,SAFA;AAGA,kBAAA,UAAA,EAAA,KAAA,KAHA;AAIA,kBAAA,UAAA,EAAA,KAAA,OAJA;AAKA,kBAAA,OAAA,EAAA,IAAA,CAAA,SAAA,CAAA,KAAA,KAAA;AALA,iBAFA,CAhWA;;AAAA;AAgWA,gBAAA,GAhWA;;AAAA,sBA0WA,GAAA,CAAA,MAAA,KAAA,CA1WA;AAAA;AAAA;AAAA;;AAAA,sBA0WA,IAAA,KAAA,CAAA,GAAA,CAAA,OAAA,CA1WA;;AAAA;AA2WA;AACA,gBAAA,aAAA,CAAA,KAAA,CAAA,MAAA;AACA,gBAAA,IAAA,CAAA,MAAA,GAAA,IAAA;AACA,gBAAA,IAAA,CAAA,OAAA,CAAA,OAAA,CAAA;AACA,kBAAA,IAAA,EAAA;AADA,iBAAA;AA9WA;AAAA;;AAAA;AAAA;AAAA,uBAkXA,WAAA,CAAA,IAAA,CAAA,8BAAA,EAAA;AACA;AACA,kBAAA,QAAA,EAAA,KAAA,CAAA,QAFA;AAGA,kBAAA,WAAA,EAAA,KAAA,CAAA,WAHA;AAIA,kBAAA,KAAA,EAAA,KAAA,SAJA;AAKA,kBAAA,UAAA,EAAA,KAAA,KALA;AAMA,kBAAA,QAAA,EAAA,KAAA,OANA;AAOA,kBAAA,UAAA,EAAA,KAAA,OAPA;AAQA,kBAAA,OAAA,EAAA,IAAA,CAAA,SAAA,CAAA,KAAA,KAAA;AARA,iBAAA,CAlXA;;AAAA;AAkXA,gBAAA,GAlXA;;AAAA,sBA4XA,GAAA,CAAA,MAAA,KAAA,CA5XA;AAAA;AAAA;AAAA;;AAAA,sBA4XA,IAAA,KAAA,CAAA,GAAA,CAAA,OAAA,CA5XA;;AAAA;AA6XA,gBAAA,IAAA,CAAA,MAAA,GAAA,IAAA;AACA,gBAAA,aAAA,CAAA,KAAA,CAAA,MAAA;AACA,gBAAA,IAAA,CAAA,OAAA,CAAA,OAAA,CAAA;AACA,kBAAA,IAAA,EAAA;AADA,iBAAA;;AA/XA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAoYA,gBAAA,aAAA,CAAA,KAAA,CAAA,aAAA,OAAA;;AApYA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,IAlFA;AA0dA,EAAA,QAAA,oBACA,QAAA,CAAA;AACA,IAAA,UAAA,EAAA,oBAAA,KAAA;AAAA,aAAA,KAAA,CAAA,OAAA,CAAA,UAAA;AAAA,KADA;AAEA,IAAA,QAAA,EAAA,kBAAA,KAAA;AAAA,aAAA,KAAA,CAAA,OAAA,CAAA,QAAA;AAAA,KAFA;AAGA,IAAA,SAAA,EAAA,mBAAA,KAAA;AAAA,aAAA,KAAA,CAAA,OAAA,CAAA,SAAA;AAAA,KAHA;AAIA,IAAA,SAAA,EAAA,mBAAA,KAAA;AAAA,aAAA,KAAA,CAAA,OAAA,CAAA,SAAA;AAAA,KAJA;AAKA,IAAA,UAAA,EAAA,oBAAA,KAAA;AAAA,aAAA,KAAA,CAAA,OAAA,CAAA,UAAA;AAAA,KALA;AAMA,IAAA,SAAA,EAAA,mBAAA,KAAA;AAAA,aAAA,KAAA,CAAA,OAAA,CAAA,SAAA;AAAA,KANA;AAOA,IAAA,WAAA,EAAA,qBAAA,KAAA;AAAA,aAAA,KAAA,CAAA,OAAA,CAAA,OAAA;AAAA,KAPA;AAQA,IAAA,YAAA,EAAA,sBAAA,KAAA;AAAA,aAAA,KAAA,CAAA,OAAA,CAAA,YAAA;AAAA,KARA;AASA,IAAA,IAAA,EAAA,cAAA,KAAA;AAAA,aAAA,KAAA,CAAA,IAAA,CAAA,QAAA;AAAA;AATA,GAAA,CADA,CA1dA;AAueA,EAAA,UAAA,EAAA;AACA,IAAA,QAAA,EAAA,QADA;AAEA,IAAA,SAAA,EAAA,SAFA;AAGA,IAAA,WAAA,EAAA,WAHA;AAIA,IAAA,eAAA,EAAA,eAJA;AAKA,IAAA,gBAAA,EAAA,gBALA;AAMA,IAAA,OAAA,EAAA;AANA,GAveA;AA+eA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAA,gBA7fA,4BA6fA,EA7fA,EA6fA,IA7fA,EA6fA,IA7fA,EA6fA;AACA,QAAA,IAAA,GAAA,IAAA;;AACA,QAAA,EAAA,CAAA,IAAA,IAAA,UAAA,EAAA;AACA,MAAA,IAAA;AACA;AACA;;AACA,QAAA,CAAA,KAAA,MAAA,EAAA;AACA,MAAA,IAAA,CAAA,KAAA,CAAA;AACA,MAAA,aAAA,CAAA,OAAA,CAAA,cAAA,EAAA,UAAA,EAAA,EAAA;AACA,YAAA,EAAA,EAAA;AACA,UAAA,QAAA,CAAA,KAAA,CAAA,cAAA,EADA,CAEA;;AACA,cAAA,EAAA,CAAA,IAAA,KAAA,UAAA,EAAA;AACA,YAAA,IAAA,CAAA,qBAAA,CAAA,CAAA;AACA,cAAA,IAAA,EAAA,KADA;AAEA,cAAA,IAAA,EAAA;AAFA,aAAA;AAIA;;AACA,cAAA,EAAA,CAAA,IAAA,IAAA,MAAA,EAAA;AACA,YAAA,IAAA,CAAA,OAAA,CAAA,EAAA,CAAA,CAAA,CAAA;AACA;;AACA,UAAA,IAAA;AACA;AACA,OAfA;AAgBA,KAlBA,MAkBA;AACA;AACA,UAAA,EAAA,CAAA,IAAA,KAAA,UAAA,EAAA;AACA,QAAA,IAAA,CAAA,qBAAA,CAAA,CAAA;AACA,UAAA,IAAA,EAAA,KADA;AAEA,UAAA,IAAA,EAAA;AAFA,SAAA;AAIA;;AACA,UAAA,EAAA,CAAA,IAAA,IAAA,MAAA,EAAA;AACA,QAAA,IAAA,CAAA,OAAA,CAAA,EAAA,CAAA,CAAA,CAAA;AACA;;AACA,MAAA,IAAA;AACA;AACA;AAliBA,CAAA","sourcesContent":["<template>\n\n  <Wrapper>\n    <appHeader @actions=\"actions\" :canEdit=\"canEdit\" ref=\"header\"></appHeader>\n    <div class=\"custom-wrapper\" ref=\"customWrapper\" :style=\"'background:'+bgcolor\">\n      <div class=\"custom-content\" ref=\"customComponents\">\n        <div @click.stop=\"isSample=true\" class=\"samples\" v-if=\"canEdit\"><i class=\"iconfont icon-shipin1\"></i>教程</div>\n        <div class=\"title-wrapper\" v-if=\"canEdit\">\n          <p class=\"tName\">网页名称：</p>\n          <input type=\"text\" v-model=\"pageTitle\" placeholder=\"给你的新网页取一个名称\" maxlength=\"16\">\n        </div>\n        <template v-for=\"(item, index) in datas\">\n          <CustomComponent v-if=\"item.isShow||canEdit\" :key=\"index\" :index=\"index\" :datalen=\"datas.length\" :item=\"item\" :canEdit=\"canEdit\" @upload=\"upload(index,$event)\"></CustomComponent>\n        </template>\n        <!-- <div class=\"add-template\" @click=\"showSelect()\" v-if=\"datas.length===0\">\n          <a @click.stop=\"isSample=true\">示例</a>\n          <div>\n            <img src=\"./text.png\" alt=\"\">\n            <p>点击添加模块</p>\n          </div>\n        </div> -->\n      </div>\n    </div>\n    <div class=\"custom-round\" v-if=\"canEdit\" @click=\"showSelect()\" ref=\"footer\"><i class=\"iconfont icon-hao\"></i></div>\n    <!-- 半圆，工具图片 -->\n    <ComponentHandler v-show=\"selectShow\" :type=\"operateType\" :item=\"operateComponent\" :indexa=\"indexa\" :url=\"bgcolor\"></ComponentHandler>\n    <AppAblum v-if=\"ablum\" :data=\"ablum\" @close=\"closeScale\"></AppAblum>\n    <CloneDialog v-if=\"showCloneDialog\" @closeHandle=\"closeHandle\"></CloneDialog>\n    <div class=\"sample\" v-if=\"isSample\">\n      <i class=\"iconfont icon-bianjiyemianshanchu\" @click=\"isSample=false\"></i>\n      <img src=\"./2.png\" alt=\"\" style=\"width:100%;\">\n    </div>\n  </Wrapper>\n\n</template>\n\n<script>\n// import html2canvas from 'html2canvas'\nimport appHeader from '../components/appHeader/index'\nimport AppAblum from '@/components/AppAblum'\nimport eventBus from '@/utils/eventBus'\nimport { mapState, mapActions } from 'vuex'\nimport httpService from '@/service/httpService'\nimport CloneDialog from '@/components/CloneDialog'\nimport dialogService from '@/service/dialogService'\nimport CustomComponent from '@/components/CustomComponent'\nimport ComponentHandler from '@/components/ComponentHandler'\nimport Wrapper from '@/components/Wrapper'\n\nexport default {\n  name: 'webPageEdit',\n  data() {\n    return {\n      addIndex: null, // 添加组件到指定位置\n      id: null,\n      idArr: [], //\n      datas: [], //clonePage的content\n      ablum: null,\n      canEdit: true,\n      pageTitle: '',\n      operateType: null,\n      operateComponent: null,\n      indexa: null,\n      bgcolor: 'fff', // 背景颜色\n      isSample: false, // 是否显示示列\n      cloneUserId: null, // 克隆模板主人id\n      windowHeight: null, // offsetHeight\n      showCloneDialog: false, // 是否显示克隆设置\n      cloneId: this.vuexCloneId, // 克隆id\n      isSave: false //提示还没保存\n    }\n  },\n  async mounted() {\n    let _self = this\n    this['webPage/updateSelectShow'](false)\n    this['webPage/updateCloneId'](null)\n    if (this.$route.params.id) {\n      this.editInit()\n    } else {\n      this.isEditVideo()\n      this.isPurchase()\n      if (this.clonePage !== null) {\n        let data = JSON.parse(this.clonePage.content)\n        // 如果数据中包含了名片信息，则替换名片信息\n        let hasCard = data.some(item => item.type === 'baseInfo')\n        if (hasCard) {\n          let cardInfo = null\n          if (this.cardInfo) {\n            cardInfo = this.cardInfo\n          } else {\n            // 获取名片信息\n            let res = await httpService.get('/front/card', {\n              user_id: this.user.id\n            })\n            cardInfo = res.data\n            this['webPage/updateCardInfo'](res.data)\n          }\n          data.forEach(item => {\n            if (item.type === 'baseInfo') {\n              item.infos.name = cardInfo.name\n              item.infos.jobs = cardInfo.profession\n              item.infos.company = cardInfo.company\n              item.infos.avatar.href = cardInfo.portrait\n            }\n          })\n        }\n        this.datas = data\n        // 解决修改已保存的自定义网页时，没上传6张图片时没显示6个点的问题\n        this.datas.map(el => {\n          if (el.type === 'slider') {\n            el.children.map(ele => {\n              ele.isSliderItem = true\n            })\n          }\n        })\n        this.pageTitle = this.clonePage.title\n        this.bgcolor = this.clonePage.background\n        this.cloneUserId = this.clonePage.user_id\n        this.idArr =\n          this.clonePage.components && this.clonePage.components.split(',')\n        this['webPage/updateClonePage']({\n          type: 'clean',\n          data: {}\n        })\n      } else {\n        // nothing\n      }\n    }\n    this.windowHeight = document.documentElement.offsetHeight\n    // window.addEventListener('resize', this.onResize)\n  },\n  methods: {\n    ...mapActions([\n      'webPage/updateSelectShow',\n      'webPage/updateEditVideo',\n      'webPage/updateTempDatas',\n      'webPage/updateVideoIndex',\n      'webPage/updateCardInfo',\n      'webPage/updateCloneId',\n      'webPage/updateClonePage',\n      'webPage/updatePreviewGoods',\n      'system/updateRouter',\n      'system/updateCropper'\n    ]),\n    // 新上传图片\n    upload(index, data) {\n      if (this.datas[index].type === 'baseInfo') {\n        this.datas[index].infos.avatar.href = data.path\n      } else if (this.datas[index].type === 'goods') {\n        this.datas[index].goods[data.index].img.src = data.path\n        // 解决没有添加图片就不可以添加超链接\n        this.datas[index].isAddSuperLink = true\n      } else if (this.datas[index].type === 'video') {\n        this.datas[index].video.img.src = data.path\n        // 解决没有添加图片就不可以添加超链接\n        this.datas[index].isAddSuperLink = true\n      } else {\n        this.datas[index].children[data.index].img.src = data.path\n        // 解决没有添加图片就不可以添加超链接\n        this.datas[index].isAddSuperLink = true\n      }\n    },\n    actions(action) {\n      if (action == 'review') {\n        this.toggleEdit()\n      } else if (action == 'save') {\n        this.save()\n      } else if (action == 'back') {\n        this.$router.back()\n      }\n    },\n    // 克隆弹出层\n    closeHandle(input) {\n      if (input) {\n        let reg = /\\/tools\\/personal\\/customTemplate/\n        if (reg.test(this.$route.path)) {\n          this.saveHandler(input)\n          this.showCloneDialog = false\n        } else {\n          this.saveHandler(input)\n          this.showCloneDialog = false\n        }\n      } else {\n        this.showCloneDialog = false\n      }\n    },\n    // 判断是否处于编辑视频状态\n    isEditVideo() {\n      if (this.editVideo) {\n        this.datas = this.tempDatas\n        this.childOperation('addVideo', this.videoIndex)\n        this['webPage/updateEditVideo'](false)\n        this['webPage/updateTempDatas'](null)\n        this['webPage/updateVideoIndex'](null)\n        return false\n      } else {\n        return true\n      }\n    },\n    // 判断是否点击立即购买\n    isPurchase() {\n      if (this.previewGoods) {\n        this.datas = this.tempDatas\n        this.canEdit = false\n        this['webPage/updatePreviewGoods'](false)\n        return false\n      } else {\n        return true\n      }\n    },\n    // 如果是编辑的情况\n    async editInit() {\n      this.id = this.$route.params.id\n      if (!this.isEditVideo()) {\n        return false\n      }\n      if (!this.isPurchase()) {\n        return false\n      }\n      try {\n        let res = await httpService.get(\n          `/front/personal_page/customs/${this.id}`\n        )\n        if (res.status !== 0) throw new Error(res.message)\n        this.datas = JSON.parse(res.data.content)\n        // 解决修改已保存的自定义网页时，没上传6张图片时没显示6个点的问题\n        this.datas.map(el => {\n          if (el.type === 'slider') {\n            el.children.map(ele => {\n              ele.isSliderItem = true\n            })\n          }\n        })\n        this.pageTitle = res.data.title\n        this.bgcolor = res.data.background\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    },\n    // 改变背景颜色\n    changebgcolor(x) {\n      this.bgcolor = x\n    },\n    // 改变背景颜色\n    changebgpic(x) {\n      this.$refs.customWrapper.style.background = `url(' ${x} ') no-repeat fixed center / 100% 100%`\n      this.bgcolor = `url(' ${x} ') no-repeat fixed center / 100% 100%`\n    },\n    // 显示组件选择\n    showSelect() {\n      this['webPage/updateSelectShow'](true)\n      this.operateType = 'component'\n    },\n    // 子组件添加一个组件\n    selectComponent(item) {\n      if (item.type === 'slider') {\n        item.children.forEach((ele, index) => {\n          ele.isSliderItem = true\n        })\n      }\n      if (this.addIndex) {\n        this.datas.splice(this.addIndex, 0, item)\n        this.addIndex = null\n      } else {\n        this.datas.push(item)\n      }\n      this.$nextTick(() => {\n        this.$refs.customComponents.scrollIntoView(false)\n      })\n    },\n    // 子组件的操作[上移、下移、删除、置顶、切换布局、添加超链接]\n    childOperation(type, index) {\n      let temp\n      let arr = JSON.parse(JSON.stringify(this.datas))\n      this.datas = []\n      switch (type) {\n        case 'moveUp':\n          temp = arr[index - 1]\n          arr.splice(index - 1, 1, arr[index])\n          arr.splice(index, 1, temp)\n          setTimeout(() => {\n            this.datas = arr\n          })\n          break\n        case 'moveDown':\n          temp = arr[index + 1]\n          arr.splice(index + 1, 1, arr[index])\n          arr.splice(index, 1, temp)\n          setTimeout(() => {\n            this.datas = arr\n          })\n          break\n        case 'addComponent':\n          this.addIndex = index + 1\n          this.showSelect()\n          setTimeout(() => {\n            this.datas = arr\n          })\n          break\n        case 'delete':\n          arr.splice(index, 1)\n          setTimeout(() => {\n            this.datas = arr\n          })\n          break\n        case 'toggleLayout':\n          this['webPage/updateSelectShow'](true)\n          this.operateType = 'layout'\n          this.operateComponent = arr[index]\n          this.indexa = index\n          this.datas = arr\n          break\n        case 'addSuperLink':\n          this['webPage/updateSelectShow'](true)\n          this.operateType = 'superLink'\n          this.indexa = index\n          this.operateComponent = arr[index]\n          this.datas = arr\n          break\n        case 'addVideo':\n          this['webPage/updateSelectShow'](true)\n          this.operateType = 'video'\n          this.operateComponent = arr[index]\n          this.indexa = index\n          this.datas = arr\n          break\n        default:\n        // nothing\n      }\n    },\n    // 子组件调用，内容修改（包含切换布局和添加链接）\n    editComponent(index, item) {\n      this.datas.splice(index, 1, item)\n    },\n    // 删除swiper图\n    delswiper(index, i) {\n      this.datas[index].children[i].img.src = ''\n    },\n    // 预览\n    toggleEdit() {\n      if (this.datas.length === 0) {\n        dialogService.alert('未添加编辑模块内容')\n        return\n      }\n      if (this.canEdit) {\n        this.dataTurnFun()\n      } else {\n        this.datas = this.datas.map(item => {\n          item.isShow = true\n          if (item.type === 'slider') {\n            item.children.forEach((ele, index) => {\n              ele.isSliderItem = true\n            })\n          }\n          return item\n        })\n      }\n      let temp = JSON.parse(JSON.stringify(this.datas))\n      this.datas = []\n      setTimeout(() => {\n        this.datas = temp\n      })\n      this.canEdit = !this.canEdit\n    },\n    // 保存\n    save() {\n      let self = this\n      let flag = false\n      this.dataTurnFun()\n      flag = this.datas.some(item => item.isShow)\n      if (this.datas.length < 1 || !flag) {\n        this.datas.map(el => {\n          if (el.type === 'slider') {\n            el.children.map(ele => {\n              ele.isSliderItem = true\n            })\n          }\n        })\n        dialogService.alert('请填写内容')\n        return\n      } else if (this.pageTitle.length === 0) {\n        dialogService.alert('请输入网页名称')\n        return\n      } else {\n        // nothing\n      }\n      // 判断是否允许克隆\n      if (!this.id) {\n        this.authClone()\n      } else {\n        this.saveHandler()\n      }\n    },\n    // 数据校验、不填写的数据不显示\n    dataTurnFun() {\n      let idArr = []\n      let datas = this.datas.map(item => {\n        idArr.push(item.id)\n        if (item.type === 'title') {\n          item.isShow = item.title || item.subTitle\n        } else if (item.type === 'baseInfo') {\n          item.isShow =\n            item.infos.name ||\n            item.infos.jobs ||\n            item.infos.avatar.href ||\n            item.infos.company\n        } else if (item.type === 'text') {\n          item.isShow = item.children.some(it => {\n            return it.text\n          })\n        } else if (item.type === 'slider') {\n          item.children.forEach((ele, index) => {\n            ele.isSliderItem = !ele.img.src ? false : true\n          })\n          item.isShow = item.children.some(it => {\n            return it.img.src\n          })\n        } else if (item.type === 'goods') {\n          item.isShow = item.goods.some(it => {\n            // 解决只有it.type = 'text' 时img为null没有it.img.src就会报错\n            let src = it.img.src\n            return it.title || it.lowPrice || it.highPrice || src\n          })\n        } else if (item.type === 'video') {\n          item.isShow =\n            item.video.title || item.video.content || item.video.img.src\n        } else {\n          item.isShow = item.children.some(it => {\n            // 解决只有it.type = 'text' 时img为null没有it.img.src就会报错\n            let src = it.img ? it.img.src : it.img\n            return it.text || src\n          })\n        }\n        return item\n      })\n      this.idArr = idArr\n      this.datas = datas\n    },\n    // 相册\n    scale(index, i, ra) {\n      let ablum = []\n      if (i === 'baseInfo') {\n        ablum = [this.datas[index].infos.avatar.href]\n        i = 0\n      } else if (ra === 'goods') {\n        ablum = [this.datas[index].goods.img.src]\n      } else {\n        this.datas[index].children.forEach(element => {\n          if (element.type !== 'text') {\n            if (element.type === 'slider') {\n              if (element.isSliderItem) {\n                ablum.push(element.img)\n              }\n            } else {\n              ablum.push(element.img)\n            }\n          }\n        })\n      }\n      this.ablum = {\n        ablum: ablum,\n        index: i\n      }\n    },\n    // 关闭相册\n    closeScale() {\n      this.ablum = null\n    },\n    // 授权是否允许克隆\n    authClone() {\n      let _self = this\n      this.showCloneDialog = true\n    },\n    // 保存提交\n    async saveHandler(input) {\n      try {\n        let res = null\n        let self = this\n        // 生成封面\n        // let cover = await html2canvas(document.querySelector('html'))\n        // cover = cover.toDataURL('image/jpeg')\n\n        if (this.id) {\n          res = await httpService.put(\n            `/front/personal_page/customs/${this.id}`,\n            {\n              //   cover,\n              title: this.pageTitle,\n              components: this.idArr,\n              background: this.bgcolor,\n              content: JSON.stringify(this.datas)\n            }\n          )\n          if (res.status !== 0) throw new Error(res.message)\n          // 修改成功后操作\n          dialogService.alert('修改成功')\n          self.isSave = true\n          self.$router.replace({\n            path: '/webPage/mine'\n          })\n        } else {\n          res = await httpService.post('/front/personal_page/customs', {\n            // cover,\n            is_clone: input.is_clone,\n            clone_price: input.clone_price,\n            title: this.pageTitle,\n            components: this.idArr,\n            clone_id: this.cloneId,\n            background: this.bgcolor,\n            content: JSON.stringify(this.datas)\n          })\n          if (res.status !== 0) throw new Error(res.message)\n          self.isSave = true\n          dialogService.alert('保存成功')\n          self.$router.replace({\n            path: '/webPage/mine'\n          })\n        }\n      } catch (err) {\n        dialogService.alert(err.message)\n      }\n    }\n  },\n  computed: {\n    ...mapState({\n      selectShow: state => state.webPage.selectShow,\n      cardInfo: state => state.webPage.cardInfo,\n      editVideo: state => state.webPage.editVideo,\n      tempDatas: state => state.webPage.tempDatas,\n      videoIndex: state => state.webPage.videoIndex,\n      clonePage: state => state.webPage.clonePage,\n      vuexCloneId: state => state.webPage.cloneId,\n      previewGoods: state => state.webPage.previewGoods,\n      user: state => state.user.userInfo\n    })\n  },\n  components: {\n    AppAblum,\n    appHeader,\n    CloneDialog,\n    CustomComponent,\n    ComponentHandler,\n    Wrapper\n  },\n  //   beforeRouteLeave(to, from, next) {\n  //     if (to.fullPath === '/tools/personal' && this.datas.length) {\n  //       next(false)\n  //       dialogService.confirm({\n  //         msg: '您还没保存，确定要离开？',\n  //         onConfirm: function() {\n  //           eventBus.$emit('closeCropper')\n  //           next()\n  //         }\n  //       })\n  //     } else {\n  //       next()\n  //     }\n  //   }\n  beforeRouteLeave(to, from, next) {\n    let that = this\n    if (to.path == '/cropper') {\n      next()\n      return\n    }\n    if (!this.isSave) {\n      next(false)\n      dialogService.confirm('您还没保存，确定要离开？', ok => {\n        if (ok) {\n          eventBus.$emit('closeCropper')\n          // 离开清除缓存\n          if (to.path !== '/cropper') {\n            that['system/updateRouter']({\n              type: 'del',\n              data: 'webPageEdit'\n            })\n          }\n          if (to.path == '/pay') {\n            that.$router.go(-2)\n          }\n          next()\n        }\n      })\n    } else {\n      // 离开清除缓存\n      if (to.path !== '/cropper') {\n        that['system/updateRouter']({\n          type: 'del',\n          data: 'webPageEdit'\n        })\n      }\n      if (to.path == '/pay') {\n        that.$router.go(-2)\n      }\n      next()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" src=\"./index.scss\" scoped>\n</style>\n"],"sourceRoot":"src/module/webPage/edit"}]}
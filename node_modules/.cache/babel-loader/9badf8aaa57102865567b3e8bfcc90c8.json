{"remainingRequest":"/Users/qiang/work/hytx/circle/node_modules/babel-loader/lib/index.js!/Users/qiang/work/hytx/circle/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/qiang/work/hytx/circle/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qiang/work/hytx/circle/src/module/mine/feedback/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qiang/work/hytx/circle/src/module/mine/feedback/index.vue","mtime":1548296329455},{"path":"/Users/qiang/work/hytx/circle/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/circle/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/circle/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qiang/work/hytx/circle/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport config from '@/config';\nimport httpService from '@/service/httpService';\nimport dialogService from '../../../service/dialogService';\nimport AppHeader from '../../../components/AppHeader';\nimport AppUploadImg from '../../../components/AppUploadImg';\nimport { mapState, mapActions } from 'vuex';\nexport default {\n  name: 'mine-feedback',\n  data: function data() {\n    return {\n      eventName: \"event_\".concat(parseInt(Math.random() * 1000)),\n      arr: [],\n      text: '',\n      phoneNum: '',\n      maxlength: 11\n    };\n  },\n  mounted: function mounted() {},\n  beforeRouteLeave: function beforeRouteLeave(to, from, next) {\n    // 离开清除名片缓存\n    if (to.path !== '/cropper') {\n      this['system/updateRouter']({\n        type: 'del',\n        data: 'mine-feedback'\n      });\n    }\n\n    next();\n  },\n  computed: _objectSpread({}, mapState({\n    platform: function platform(state) {\n      return state.system.platform;\n    }\n  }), {\n    paddingTop: function paddingTop() {\n      return this.platform === 'wechat' ? '0px' : '100px';\n    }\n  }),\n  methods: _objectSpread({}, mapActions(['system/updateCropper', 'system/updateRouter']), {\n    // 删除图片\n    delpic: function delpic(index) {\n      this.arr.splice(index, 1);\n    },\n    // 上传图片\n    upload: function upload(path) {\n      this.arr.push(path);\n    },\n    // 提交\n    submit: function submit() {\n      var _this = this;\n\n      if (this.phoneNum === '') {\n        dialogService.alert('请输入手机号');\n        return;\n      } else if (this.text === '') {\n        dialogService.alert('请留下你的反馈意见或建议');\n        return;\n      } else {\n        httpService.post('/front/profile/feedback', {\n          content: this.text,\n          phone: this.phoneNum,\n          images: this.arr\n        }).then(function (res) {\n          if (res.status === 0) {\n            dialogService.toast('上传成功');\n\n            _this.$router.push('/mine');\n          } else {\n            dialogService.alert(res.message);\n          }\n        }).catch(function (err) {\n          dialogService.alert(err.message);\n          return;\n        });\n      }\n    }\n  }),\n  components: {\n    AppHeader: AppHeader,\n    AppUploadImg: AppUploadImg\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA,OAAA,MAAA,MAAA,UAAA;AACA,OAAA,WAAA,MAAA,uBAAA;AACA,OAAA,aAAA,MAAA,gCAAA;AACA,OAAA,SAAA,MAAA,+BAAA;AACA,OAAA,YAAA,MAAA,kCAAA;AACA,SAAA,QAAA,EAAA,UAAA,QAAA,MAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,eADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,SAAA,kBAAA,QAAA,CAAA,IAAA,CAAA,MAAA,KAAA,IAAA,CAAA,CADA;AAEA,MAAA,GAAA,EAAA,EAFA;AAGA,MAAA,IAAA,EAAA,EAHA;AAIA,MAAA,QAAA,EAAA,EAJA;AAKA,MAAA,SAAA,EAAA;AALA,KAAA;AAOA,GAVA;AAWA,EAAA,OAXA,qBAWA,CAAA,CAXA;AAYA,EAAA,gBAZA,4BAYA,EAZA,EAYA,IAZA,EAYA,IAZA,EAYA;AACA;AACA,QAAA,EAAA,CAAA,IAAA,KAAA,UAAA,EAAA;AACA,WAAA,qBAAA,EAAA;AACA,QAAA,IAAA,EAAA,KADA;AAEA,QAAA,IAAA,EAAA;AAFA,OAAA;AAIA;;AACA,IAAA,IAAA;AACA,GArBA;AAsBA,EAAA,QAAA,oBACA,QAAA,CAAA;AACA,IAAA,QAAA,EAAA,kBAAA,KAAA;AAAA,aAAA,KAAA,CAAA,MAAA,CAAA,QAAA;AAAA;AADA,GAAA,CADA;AAIA,IAAA,UAAA,EAAA,sBAAA;AACA,aAAA,KAAA,QAAA,KAAA,QAAA,GAAA,KAAA,GAAA,OAAA;AACA;AANA,IAtBA;AA8BA,EAAA,OAAA,oBACA,UAAA,CAAA,CAAA,sBAAA,EAAA,qBAAA,CAAA,CADA;AAEA;AACA,IAAA,MAHA,kBAGA,KAHA,EAGA;AACA,WAAA,GAAA,CAAA,MAAA,CAAA,KAAA,EAAA,CAAA;AACA,KALA;AAMA;AACA,IAAA,MAPA,kBAOA,IAPA,EAOA;AACA,WAAA,GAAA,CAAA,IAAA,CAAA,IAAA;AACA,KATA;AAUA;AACA,IAAA,MAXA,oBAWA;AAAA;;AACA,UAAA,KAAA,QAAA,KAAA,EAAA,EAAA;AACA,QAAA,aAAA,CAAA,KAAA,CAAA,QAAA;AACA;AACA,OAHA,MAGA,IAAA,KAAA,IAAA,KAAA,EAAA,EAAA;AACA,QAAA,aAAA,CAAA,KAAA,CAAA,cAAA;AACA;AACA,OAHA,MAGA;AACA,QAAA,WAAA,CACA,IADA,CACA,yBADA,EACA;AACA,UAAA,OAAA,EAAA,KAAA,IADA;AAEA,UAAA,KAAA,EAAA,KAAA,QAFA;AAGA,UAAA,MAAA,EAAA,KAAA;AAHA,SADA,EAMA,IANA,CAMA,UAAA,GAAA,EAAA;AACA,cAAA,GAAA,CAAA,MAAA,KAAA,CAAA,EAAA;AACA,YAAA,aAAA,CAAA,KAAA,CAAA,MAAA;;AACA,YAAA,KAAA,CAAA,OAAA,CAAA,IAAA,CAAA,OAAA;AACA,WAHA,MAGA;AACA,YAAA,aAAA,CAAA,KAAA,CAAA,GAAA,CAAA,OAAA;AACA;AACA,SAbA,EAcA,KAdA,CAcA,UAAA,GAAA,EAAA;AACA,UAAA,aAAA,CAAA,KAAA,CAAA,GAAA,CAAA,OAAA;AACA;AACA,SAjBA;AAkBA;AACA;AAtCA,IA9BA;AAsEA,EAAA,UAAA,EAAA;AACA,IAAA,SAAA,EAAA,SADA;AAEA,IAAA,YAAA,EAAA;AAFA;AAtEA,CAAA","sourcesContent":["<template>\n  <div class=\"feedback\" :style=\"{paddingTop:paddingTop}\">\n    <AppHeader ref=\"header\" title=\"意见反馈\"></AppHeader>\n    <div class=\"title\">\n      <span>手机号 (建议与注册账户一致)</span>\n    </div>\n    <div style=\"position:relative;\">\n      <input class=\"phone\" v-model=\"phoneNum\" :maxlength=\"maxlength\" placeholder=\"请输入11位有效手机号\">\n      <i class=\"iconfont icon-shoujihao\"></i>\n    </div>\n    <div class=\"feedback-view\">\n      <textarea placeholder=\"留下你的反馈意见或建议\" v-model=\"text\"></textarea>\n      <div class=\"uploadpic\">\n        <div class=\"upload\" v-for=\"(item,index) in arr\" :key=\"index\">\n          <img :src=\"item\" />\n          <i class=\"iconfont icon-cuo3\" @click=\"delpic(index)\"></i>\n        </div>\n        <div class=\"upload\" v-show=\"arr.length<3\">\n          <i class=\"iconfont icon-hao\"></i>\n          <AppUploadImg class=\"avatarinput\" @success=\"upload\"></AppUploadImg>\n        </div>\n      </div>\n    </div>\n    <div @click=\"submit\" class=\"tijiao\">提交</div>\n  </div>\n</template>\n<script>\nimport config from '@/config'\nimport httpService from '@/service/httpService'\nimport dialogService from '../../../service/dialogService'\nimport AppHeader from '../../../components/AppHeader'\nimport AppUploadImg from '../../../components/AppUploadImg'\nimport { mapState, mapActions } from 'vuex'\n\nexport default {\n  name: 'mine-feedback',\n  data() {\n    return {\n      eventName: `event_${parseInt(Math.random() * 1000)}`,\n      arr: [],\n      text: '',\n      phoneNum: '',\n      maxlength: 11\n    }\n  },\n  mounted() {},\n  beforeRouteLeave(to, from, next) {\n    // 离开清除名片缓存\n    if (to.path !== '/cropper') {\n      this['system/updateRouter']({\n        type: 'del',\n        data: 'mine-feedback'\n      })\n    }\n    next()\n  },\n  computed: {\n    ...mapState({\n      platform: state => state.system.platform\n    }),\n    paddingTop: function() {\n      return this.platform === 'wechat' ? '0px' : '100px'\n    }\n  },\n  methods: {\n    ...mapActions(['system/updateCropper', 'system/updateRouter']),\n    // 删除图片\n    delpic(index) {\n      this.arr.splice(index, 1)\n    },\n    // 上传图片\n    upload(path) {\n      this.arr.push(path)\n    },\n    // 提交\n    submit() {\n      if (this.phoneNum === '') {\n        dialogService.alert('请输入手机号')\n        return\n      } else if (this.text === '') {\n        dialogService.alert('请留下你的反馈意见或建议')\n        return\n      } else {\n        httpService\n          .post('/front/profile/feedback', {\n            content: this.text,\n            phone: this.phoneNum,\n            images: this.arr\n          })\n          .then(res => {\n            if (res.status === 0) {\n              dialogService.toast('上传成功')\n              this.$router.push('/mine')\n            } else {\n              dialogService.alert(res.message)\n            }\n          })\n          .catch(err => {\n            dialogService.alert(err.message)\n            return\n          })\n      }\n    }\n  },\n  components: {\n    AppHeader,\n    AppUploadImg\n  }\n}\n</script>\n<style scoped lang='scss'>\n.feedback {\n  position: relative;\n  width: 100%;\n  height: 100vh;\n  background: #f2f2f2;\n  .uploadpic {\n    display: flex;\n    width: 100%;\n    height: 160px;\n    padding: 20px 0;\n    .avatarinput {\n      top: 0;\n      left: 0;\n      opacity: 0;\n      z-index: 1;\n      width: 100%;\n      height: 100%;\n      position: absolute;\n    }\n    .upload {\n      img {\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n      }\n      margin-right: 20px;\n      position: relative;\n      display: flex;\n      width: 160px;\n      height: 160px;\n      line-height: 160px;\n      justify-content: center;\n      align-content: center;\n      border: 1px dashed #dadada;\n      .icon-hao {\n        font-size: 50px;\n      }\n      .icon-cuo3 {\n        border-radius: 50%;\n        width: 40px;\n        height: 40px;\n        position: absolute;\n        right: -10px;\n        top: -10px;\n        color: #fff;\n        line-height: 40px;\n        text-align: center;\n        background: rgba($color: #000000, $alpha: 0.6);\n        font-size: 20px;\n      }\n    }\n  }\n  .tijiao {\n    width: 690px;\n    height: 80px;\n    line-height: 80px;\n    text-align: center;\n    font-size: 32px;\n    color: #fff;\n    background: #274ff3;\n    border-radius: 6px;\n    margin: 30px auto;\n  }\n  .phone {\n    outline: none;\n    width: 100%;\n    height: 80px;\n    padding: 30px;\n    font-size: 30px;\n    box-sizing: border-box;\n  }\n  .title {\n    font-size: 36px;\n    padding: 40px 30px 30px;\n\n    span {\n      position: relative;\n\n      &:after {\n        content: '*';\n        color: red;\n        font-size: 24px;\n        position: absolute;\n        top: 0;\n      }\n    }\n  }\n\n  .icon-shoujihao {\n    position: absolute;\n    font-size: 30px;\n    right: 30px;\n    top: 20px;\n  }\n\n  .feedback-view {\n    padding: 40px 30px;\n    background: #ffffff;\n    margin-top: 30px;\n\n    textarea {\n      font-size: 30px;\n      outline: none;\n      resize: none;\n      width: 100%;\n      height: 120px;\n      border: none;\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/module/mine/feedback"}]}